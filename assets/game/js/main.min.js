function post(e,t,n){var r=n.value,i=e.constructor.name+MessageCenter.splite+t,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.call.apply(r,[this].concat(e));return("boolean"!=typeof n||n)&&MessageCenter.ins().dispatch(i,n),n};return o.funcallname=i,n.value=o,n}function callLater(e,t,n){var r=n.value,i="$"+t+"CL",o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];delete this[i],r.call.apply(r,[this].concat(e))},s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this[i]||(egret.callLater.apply(egret,[o,this].concat(e)),this[i]=!0)};return n.value=s,n}function callDelay(e){return function(t,n,r){var i=r.value,o="$isDelay"+n,s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this[o]=!1,i.call.apply(i,[this].concat(e))},a=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this[o]||(this[o]=!0,egret.setTimeout.apply(egret,[s,this,e].concat(t)))};return r.value=a,r}}var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{h(r.next(e))}catch(t){o(t)}}function a(e){try{h(r["throw"](e))}catch(t){o(t)}}function h(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}h((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;h;)try{if(i=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,o=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){h.label=n[1];break}if(6===n[0]&&h.label<s[1]){h.label=s[1],s=n;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(n);break}s[2]&&h.ops.pop(),h.trys.pop();continue}n=t.call(e,h)}catch(r){n=[6,r],o=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},BaseClass=function(){function e(){}return e.ins=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;return n._instance||(n._instance=new(n.bind.apply(n,[void 0].concat(e)))),n._instance},e.del=function(){var e=this;e._instance&&(e._instance=null)},e}();__reflect(BaseClass.prototype,"BaseClass"),window.BaseClass=BaseClass;var GlobalConfig=function(){function e(){}return e.init=function(e){console.log(e),this.config=e},e.getCoursePlay=function(){return this.config.CoursePlay},e.getHeroResult=function(){return this.config.HeroResult},e.getUpHouseMc=function(){return this.config.hammer},e.shareImgUrl="./resource/assets/other/share_cover.png",e.helpImgUrl="./resource/assets/other/help_cover.png",e}();__reflect(GlobalConfig.prototype,"GlobalConfig"),window.GlobalConfig=GlobalConfig;var MessageCenter=function(e){function t(t){var n=e.call(this)||this;return n.flag=0,n.type=t,n.dict={},n.eVec=[],0==n.type&&egret.startTick(n.run,n),n}return __extends(t,e),t.ins=function(){return e.ins.call(this,0)},t.prototype.clear=function(){this.dict={},this.eVec.splice(0)},t.prototype.addListener=function(e,t,n){var r=this.dict[e];r?0!=this.flag&&(this.dict[e]=r=r.concat()):this.dict[e]=r=[];for(var i=0,o=r;i<o.length;i++){var s=o[i];if(s[0]==t&&s[1]==n)return}r.push([t,n])},t.prototype.removeListener=function(e,t,n){var r=this.dict[e];if(r){0!=this.flag&&(this.dict[e]=r=r.concat());for(var i=r.length,o=0;i>o;o++)if(r[o][0]==t&&r[o][1]==n){r.splice(o,1);break}0==r.length&&(this.dict[e]=null,delete this.dict[e])}},t.prototype.removeAll=function(e){for(var t=Object.keys(this.dict),n=0,r=t;n<r.length;n++){var i=r[n],o=this.dict[i];0!=this.flag&&(this.dict[i]=o=o.concat());for(var s=0;s<o.length;s++)o[s][1]==e&&(o.splice(s,1),s--);0==o.length&&(this.dict[i]=null,delete this.dict[i])}},t.prototype.dispatch=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=ObjectPool.pop("MessageVo");if(r.type=e,r.param=t,0==this.type){for(var i=!1,o=0,s=this.eVec;o<s.length;o++){var a=s[o];if(r.type==a.type&&r.param.length==a.param.length){i=!0;for(var h=0;h<r.param.length;h++){var l=r.param[h],u=a.param[h];if(l!==u){i=!1;break}}break}}i||this.eVec.push(r)}else 1==this.type?this.dealMsg(r):Log.trace("MessageCenter未实现的类型")},t.prototype.run=function(e){for(var t=egret.getTimer(),n=t,r=[];this.eVec.length>0;){var i=this.eVec.shift();r.push(i.type),this.dealMsg(i);var o=egret.getTimer(),s=o-n;if(n=o,r.push(s),o-t>5){DebugUtils.log("时间处理超过5毫秒,执行事件数量"+r.length/2,r);break}}return!1},t.prototype.dealMsg=function(e){var t=this.dict[e.type];if(t){var n=t.length;if(0!=n){this.flag++;for(var r=0,i=t;r<i.length;r++){var o=i[r];o[0].apply(o[1],e.param)}this.flag--,e.dispose(),ObjectPool.push(e)}}},t.setFunction=function(e,n,r,i){if(0==r.indexOf(i)&&"function"==typeof n[r]){var o=n.__class__+t.splite+r,s=n[r],a=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i;n.length;return i=e?s.call.apply(s,[this].concat(n)):s.apply(void 0,n),("boolean"!=typeof i||i)&&t.ins().dispatch(o,i),i};return a.funcallname=o,n[r]=a,!0}return!1},t.compile=function(e,n){void 0===n&&(n="post");var r=e.prototype;for(var i in r)t.setFunction(!0,r,i,n)},t.addListener=function(e,n,r,i){return void 0===i&&(i=void 0),e.funcallname?(t.ins().addListener(e.funcallname,n,r),i&&e.call(i),!0):(Log.trace("MessageCenter.addListener error:"+egret.getQualifiedClassName(r)),!1)},t.splite=".",t}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function e(){}return e.prototype.dispose=function(){this.type=null,this.param=null},e}();__reflect(MessageVo.prototype,"MessageVo"),window.MessageCenter=MessageCenter,window.MessageVo=MessageVo;var BaseEuiLayer=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=100,t.percentHeight=100,t.touchEnabled=!1,t}return __extends(t,e),t}(eui.Group);__reflect(BaseEuiLayer.prototype,"BaseEuiLayer"),window.BaseEuiLayer=BaseEuiLayer;var BaseView=function(e){function t(){var t=e.call(this)||this;return t.event=[],t}return __extends(t,e),t.prototype.observe=function(e,t,n){void 0===n&&(n=void 0),MessageCenter.addListener(e,t,this,n)},t.prototype.removeObserve=function(){MessageCenter.ins().removeAll(this)},t.prototype.addTouchEvent=function(e,t){this.addEvent(egret.TouchEvent.TOUCH_TAP,e,t)},t.prototype.addTouchEndEvent=function(e,t){this.addEvent(egret.TouchEvent.TOUCH_END,e,t)},t.prototype.addChangeEvent=function(e,t){var n=this;e&&e instanceof eui.TabBar?this.addEvent(egret.TouchEvent.CHANGE,e,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.call.apply(t,[n].concat(e))}):this.addEvent(egret.TouchEvent.CHANGE,e,t)},t.prototype.addChangingEvent=function(e,t){this.addEvent(egret.TouchEvent.CHANGING,e,t)},t.prototype.addEvent=function(e,t,n){t&&(t.addEventListener(e,n,this),this.event.push([e,n,t]))},t.prototype.removeTouchEvent=function(e,t){e&&e.removeEventListener(egret.TouchEvent.TOUCH_TAP,t,this)},t.prototype.removeEvents=function(){for(;this.event.length>0;){var e=this.event.pop();e[2].removeEventListener(e[0],e[1],this)}},t.prototype.setSkinPart=function(n,r){if(e.prototype.setSkinPart.call(this,n,r),r&&this.skin[n]&&this.skin[n]!=r){var i=this.skin[n].parent,o=i.getChildIndex(this.skin[n]);DisplayUtils.removeFromParent(this.skin[n]);for(var s=0;s<t.replaceKeys.length;s++){var a=t.replaceKeys[s];r[a]=this.skin[n][a]}this.skin[n]=r,i.addChildAt(r,o)}},t.prototype.$onClose=function(){var e=function n(e){for(var r=0;r<e.numChildren;r++){var i=e.getChildAt(r);i instanceof t?i.$onClose():i instanceof egret.DisplayObjectContainer&&n(i)}};e(this),this.removeEvents(),this.removeObserve()},t.replaceKeys=["x","y","alpha","anchorOffsetX","anchorOffsetY","blendMode","bottom","cacheAsBitmap","currentState","enabled","filters","height","horizontalCenter","hostComponentKey","includeInLayout","left","mask","matrix","maxHeight","maxWidth","minHeight","minWidth","name","percentHeight","percentWidth","right","rotation","scaleX","scaleY","scrollRect","skewX","skewY","skinName","top","touchChildren","touchEnabled","verticalCenter","visible","width"],t}(eui.Component);__reflect(BaseView.prototype,"BaseView"),window.BaseView=BaseView;var ByteArrayMsg=function(){function e(){this._msgBuffer=new egret.ByteArray}return e.prototype.receive=function(e){e.readBytes(this._msgBuffer);var t=this.decode(this._msgBuffer);t&&MessageCenter.ins().dispatch(t.key,t.body),0==this._msgBuffer.bytesAvailable&&this._msgBuffer.clear()},e.prototype.send=function(e,t){var n=this.encode(t);n&&(n.position=0,e.writeBytes(n,0,n.bytesAvailable))},e.prototype.decode=function(e){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},e.prototype.encode=function(e){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},e}();__reflect(ByteArrayMsg.prototype,"ByteArrayMsg",["BaseMsg"]),window.ByteArrayMsg=ByteArrayMsg;var UTFMsg=function(){function e(){}return e.prototype.receive=function(e){var t=e.readUTF(),n=this.decode(t);n&&MessageCenter.ins().dispatch(n.key,n.body)},e.prototype.send=function(e,t){var n=this.encode(t);n&&(e.type=egret.WebSocket.TYPE_STRING,e.writeUTF(n))},e.prototype.decode=function(e){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},e.prototype.encode=function(e){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},e}();__reflect(UTFMsg.prototype,"UTFMsg",["BaseMsg"]),window.UTFMsg=UTFMsg;var BaseScene=function(){function e(){this._layers=new Array}return e.prototype.onEnter=function(){},e.prototype.onExit=function(){ViewManager.ins().closeAll(),this.removeAllLayer()},e.prototype.addLayer=function(e){e instanceof BaseSpriteLayer?(StageUtils.ins().getStage().addChild(e),this._layers.push(e)):e instanceof BaseEuiLayer&&(StageUtils.ins().getUIStage().addChild(e),this._layers.push(e))},e.prototype.addLayerAt=function(e,t){e instanceof BaseSpriteLayer?(StageUtils.ins().getStage().addChildAt(e,t),this._layers.push(e)):e instanceof BaseEuiLayer&&(StageUtils.ins().getUIStage().addChildAt(e,t),this._layers.push(e))},e.prototype.removeLayer=function(e){e instanceof BaseSpriteLayer?(StageUtils.ins().getStage().removeChild(e),this._layers.splice(this._layers.indexOf(e),1)):e instanceof BaseEuiLayer&&(StageUtils.ins().getUIStage().removeChild(e),this._layers.splice(this._layers.indexOf(e),1))},e.prototype.layerRemoveAllChild=function(e){e instanceof BaseSpriteLayer?e.removeChildren():e instanceof BaseEuiLayer&&e.removeChildren()},e.prototype.removeAllLayer=function(){for(;this._layers.length;){var e=this._layers[0];this.layerRemoveAllChild(e),this.removeLayer(e)}},e}();__reflect(BaseScene.prototype,"BaseScene"),window.BaseScene=BaseScene;var ViewManager=function(e){function t(){var t=e.call(this)||this;return t._regesterInfo={},t._views={},t._hCode2Key={},t._opens=[],t._constView=["GameSceneView","ChatMainUI","UIView2","TipsView","PlayFunView"],t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.clear=function(){this.closeAll(),this._views={}},t.prototype.reg=function(e,t){if(null!=e){var n=egret.getQualifiedClassName(e);return this._regesterInfo[n]?void console.warn("重复注册界面："+n):void(this._regesterInfo[n]=[e,t])}},t.prototype.destroy=function(e){var t=this._hCode2Key[e],n=this._views[t];if(n instanceof BaseView){var r=n.viewStack;if(r&&r.$children.length>0){var i=r.$children;i.forEach(function(e,t){e.close&&e.close()})}}delete this._views[t],delete this._hCode2Key[e]},t.prototype.getKey=function(e){var t="";if("string"==typeof e)t=e;else if("function"==typeof e)t=egret.getQualifiedClassName(e);else if(e instanceof BaseEuiView)for(var n=Object.keys(this._views),r=0,i=n.length;i>r;r++){var o=n[r];if(this._views[o]==e){t=o;break}}else debug.log("打开界面只支持类名和类名的字符串形式,关闭界面只支持类名和类名的字符串以及类的实例形式,错误编号:"+e);return t},t.prototype.viewOpenCheck=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=!0,i=this._regesterInfo[e];if(null!=i){var o=i[0],s=o.openCheck;null!=s&&(r=s.apply(void 0,t))}return r},t.prototype.open=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.getKey(e);if(!this.viewOpenCheck.apply(this,[r].concat(t)))return null;var i=this.openEasy(r,t);return i},t.prototype.openEasy=function(e,t){void 0===t&&(t=null);var n=this.getKey(e),r=this._views[n],i=this._regesterInfo[n];if(r||(r=new i[0],this._views[n]=r,this._hCode2Key[r.hashCode]=n),null==r)return Log.trace("UI_"+n+"不存在"),null;for(var o=0,s=r.exclusionWins;o<s.length;o++){var a=s[o];this.closeEasy(a)}r.isShow()||r.isInit()?(r.addToParent(i[1]),r.open.apply(r,t)):r.loadResource(function(){r.addToParent(i[1]),r.setVisible(!1)}.bind(this),function(){r.initUI(),r.initData(),r.open.apply(r,t),r.setVisible(!0)}.bind(this));var h=this._opens.indexOf(n);return h>=0&&this._opens.splice(h,1),this._opens.push(n),r},t.prototype.close=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.closeEx(e,t)},t.prototype.closeEx=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.getView(e);i&&i.closeEx(function(){t.closeEasy(e,n)})},t.prototype.closeEasy=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!this.isShow(e))return null;var r=this.getKey(e),i=this.getView(r);if(i){var o=this._opens.indexOf(r);o>=0&&this._opens.splice(o,1),i.close.apply(i,t),i.$onClose.apply(i),i.removeFromParent()}return i},t.prototype.getView=function(e){var t=this.getKey(e);return this._views[t]},t.prototype.closeAll=function(){for(;this._opens.length;)this.closeEasy(this._opens[0],[]);this.destroyAllNotShowView()},t.prototype.isShow=function(e){return this._opens.indexOf(this.getKey(e))>=0},t.prototype.destroyAllNotShowView=function(){for(var e in this._hCode2Key){var t=this._hCode2Key[e];if(-1==this._constView.indexOf(t)&&-1==this._opens.indexOf(t)){var n=this.getView(t);n&&n.destoryView&&n.destoryView(!1)}}},t}(BaseClass);__reflect(ViewManager.prototype,"ViewManager"),window.ViewManager=ViewManager;var LayerManager=function(){function e(){}return e.Game_Bg=new BaseEuiLayer,e.Game_Main=new BaseEuiLayer,e.Main_View=new BaseEuiLayer,e.UI_Main=new BaseEuiLayer,e.UI_Main2=new BaseEuiLayer,e.UI_Popup=new BaseEuiLayer,e.UI_Message=new BaseEuiLayer,e.UI_Tips=new BaseEuiLayer,e.UI_LOADING=new BaseEuiLayer,e}();__reflect(LayerManager.prototype,"LayerManager"),window.LayerManager=LayerManager;var BaseSound=function(){function e(){this._cache={},this._loadingCache=new Array,TimerManager.ins().doTimer(6e4,0,this.dealSoundTimer,this)}return e.prototype.dealSoundTimer=function(){for(var e=egret.getTimer(),t=Object.keys(this._cache),n=0,r=t.length;r>n;n++){var i=t[n];this.checkCanClear(i)&&e-this._cache[i]>=SoundManager.CLEAR_TIME&&(delete this._cache[i],RES.destroyRes(i))}},e.prototype.getSound=function(e){if(!RES.hasRes(e))return-1!=this._loadingCache.indexOf(e)?null:(this._loadingCache.push(e),void RES.getResByUrl(e,this.onResourceLoadComplete2,this,RES.ResourceItem.TYPE_SOUND));var t=RES.getRes(e);if(t)this._cache[e]&&(this._cache[e]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(e))return null;this._loadingCache.push(e),RES.getResAsync(e,this.onResourceLoadComplete,this)}return t},e.prototype.onResourceLoadComplete=function(e,t){var n=this._loadingCache.indexOf(t);-1!=n&&(this._loadingCache.splice(n,1),this._cache[t]=egret.getTimer(),this.loadedPlay(t))},e.prototype.onResourceLoadComplete2=function(e,t){var n=this._loadingCache.indexOf(t);-1!=n&&(this._loadingCache.splice(n,1),this._cache[t]=egret.getTimer(),this.loadedPlay(t))},e.prototype.loadedPlay=function(e){},e.prototype.checkCanClear=function(e){return!0},e}();__reflect(BaseSound.prototype,"BaseSound"),window.BaseSound=BaseSound;var BaseEuiView=function(e){function t(){var t=e.call(this)||this;return t._resources=null,t.isTopLevel=!1,t.exclusionWins=[],t._isInit=!1,t.percentHeight=100,t.percentWidth=100,t}return __extends(t,e),t.prototype.addExclusionWin=function(e){-1==this.exclusionWins.indexOf(e)&&this.exclusionWins.push(e)},t.prototype.isInit=function(){return this._isInit},t.prototype.isShow=function(){return null!=this.stage&&this.visible},t.prototype.addToParent=function(e){e.addChild(this)},t.prototype.removeFromParent=function(){DisplayUtils.removeFromParent(this),this.destoryView()},t.prototype.initUI=function(){this._isInit=!0},t.prototype.initData=function(){},t.prototype.destroy=function(){},t.prototype.destoryView=function(e){void 0===e&&(e=!0),TimerManager.ins().removeAll(this),ViewManager.ins().destroy(this.hashCode)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.loadResource=function(e,t){this._resources&&this._resources.length>0?(ResourceUtils.ins().loadResource(this._resources,[],e,null,this),this.addEventListener(eui.UIEvent.CREATION_COMPLETE,t,this)):(e(),t())},t.prototype.setVisible=function(e){this.visible=e},t.openCheck=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!0},t.prototype.closeEx=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0];this.parent==LayerManager.UI_Popup,n()},t.prototype.closeWin=function(){ViewManager.ins().close(this)},t}(BaseView);__reflect(BaseEuiView.prototype,"BaseEuiView",["IBaseView"]),window.BaseEuiView=BaseEuiView;var GameByteArray=function(e){function t(){var t=e.call(this)||this;return t.endian=egret.Endian.LITTLE_ENDIAN,t}return __extends(t,e),t.prototype.readString=function(){var e=this.readUTF();return this.position+=1,e},t.prototype.readNumber=function(){var e=new uint64(this),t=e.toString();return+t},t.prototype.writeNumber=function(e){var t=uint64.stringToUint64(e.toString());this.writeInt64(t)},t.prototype.writeInt64=function(e){this.writeUnsignedInt(e._lowUint),this.writeUnsignedInt(e._highUint)},t.prototype.writeString=function(e){this.writeUTF(e),this.writeByte(0)},t.prototype.writeCmd=function(e,t){this.writeByte(e),this.writeByte(t)},t.prototype.readInts=function(e){for(var t=[],n=0;e>n;n++)t.push(this.readInt());return t},t.prototype.writeInts=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];this.writeInt(i)}},t}(egret.ByteArray);__reflect(GameByteArray.prototype,"GameByteArray"),window.GameByteArray=GameByteArray;var BaseSystem=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.regNetMsg=function(e,t){GameSocket.ins().registerSTCFunc(this.sysId,e,t,this)},t.prototype.initLogin=function(){},t.prototype.initZero=function(){},t.prototype.getGameByteArray=function(){return GameSocket.ins().getBytes()},t.prototype.getBytes=function(e){var t=this.getGameByteArray();return t.writeCmd(this.sysId,e),t},t.prototype.sendBaseProto=function(e){var t=this.getGameByteArray();t.writeCmd(this.sysId,e),this.sendToServer(t)},t.prototype.sendToServer=function(e){GameSocket.ins().sendToServer(e)},t.prototype.observe=function(e,t){MessageCenter.addListener(e,t,this)},t.prototype.removeObserve=function(){MessageCenter.ins().removeAll(this)},t.prototype.associated=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];this.observe(o,e)}},t}(BaseClass);__reflect(BaseSystem.prototype,"BaseSystem"),MessageCenter.compile(BaseSystem),window.BaseSystem=BaseSystem;var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),App.ins().playOpenAd(),egret.Logger.logLevel=egret.Logger.ALL,egret.ImageLoader.crossOrigin="anonymous",this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.setMaxLoadingThread(4),StageUtils.ins().resetMode(),egret.lifecycle.onPause=function(){egret.ticker.pause(),SoundManager.ins().setEffectOn(!1)},egret.lifecycle.onResume=function(){egret.ticker.resume(),SoundManager.ins().setEffectOn(!0)},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.onGetComplete=function(e){console.log(e)},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,App.ins().reqAd()];case 1:return e.sent(),[4,this.loadResource()];case 2:return e.sent(),SceneManager.ins().runScene(MainScene),[4,App.ins().initDeviceId()];case 3:return e.sent(),[4,App.ins().login()];case 4:return e.sent(),LoadingUI.setLoadingState(.05),App.ins().splash(),RankModel.ins().init(),[4,this.mainRegister()];case 5:return e.sent(),[4,this.loadConfig()];case 6:return e.sent(),LoadingUI.setLoadingState(.1),TimerManager.ins(),UserModel.ins().setRefreshTimer(),this.initShare(),LoadingUI.start(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,RES.loadConfig("default.res.json",App.ins().getResRoot())];case 1:return t.sent(),[4,this.loadTheme()];case 2:return t.sent(),[4,RES.loadGroup("loading")];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),console.error(e),[3,5];case 5:return[2]}})})},t.prototype.loadConfig=function(){var e=this;return new Promise(function(t,n){RES.getResAsync("config_json",function(e){GlobalConfig.init(e),t()},e)})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var r=new eui.Theme("resource/default.thm.json",e.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.initShare=function(){t.gamePlatform==t.platformTT&&(wx.showShareMenu({withShareTicket:!1}),t.gamePlatform===t.platformTT?wx.onShareAppMessage(function(){return{templateId:t.ttShareId}}):wx.onShareAppMessage(function(){return t.shareConfig.common}))},t.prototype.mainRegister=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:if(t.gamePlatform!=t.platformTT)return[2];wx.onMemoryWarning(function(){console.error("onMemoryWarning")}),AdService.initVideoAd();try{t.recorder=wx.getGameRecorderManager()}catch(r){console.error("init recorder error:",r)}return e=t,[4,wxapi.getSystemInfo()];case 1:return e.systemInfo=n.sent(),[2]}})})},t.startGame=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(r){switch(r.label){case 0:return console.log("->startGame"),t.isLogin?[3,2]:(console.log("->startGame1"),[4,App.ins().login()]);case 1:if(r.sent(),!t.isLogin)return console.error("main->登录请求失败"),[2];r.label=2;case 2:return[4,TimerManager.ins().deleyPromisse(500)];case 3:return r.sent(),e=DateUtil.getDayStart(),[4,CacheUtil.get(Constant.LOGIN_AWARD)];case 4:return n=r.sent(),n&&n===e+""?console.log("登录奖励已经领取过了！"):ViewManager.ins().open(LoginAwardWin),ViewManager.ins().open(HomeWin),ViewManager.ins().close(LoadingUI),ViewManager.ins().open(NavigationWin),[2]}})})},t.isLogin=!1,t.isDebug=!1,t.host="https://zmg.zmfamily.cn",t.ossUrl="https://cdnzmg.zmfamily.cn/",t.version="20000",t.platformWX="1",t.platformQQ="2",t.platformTT="3",t.platformApp="4",t.platformH5="5",t.platformIOS="7",t.gamePlatform=t.platformApp,t.adId="201",t.reqTimeout=1e4,t.shareConfig={common:{imageUrl:GlobalConfig.helpImgUrl,title:"我发现了一款好玩的拼单词游戏，快来跟我一起玩吧！"}},t.ttShareId="17i7lf08lh9d12uuke",t.ttShareDrawId="1m43c92p7jkf4fw6ik",t.recording=!1,t.recordStartTime=0,t.recordTime=5e3,t.bgm="https://cdnzmg.zmfamily.cn/word/bgm.mp3",t.res_url="https://cdnzmg.zmfamily.cn/word/res_url_cfg.json",t}(eui.UILayer);__reflect(Main.prototype,"Main"),window.Main=Main;var DialogTopImg=function(){function e(){}return e.BACK_HOME="dialog-back-home_png",e.LOGIN="dialog-login-award_png",e.ENTER_STAGE="dialog-enter-stage_png",e.GET_ENERGY="dialog-get-energy_png",e.UNLOCK_COLOR="dialog-unlock-color_png",e}();__reflect(DialogTopImg.prototype,"DialogTopImg"),window.DialogTopImg=DialogTopImg;var CRC16=function(){function e(){}return e.update=function(t,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=0,o=0;0==r&&(r=t.length),t.position=n;for(var s=n;r>s;++s)o=255&e.CRCBitReflect(t.readByte(),8)^i>>8&16777215,o&=255,i=e.CRCTable[o]^i<<8&4294967040;return 65535&(0^e.CRCBitReflect(i,16))},e.makeCRCTable=function(){for(var t=0,n=new Array(256),r=0;256>r;++r){t=r<<8&4294967040;for(var i=0;8>i;++i)t=32768&t?t<<1&4294967294^e.POLYNOMIAL:t<<1&4294967294;n[r]=t}return n},e.CRCBitReflect=function(t,n){var r=0,i=0;n--;for(var o=0;n>=o;++o)i=n-o,1&t&&(r|=1<<i&e.DropBits[i]),t=t>>1&2147483647;return r},e.POLYNOMIAL=4129,e.CRCTable=e.makeCRCTable(),e.DropBits=[4294967295,4294967294,4294967292,4294967288,4294967280,4294967264,4294967232,4294967168,4294967040,4294966784,4294966272,4294965248,4294963200,4294959104,4294950912,4294934528],e}();__reflect(CRC16.prototype,"CRC16"),window.CRC16=CRC16;var Encrypt=function(){function e(){}return e.encode=function(t,n,r){if(void 0===n&&(n=0),void 0===r&&(r=0),n>=t.length)return 0;var i=r?n+r:t.length;i>t.length&&(i=t.length),t.position=n;for(var o=n;i>o;++o){var s=t.readByte();s^=e.sKeyBuff[o%4],t.position--,t.writeByte(s)}return i-n},e.decode=function(t,n,r){return void 0===n&&(n=0),void 0===r&&(r=0),e.encode(t,n,r)},e.getCRC16=function(e,t){return void 0===t&&(t=0),CRC16.update(e,0,t)},e.getCRC16ByPos=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),CRC16.update(e,t,n)},e.getCheckKey=function(){var t=new egret.ByteArray;t.endian=egret.Endian.LITTLE_ENDIAN,t.writeUnsignedInt(e.sKey);var n=CRC16.update(t);return n},e.getSelfSalt=function(){return e.sSelfSalt},e.getTargetSalt=function(){return e.sTargetSalt},e.setTargetSalt=function(t){e.sTargetSalt=t,e.makeKey()},e.makeSalt=function(){var e=new Date;return Math.random()*e.getTime()},e.makeKey=function(){e.sKey=(e.sSelfSalt^e.sTargetSalt)+8254;for(var t=0;4>t;++t)e.sKeyBuff[t]=(e.sKey&255<<(t<<3))>>(t<<3)},e.sSelfSalt=e.makeSalt(),e.sKeyBuff=new Array(4),e}();__reflect(Encrypt.prototype,"Encrypt"),window.Encrypt=Encrypt;var DynamicChange=function(){function e(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}return Object.defineProperty(e.prototype,"pUpdate",{get:function(){return this._pUpdate},enumerable:!0,configurable:!0}),e.prototype.getCacheData=function(e){return this._dataCache[e]?this._dataCache[e]:null},e.prototype.clearCache=function(){for(var e=Object.keys(this._dataCache),t=0,n=e.length;n>t;t++){var r=e[t];this._dataCache[r]=null,delete this._dataCache[r]}},e.prototype.getCacheKeyInfos=function(){for(var e=[],t=Object.keys(this._dataCache),n=0,r=t.length;r>n;n++){var i=t[n],o=this._dataCache[i];e.push(o)}return e},e.prototype.isCache=function(e){return this._dataCache[e]},e}();__reflect(DynamicChange.prototype,"DynamicChange"),window.DynamicChange=DynamicChange;var ProxyUpdate=function(){function e(e){this._cache=e}return e.prototype.isArray=function(e){return e instanceof Array},e.prototype.isObject=function(e){return e.indexOf("object")>-1},e.prototype.isNormal=function(e){var t=e.indexOf("@")>-1,n=e.indexOf(".")>-1,r=e.indexOf("_")>-1;return!t&&!n&&!r},e.prototype.isAddToArray=function(e){return"@a"==e},e.prototype.isRemoveToArray=function(e){var t=e.split("_");return t.length<=3&&"@d"==t[0]},e.prototype.isFilter=function(e){var t=e.split("_");return"@f"==t[0]},e.prototype.isNumeric=function(e){return parseFloat(e).toString()==e.toString()},e.prototype._updateObject=function(e,t,n){var r=e.split(".");"@a"==r[0]||"@s"==r[0]?n[r[1]]=t:"@d"==r[0]&&delete n[r[1]]},e.prototype._getFilterObject=function(e,t){if(t){var n=e.split("_");if(3==n.length&&"@f"==n[0]&&this.isArray(t))for(var r=n[1],i=n[2],o=0;o<t.length;o++){var s=t[o];if(3==n.length&&this.isObject(s.toString())){var a=s[r];if(a&&("@"==i[0]&&(i=i.replace("@","")),i==a))return s}}}return null},e.prototype._addObjectToArray=function(e,t){if(this.isArray(t))for(var n=0;n<t.length;n++)e.push(t[n]);else e.push(t)},e.prototype._removeObjectFromArray=function(e,t,n){var r=t.split("_");if(r.length<=3&&"@d"==r[0]&&this.isArray(e))for(var i=e.length,o=i-1;o>=0;o--){var s=e[o];if(3==r.length){if(s.hasOwnProperty(r[1])){var a=r[2];"@"==a[0]&&(a=a.replace("@","")),a==s[r[1]]&&e.splice(o,1)}}else 2==r.length&&s.hasOwnProperty(r[1])?n==s[r[1]]&&e.splice(o,1):1==r.length&&n==s&&e.splice(o,1)}},e.prototype.update=function(e,t){if(this._cache[e]=t,t.hasOwnProperty("c"))for(var n=t.c,r=Object.keys(n),i=0,o=r.length;o>i;i++){var s=r[i];this._cache[s]&&(this._update(this._cache[s],n[s]),MessageCenter.ins().dispatch(s+"_HttpUpdate"))}},e.prototype._update=function(e,t){if(e&&t&&this.isObject(t.toString()))for(var n=Object.keys(t),r=0,i=n.length;i>r;r++){var o=n[r],s=t[o];if(this.isNormal(o)&&this.isObject(s.toString()))e.hasOwnProperty(o)&&this._update(e[o],s);else if(this.isNormal(o)&&this.isNumeric(s)){var a=e[o];e[o]=a+s}else if(this.isNormal(o))e[o]=s;else if(this.isAddToArray(o))this._addObjectToArray(e,s);else if(this.isRemoveToArray(o))this._removeObjectFromArray(e,o,s);else if(this.isFilter(o)){var h=this._getFilterObject(o,e);h&&this._update(h,s)}else this._updateObject(o,s,e)}},e}();__reflect(ProxyUpdate.prototype,"ProxyUpdate"),window.ProxyUpdate=ProxyUpdate;var Http=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.send=function(e,t,n,r,i,o){var s=new egret.HttpRequest;s.responseType=t?egret.HttpResponseType.TEXT:egret.HttpResponseType.ARRAY_BUFFER,s.open(e,n?egret.HttpMethod.GET:egret.HttpMethod.POST),s.once(egret.Event.COMPLETE,r,this),s.once(egret.IOErrorEvent.IO_ERROR,i?i:function(){},this),s.once(egret.ProgressEvent.PROGRESS,o?o:function(){},this),s.send()},t.prototype.post=function(e){var t=JSON.stringify(e.data),n=new egret.HttpRequest;n.timeout=Main.reqTimeout,n.responseType=egret.HttpResponseType.TEXT;var r=e.url;Main.gamePlatform==Main.platformIOS&&(r+="?MathRand="+Math.random()),n.open(r,egret.HttpMethod.POST);for(var i in e.header)n.setRequestHeader(i,e.header[i]);n.setRequestHeader("content-Type","application/json"),n.send(t),n.addEventListener(egret.Event.COMPLETE,function(t){var n={data:JSON.parse(t.target.response),statusCode:200};e.success(n)},this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){},this)},t.prototype.get=function(e){var t="";if(e.data){var n=e.data;t+="?";var r=0;for(var i in n)0!=r&&(t+="&"),t+=i+"="+n[i],r++;Main.gamePlatform==Main.platformIOS&&(t+="&MathRand="+Math.random())}else Main.gamePlatform==Main.platformIOS&&(t+="?MathRand="+Math.random());var o=new egret.HttpRequest;o.timeout=Main.reqTimeout,o.responseType=egret.HttpResponseType.TEXT,o.open(e.url+t,egret.HttpMethod.GET);for(var i in e.header)o.setRequestHeader(i,e.header[i]);o.send(),o.addEventListener(egret.Event.COMPLETE,function(t){var n={data:JSON.parse(t.target.response),statusCode:200};e.success(n)},this),o.addEventListener(egret.IOErrorEvent.IO_ERROR,e.fail,this)},t}(BaseClass);__reflect(Http.prototype,"Http"),window.Http=Http;var App=function(e){function t(){var t=e.call(this)||this;return t._deviceId=null,t.hasPlaySplash=!1,t.adConfig={splash:[],banner:[],video:[]},t._openAd=!1,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.getResRoot=function(){if(Main.gamePlatform==Main.platformTT);else if(Main.gamePlatform==Main.platformApp);else if(Main.gamePlatform==Main.platformIOS);else if(Main.gamePlatform==Main.platformH5&&window.res_root)return window.res_root+"resource/";
return"resource/"},Object.defineProperty(t.prototype,"deviceId",{get:function(){return this._deviceId},set:function(e){this._deviceId=e},enumerable:!0,configurable:!0}),t.prototype.initDeviceId=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return[2,new Promise(function(t,n){if(Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS)Openadsdk.GetDevice(function(n){console.log("GetDevice:"+n),e.deviceId=""+n,t()},e,"");else if(Main.gamePlatform==Main.platformH5){var r="";if(location&&location.search){var i=location.search.substring(1),o=i.split("&");for(var s in o){var a=o[s].split("=");"uuid"==a[0]&&(r=a[1])}}e.deviceId=r,t()}else t()})]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return Main.gamePlatform!=Main.platformTT?[3,2]:[4,WxService.login()];case 1:return e.sent(),[3,6];case 2:return Main.gamePlatform!=Main.platformApp&&Main.gamePlatform!=Main.platformIOS?[3,4]:[4,wx.login()];case 3:return e.sent(),[3,6];case 4:return Main.gamePlatform!=Main.platformH5?[3,6]:[4,wx.login()];case 5:e.sent(),e.label=6;case 6:return[2]}})})},t.prototype.watchAdCall=function(e,t){Main.gamePlatform==Main.platformTT?AdService.watchAdTip(e,t):Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS?AndroidAd.Reward(e,t):Main.gamePlatform==Main.platformH5&&ScoreService.Reward(e,t)},t.prototype.playRewardVideoAd=function(e){Main.gamePlatform==Main.platformTT?AdService.watchAd(e):Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS?AndroidAd.Reward(e):Main.gamePlatform==Main.platformH5&&ScoreService.Reward(e)},t.prototype.playBannerAd=function(e){return Main.gamePlatform==Main.platformTT?AdService.createBannerAd(e):Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS?(AndroidAd.Banner(),null):void 0},t.prototype.destoryBanner=function(){Main.gamePlatform==Main.platformTT?AdService.destoryBanner():(Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS)&&AndroidAd.CloseBannerAd()},t.prototype.isShowShareBtn=function(){if(Main.gamePlatform==Main.platformTT){var e=(new Date).getTime();if(e-Main.recordStartTime>Main.recordTime)return!0}return!1},t.prototype.splash=function(){Main.gamePlatform!=Main.platformApp&&Main.gamePlatform!=Main.platformIOS||!this.isOpenAd()||this.hasPlaySplash||(AndroidAd.Splash(),this.hasPlaySplash=!0)},t.prototype.reqAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,n){if(Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformTT){var r={url:encodeURI(Main.host+Api.AD_CONFIG),header:{zmgGameId:Main.adId,zmgPlatform:Main.gamePlatform,zmgVersion:Main.version},data:{},method:"GET",success:function(n){if(console.log("request success!",n),n.data.data){var r=n.data.data.showAd;t.ins().setOpenAd(r),t.ins().setAdConfig(n.data.data.configList)}e()},fail:function(t){console.log("request fail!",t),e()}};wx.request(r)}else e()})]})})},t.prototype.setAdConfig=function(e){this.adConfig={splash:[],banner:[],video:[]};for(var t in e){var n=e[t];n.weight<=0||(0==n.adPos?this.adConfig.splash.push(n):1==n.adPos?this.adConfig.banner.push(n):2==n.adPos&&this.adConfig.video.push(n))}var r={version:Main.version,isOpenAd:this._openAd,adConfig:this.adConfig};CacheUtil.set(Constant.AD_CFG,JSON.stringify(r))},t.prototype.getAd=function(e){var t,n={type:1,url:"",img:"",text:""};0==e?t=this.adConfig.splash:1==e?t=this.adConfig.banner:2==e&&(t=this.adConfig.video);var r=[],i=0;for(var o in t)i+=t[o].weight,r.push(i);for(var s=Math.random()*r[r.length-1],a=0,h=0;h<r.length;h++)if(s<=r[h]){a=h;break}var l=t[a];if(n.type=l.adType,0==n.type){var u=JSON.parse(l.url);n.url=u.url?u.url:"",n.img=u.img?u.img:"",n.text=u.text?u.text:""}return n},t.prototype.setOpenAd=function(e){this._openAd=e?!0:!1},t.prototype.isOpenAd=function(){return this._openAd},t.prototype.hideAdIcon=function(){return(Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS)&&!this.isOpenAd()},t.prototype.playOpenAd=function(){var e=CacheUtil.get(Constant.AD_CFG);if(e&&""!=e){var t=JSON.parse(e);t.version==Main.version&&(this._openAd=t.isOpenAd,this.adConfig=t.adConfig?t.adConfig:this.adConfig,this.splash())}else;},t.prototype.getShowUserProto=function(){if(Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS){var e=CacheUtil.get(Constant.USER_PROTO);if("1"!=e)return!0}return!1},t.prototype.setShowUserProto=function(e){var t=e?"1":"0";CacheUtil.set(Constant.USER_PROTO,t)},t.prototype.adNotScore=function(){return Main.gamePlatform==Main.platformH5?!1:!0},t}(BaseClass);__reflect(App.prototype,"App"),window.App=App;var ByteArrayMsgByProtobuf=function(e){function t(){var n=e.call(this)||this;n.msgClass=null,n.protoConfig=null,n.protoConfigSymmetry=null,n.ProtoFile=null,n.msgClass={},n.protoConfig=t.ProtoConfig,n.protoConfigSymmetry={};for(var r=Object.keys(n.protoConfig),i=0,o=r.length;o>i;i++){var s=r[i],a=n.protoConfig[s];n.protoConfigSymmetry[a]=s}return n}return __extends(t,e),t.prototype.getMsgClass=function(e){var t=this.msgClass[e];return null==t&&(t=this.ProtoFile.build(e),this.msgClass[e]=t),t},t.prototype.getMsgID=function(e){return this.protoConfigSymmetry[e]},t.prototype.getMsgKey=function(e){return this.protoConfig[e]},t.prototype.decode=function(e){var t=e.readShort(),n=e.readShort();if(e.bytesAvailable>=n){var r=new egret.ByteArray;e.readBytes(r,0,n);var i={};return i.key=this.getMsgKey(t),DebugUtils.start("Protobuf Decode"),i.body=this.getMsgClass(i.key).decode(r.buffer),DebugUtils.stop("Protobuf Decode"),Log.trace("收到数据：","["+t+" "+i.key+"]",i.body),i}return null},t.prototype.encode=function(e){var t=this.getMsgID(e.key),n=new(this.getMsgClass(e.key))(e.body);DebugUtils.start("Protobuf Encode");var r=new egret.ByteArray(n.toArrayBuffer());DebugUtils.stop("Protobuf Encode"),Log.trace("发送数据：","["+t+" "+e.key+"]",e.body);var i=new egret.ByteArray;return i.writeShort(t),i.writeBytes(r),i},t.ProtoConfig=null,t}(ByteArrayMsg);__reflect(ByteArrayMsgByProtobuf.prototype,"ByteArrayMsgByProtobuf"),window.ByteArrayMsgByProtobuf=ByteArrayMsgByProtobuf;var Socket=function(e){function t(){var t=e.call(this)||this;return t._needReconnect=!1,t._maxReconnectCount=10,t._reconnectCount=0,t}return __extends(t,e),t.prototype.addEvents=function(){this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},t.prototype.removeEvents=function(){this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},t.prototype.onSocketOpen=function(){this._reconnectCount=0,this._connectFlag?MessageCenter.ins().dispatch(SocketConst.SOCKET_RECONNECT):MessageCenter.ins().dispatch(SocketConst.SOCKET_CONNECT),this._connectFlag=!0,this._isConnecting=!0},t.prototype.onSocketClose=function(){this._needReconnect?(this.reconnect(),MessageCenter.ins().dispatch(SocketConst.SOCKET_START_RECONNECT)):MessageCenter.ins().dispatch(SocketConst.SOCKET_CLOSE),this._isConnecting=!1},t.prototype.onSocketError=function(){this._needReconnect?this.reconnect():MessageCenter.ins().dispatch(SocketConst.SOCKET_NOCONNECT),this._isConnecting=!1},t.prototype.onReceiveMessage=function(e){this._msg.receive(this._socket)},t.prototype.initServer=function(e,t,n){this._host=e,this._port=t,this._msg=n},t.prototype.connect=function(){this._socket=new egret.WebSocket,this._msg instanceof ByteArrayMsg&&(this._socket.type=egret.WebSocket.TYPE_BINARY),Log.trace("WebSocket: "+this._host+":"+this._port),this._socket.connect(this._host,this._port),this.addEvents()},t.prototype.reconnect=function(){this.close(),this._reconnectCount++,this._reconnectCount<this._maxReconnectCount?this.connect():(this._reconnectCount=0,this._connectFlag?MessageCenter.ins().dispatch(SocketConst.SOCKET_CLOSE):MessageCenter.ins().dispatch(SocketConst.SOCKET_NOCONNECT))},t.prototype.send=function(e){this._msg.send(this._socket,e)},t.prototype.close=function(){this.removeEvents(),this._socket.close(),this._socket=null,this._isConnecting=!1,this._connectFlag=!1},t.prototype.isConnecting=function(){return this._isConnecting},t.prototype.debugInfo=function(e){MessageCenter.ins().dispatch(SocketConst.SOCKET_DEBUG_INFO,e)},t}(BaseClass);__reflect(Socket.prototype,"Socket"),window.Socket=Socket;var SocketConst=function(){function e(){}return e.SOCKET_CONNECT="SOCKET_CONNECT",e.SOCKET_RECONNECT="SOCKET_RECONNECT",e.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",e.SOCKET_CLOSE="SOCKET_CLOSE",e.SOCKET_DATA="SOCKET_DATA",e.SOCKET_NOCONNECT="SOCKET_NOCONNECT",e.SOCKET_DEBUG_INFO="SOCKET_DEBUG_INFO",e}();__reflect(SocketConst.prototype,"SocketConst"),window.SocketConst=SocketConst;var DelayOptManager=function(e){function t(){var t=e.call(this)||this;return t.TIME_THRESHOLD=2,t._delayOpts=[],egret.startTick(t.runCachedFun,t),t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.addDelayOptFunction=function(e,t,n,r,i){this._delayOpts.push({fun:t,funPara:n,thisObj:e,callBack:r,para:i})},t.prototype.clear=function(){this._delayOpts.length=0},t.prototype.runCachedFun=function(e){if(0==this._delayOpts.length)return!1;for(var t,n=egret.getTimer();this._delayOpts.length&&(t=this._delayOpts.shift(),t.funPara?t.fun.call(t.thisObj,t.funPara):t.fun.call(t.thisObj),t.callBack&&(void 0!=t.para?t.callBack.call(t.thisObj,t.para):t.callBack()),!(egret.getTimer()-n>this.TIME_THRESHOLD)););return!1},t}(BaseClass);__reflect(DelayOptManager.prototype,"DelayOptManager"),window.DelayOptManager=DelayOptManager;var UTFMsgByJson=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.decode=function(e){return JSON.parse(e)},t.prototype.encode=function(e){return JSON.stringify(e)},t}(UTFMsg);__reflect(UTFMsgByJson.prototype,"UTFMsgByJson"),window.UTFMsgByJson=UTFMsgByJson;var DebugPlatform=function(){function e(){}return e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){wx.login({force:!1,success:function(t){console.log("wx.login调用成功"+t.code+" "+t.anonymousCode),e(t)},fail:function(e){t({msg:"login fail!",err:e})}})})]})})},e.prototype.getSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){wx.getSystemInfo({success:function(t){e(t)},fail:function(e){t({msg:"getSystemInfo fail!",err:e})}})})]})})},e.prototype.onShow=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return wx.onShow(function(){e.call(t)}),[2]})})},e.prototype.downloadFile=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,n){wx.downloadFile({url:e,success:function(e){t(e)}})})]})})},e.prototype.getStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,n){wx.getStorage({key:e,success:function(e){t(e.data)},fail:function(e){n(e)}})})]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["WxApi"]),window.wxapi||(window.wxapi=new DebugPlatform),window.DebugPlatform=DebugPlatform;var ObjectPool=function(){function e(){this._objs=new Array}return e.prototype.pushObj=function(e){this._objs.push(e)},e.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},e.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},e.pop=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e._content[t]||(e._content[t]=[]);var i=e._content[t];if(i.length){var o=i.pop();return o}var s=egret.getDefinitionByName(t),a=(n.length,void 0);return a=new(s.bind.apply(s,[void 0].concat(n))),a.ObjectPoolKey=t,a},e.popWithExtraKey=function(t,n){e._content[t]||(e._content[t]=[]);var r,i=e._content[t];if(i.length)for(var o=0;o<i.length;o++)if(i[o].extraKey==n){r=i[o],i.splice(o,1);break}if(!r){var s=egret.getDefinitionByName(t);r=new s(n),r.extraKey=n,r.ObjectPoolKey=t}return r},e.push=function(t){if(null==t)return!1;var n=t.ObjectPoolKey;return!e._content[n]||e._content[n].indexOf(t)>-1?!1:(e._content[n].push(t),!0)},e.clear=function(){e._content={}},e.clearClass=function(t,n){void 0===n&&(n=null);for(var r=e._content[t];r&&r.length;){var i=r.pop();n&&i[n](),i=null}e._content[t]=null,delete e._content[t]},e.dealFunc=function(t,n){var r=e._content[t];if(null!=r){var i=0,o=r.length;for(i;o>i;i++)r[i][n]()}},e._content={},e}();__reflect(ObjectPool.prototype,"ObjectPool"),window.ObjectPool=ObjectPool;var BaseSpriteLayer=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!1,t}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(BaseSpriteLayer.prototype,"BaseSpriteLayer"),window.BaseSpriteLayer=BaseSpriteLayer;var TimerManager=function(e){function t(){var t=e.call(this)||this;return t._handlers=new Array,t._delHandlers=new Array,t._currTime=egret.getTimer(),t._currFrame=0,t._count=0,t._timeScale=1,egret.Ticker.getInstance().register(t.onEnterFrame,t),t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.setTimeScale=function(e){this._timeScale=e},t.prototype.onEnterFrame=function(){if(!this._isPause){for(this._currFrame++,this._currTime=egret.getTimer();this._delHandlers.length;)this.removeHandle(this._delHandlers.pop());for(var e=0;e<this._count;e++){var t=this._handlers[e];if(-1==this._delHandlers.indexOf(t)){var n=t.userFrame?this._currFrame:this._currTime;n>=t.exeTime&&(t.method.call(t.methodObj,(this._currTime-t.dealTime)*this._timeScale),t.dealTime=this._currTime,t.exeTime+=t.delay,t.repeat||(t.repeatCount>1?t.repeatCount--:(t.complateMethod&&t.complateMethod.apply(t.complateMethodObj),-1==this._delHandlers.indexOf(t)&&this._delHandlers.push(t))))}}}},t.prototype.removeHandle=function(e){var t=this._handlers.indexOf(e);-1!=t&&(this._handlers.splice(t,1),ObjectPool.push(e),this._count--)},t.prototype.create=function(e,t,n,r,i,o,s){if(!(0>t||0>n||null==r)){this.remove(r,i);var a=ObjectPool.pop("TimerHandler");a.userFrame=e,a.repeat=0==n,a.repeatCount=n,a.delay=t,a.method=r,a.methodObj=i,a.complateMethod=o,a.complateMethodObj=s,a.exeTime=t+(e?this._currFrame:this._currTime),a.dealTime=this._currTime,this._handlers.push(a),this._count++}},t.prototype.setTimeOut=function(e,t,n){this.doTimer(e,1,t,n)},t.prototype.setFrameOut=function(e,t,n){this.doFrame(e,1,t,n)},t.prototype.doTimer=function(e,t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this.create(!1,e,t,n,r,i,o)},t.prototype.doFrame=function(e,t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this.create(!0,e,t,n,r,i,o)},Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),t.prototype.remove=function(e,t){for(var n=0;n<this._count;n++){var r=this._handlers[n];if(r.method==e&&r.methodObj==t&&-1==this._delHandlers.indexOf(r)){this._delHandlers.push(r);break}}},t.prototype.removeAll=function(e){for(var t=0;t<this._count;t++){var n=this._handlers[t];n.methodObj==e&&-1==this._delHandlers.indexOf(n)&&this._delHandlers.push(n)}},t.prototype.isExists=function(e,t){for(var n=0;n<this._count;n++){var r=this._handlers[n];if(r.method==e&&r.methodObj==t&&-1==this._delHandlers.indexOf(r))return!0}return!1},t.prototype.pause=function(){this._isPause||(this._isPause=!0,this._pauseTime=egret.getTimer())},t.prototype.resume=function(){if(this._isPause){this._isPause=!1,this._currTime=egret.getTimer();for(var e=this._currTime-this._pauseTime,t=0;t<this._count;t++){var n=this._handlers[t];n.dealTime+=e,n.userFrame||(n.exeTime+=e)}}},t.prototype.deleyPromisse=function(e){return new Promise(function(n,r){t.ins().doTimer(e,1,function(){n()},null)})},t}(BaseSystem);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function e(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return e.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},e}();__reflect(TimerHandler.prototype,"TimerHandler"),window.TimerManager=TimerManager,window.TimerHandler=TimerHandler;var SceneManager=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.clear=function(){var e=this._currScene;e&&(e.onExit(),this._currScene=void 0)},t.prototype.runScene=function(e){if(null==e)return void Log.trace("runScene:scene is null");var t=this._currScene;t&&(t.onExit(),t=void 0);var n=new e;n.onEnter(),this._currScene=n},t.prototype.getCurrScene=function(){return this._currScene},t.prototype.getSceneName=function(){return this._currScene?egret.getQualifiedClassName(this._currScene):""},t.CREATE_ROLE="CreateRoleScene",t.MAIN="MainScene",t}(BaseClass);__reflect(SceneManager.prototype,"SceneManager"),window.SceneManager=SceneManager;var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function r(r){t.call(n,r,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?r(i):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]),window.AssetAdapter=AssetAdapter;var SoundBg=function(e){function t(){var t=e.call(this)||this;return t._currBg="",t}return __extends(t,e),t.prototype.stop=function(){this._currSoundChannel&&this.removeSoundChannel(this._currSoundChannel),this._currSoundChannel=null,this._currSound=null,this._currBg=""},t.prototype.play=function(e,t){if(void 0===t&&(t=1),this._currBg!=e){this.stop(),this._currBg=e;var n=this.getSound(e);n&&this.playSound(n,t)}},t.prototype.touchPlay=function(){if(this._currSoundChannel&&this._currSound){var e=this._currSoundChannel.position;this.removeSoundChannel(this._currSoundChannel),this._currSoundChannel=this._currSound.play(e,1),this.addSoundChannel(this._currSoundChannel)}},t.prototype.playSound=function(e,t){void 0===t&&(t=1),this._currSound=e,this._currSoundChannel=this._currSound.play(0,t),this.addSoundChannel(this._currSoundChannel)},t.prototype.onSoundComplete=function(){this._currSoundChannel&&this.removeSoundChannel(this._currSoundChannel),this.playSound(this._currSound)},t.prototype.addSoundChannel=function(e){e.volume=this._volume,e.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)},t.prototype.removeSoundChannel=function(e){e.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),e.stop()},t.prototype.setVolume=function(e){this._volume=e,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},t.prototype.loadedPlay=function(e){if(this._currBg==e){var t=RES.getRes(e);if(!t)return;this.playSound(t)}},t.prototype.checkCanClear=function(e){return!1},t}(BaseSound);__reflect(SoundBg.prototype,"SoundBg"),window.SoundBg=SoundBg;var SoundEffects=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.play=function(e){var t=this.getSound(e);t&&this.playSound(t)},t.prototype.playSound=function(e){var t=e.play(0,1);t.volume=this._volume},t.prototype.setVolume=function(e){this._volume=e},t.prototype.loadedPlay=function(e){var t=RES.getRes(e);t&&this.playSound(t)},t.prototype.checkCanClear=function(e){var t=["square_tap_mp3","pass_mp3","finish_mp3","error_mp3","letter_tap_mp3"];return t.indexOf(e)>=0?!1:!0},t}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects"),window.SoundEffects=SoundEffects;var SoundManager=function(e){function t(){var t=e.call(this)||this;return t.bgOn=!0,t.effectOn=!0,t.bgVolume=.5,t.effectVolume=.5,t.soundPath={},t.bg=new SoundBg,t.bg.setVolume(t.bgVolume),t.effect=new SoundEffects,t.effect.setVolume(t.effectVolume),t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.playEffect=function(e,t){void 0===t&&(t=.5),this.effectOn&&UserModel.ins().musicOpen&&(this.setEffectVolume(t),this.effect.play(e))},t.prototype.playWord=function(e,t){void 0===t&&(t=.5),this.setEffectVolume(t),this.effect.play(e)},t.prototype.playBg=function(e){var t=this,n=e?e:Main.bgm;return this.currBg=n,this.bgOn&&UserModel.ins().musicOpen?RES.hasRes(n)?void this.bg.play(n,0):void TimerManager.ins().doTimer(1e3,1,function(){t.bg.play(n,0)},this):void 0},t.prototype.stopBg=function(){this.bg.stop()},t.prototype.touchBg=function(){egret.Capabilities.isMobile&&"iOS"==egret.Capabilities.os&&this.bg.touchPlay()},t.prototype.setEffectOn=function(e){this.effectOn=e},t.prototype.setBgOn=function(e){this.bgOn=e,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},t.prototype.setBgVolume=function(e){e=Math.min(e,1),e=Math.max(e,0),this.bgVolume=e,this.bg.setVolume(this.bgVolume)},t.prototype.getBgVolume=function(){return this.bgVolume},t.prototype.setEffectVolume=function(e){e=Math.min(e,1),e=Math.max(e,0),this.effectVolume!=e&&(this.effectVolume=e,this.effect.setVolume(this.effectVolume))},t.prototype.getEffectVolume=function(){return this.effectVolume},t.prototype.getSoundPath=function(e){if(!this.soundPath[e]){var t=RES.config.getResourceWithSubkey(e);this.soundPath[e]=t.r.root+t.r.url}return this.soundPath[e]?this.soundPath[e]:""},t.CLEAR_TIME=18e4,t}(BaseClass);__reflect(SoundManager.prototype,"SoundManager"),window.SoundManager=SoundManager;var ColorUtil=function(){function e(){}return e.mergeARGB=function(e,t,n,r){return e<<24|t<<16|n<<8|r},e.getChannel=function(e,t){switch(t){case this.ALPHA:return e>>24&255;case this.RED:return e>>16&255;case this.GREEN:return e>>8&255;case this.BLUE:return 255&e}return 0},e.numberToString=function(e,t){return void 0===t&&(t="#"),t+e.toString(16)},e.ALPHA=4080082432,e.RED=15937822,e.GREEN=3532333,e.BLUE=255,e.NORMAL_COLOR=13746831,e.RED_COLOR_N=15937822,e.GREEN_COLOR_N=3532333,e.GRAY_COLOR2=8618883,e.WHITE_COLOR2=13746831,e.WHITE_COLOR="#D1C28F",e.RED_COLOR="#F3311E",e.GREEN_COLOR="#35E62D",e.GRAY_COLOR="#8B898B",e.COLOR_STR=["白色","绿色","紫色","橙色","红色","金色"],e.ROLENAME_COLOR_YELLOW=16764427,e.ROLENAME_COLOR_GREEN=3532333,e.ROLENAME_COLOR_NORMAL=3532333,e.JUEWEI_COLOR=["#e2dfd4","#35e62d","#81adff","#e27dff","#ff9649","#fc5959","#ffd93f","#ffff00"],e}();__reflect(ColorUtil.prototype,"ColorUtil"),window.ColorUtil=ColorUtil;var DateStyle=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.format=[],o.from=0,o.to=0,o.isFormatNum=!1,o.format=t,o.from=n,o.to=r,o.isFormatNum=i,o}return __extends(t,e),t}(BaseClass);__reflect(DateStyle.prototype,"DateStyle");var DateUtils=function(){function e(){}return e.getFormatTimeByStyle=function(t,n){if(void 0===n&&(n=e.STYLE_1),0>t&&(t=0,debug.log("输入参数有误!时间为负数:"+t)),n.from>n.to)return debug.log("输入参数有误!to参数必须大于等于from参数,请检查style参数的值"),"";t>>=0;for(var r="",i=n.to;i>=n.from;i--){var o=t/this.mul[i],s="";i!=n.to&&(o%=this.mod[i]),s=n.isFormatNum&&10>o?"0"+(o>>0).toString():(o>>0).toString(),r+=s+n.format[i]}return r},e.getFormatTimeByStyle1=function(t,n){return void 0===n&&(n=e.STYLE_1),this.getFormatTimeByStyle(t/this.MS_PER_SECOND)},e.formatMiniDateTime=function(t){return e.MINI_DATE_TIME_BASE+(2147483647&t)*e.MS_PER_SECOND},e.formatServerTime=function(t){return(t-e.MINI_DATE_TIME_BASE)/e.MS_PER_SECOND},e.getFormatBySecond=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=2);var r="",i=1e3*e;switch(t){case this.TIME_FORMAT_0:r=i>=36e5?this.format_1(i):this.format_3(i);break;case this.TIME_FORMAT_1:r=this.format_1(i);break;case this.TIME_FORMAT_2:r=this.format_2(i);break;case this.TIME_FORMAT_3:r=this.format_3(i);break;case this.TIME_FORMAT_4:r=this.format_4(i);break;case this.TIME_FORMAT_5:r=this.format_5(i,n);break;case this.TIME_FORMAT_6:r=this.format_6(i);break;case this.TIME_FORMAT_7:r=this.format_7(i);break;case this.TIME_FORMAT_8:r=this.format_8(i);break;case this.TIME_FORMAT_9:r=this.format_9(i);break;case this.TIME_FORMAT_10:r=this.format_10(i);break;case this.TIME_FORMAT_11:r=this.format_11(i);break;case this.TIME_FORMAT_12:r=this.format_12(i);break;case this.TIME_FORMAT_13:r=this.format_13(i);break;case this.TIME_FORMAT_14:r=this.format_14(i);break;case this.TIME_FORMAT_15:r=this.format_15(i);break;case this.TIME_FORMAT_16:r=this.format_16()}return r},e.getRenainSecond=function(t){var n=t?new Date(t):new Date,r=e.getTodayZeroSecond(n)+86400-n.getTime()/1e3;return r.toFixed(0)},e.getTodayPassedSecond=function(){var e=new Date,t=((Date.now()-new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime())/1e3).toFixed(0);return parseInt(t)},e.getTodayZeroSecond=function(e){var t=e?e:new Date;return parseInt((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()/1e3).toFixed(0))},e.showWeekFirstDay=function(){var e=new Date,t=e.getDay();t=t?t:7;var n=new Date(e-864e5*(t-1));return n},e.showWeekLastDay=function(){var t=(new Date,e.showWeekFirstDay()),n=new Date(1e3*(t/1e3+518400));return n},e.calcWeekFirstDay=function(){var e=new Date,t=e.getDay();t=t>0?t:7;var n=7-t,r=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),s=86400*n*1e3+864e5-(3600*r*1e3+60*i*1e3+1e3*o);return new Date(s)},e.format_1=function(t){var n=0,r="##:##:##";return n=Math.floor(t/e.MS_PER_HOUR),r=r.replace("##",e.formatTimeNum(n)),n&&(t-=n*e.MS_PER_HOUR),n=Math.floor(t/e.MS_PER_MINUTE),r=r.replace("##",e.formatTimeNum(n)),n&&(t-=n*e.MS_PER_MINUTE),n=Math.floor(t/1e3),r=r.replace("##",e.formatTimeNum(n))},e.format_2=function(e){var t=new Date(e),n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),o=t.getHours(),s=t.getMinutes(),a=t.getSeconds();return n+"-"+r+"-"+i+" "+o+":"+s+":"+a},e.format_3=function(e){var t=this.format_1(e),n=t.split(":");return n[1]+":"+n[2]},e.format_4=function(e){return e<this.MS_PER_HOUR?Math.floor(e/this.MS_PER_MINUTE)+"分钟前":e<this.MS_PER_DAY?Math.floor(e/this.MS_PER_HOUR)+"小时前":Math.floor(e/this.MS_PER_DAY)+"天前"},e.format_5=function(e,t){void 0===t&&(t=2);var n="",r=["天","时","分","秒"],i=[],o=Math.floor(e/this.MS_PER_DAY);i.push(o),e-=o*this.MS_PER_DAY;var s=Math.floor(e/this.MS_PER_HOUR);i.push(s),e-=s*this.MS_PER_HOUR;var a=Math.floor(e/this.MS_PER_MINUTE);i.push(a),e-=a*this.MS_PER_MINUTE;var h=Math.floor(e/1e3);i.push(h);for(var l in i)if(i[l]>0&&(n+=this.formatTimeNum(i[l],Number(l))+r[l],t--,0>=t))break;return n},e.format_6=function(e){var t=new Date(e),n=t.getHours(),r=t.getMinutes(),i=t.getSeconds();return this.formatTimeNum(n)+":"+this.formatTimeNum(r)+":"+this.formatTimeNum(i)},e.format_7=function(e){return e<this.MS_PER_HOUR?"<1小时":e<this.MS_PER_DAY?Math.floor(e/this.MS_PER_HOUR)+"小时":Math.floor(e/this.MS_PER_DAY)+"天"},e.format_8=function(e){var t=new Date(e),n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),o=t.getHours(),s=t.getMinutes();return n+"-"+r+"-"+i+" "+o+":"+s},e.format_9=function(e){var t=Math.floor(e/this.MS_PER_HOUR);e-=t*this.MS_PER_HOUR;var n=Math.floor(e/this.MS_PER_MINUTE);e-=n*this.MS_PER_MINUTE;var r=Math.floor(e/1e3);return t+"小时"+n+"分钟"+r+"秒"},e.format_10=function(e){var t=Math.floor(e/this.MS_PER_MINUTE);e-=t*this.MS_PER_MINUTE;var n=Math.floor(e/1e3);return t+"分"+n+"秒"},e.format_11=function(e){var t=Math.floor(e/this.MS_PER_HOUR);e-=t*this.MS_PER_HOUR;var n=Math.floor(e/this.MS_PER_MINUTE);e-=n*this.MS_PER_MINUTE;var r=Math.floor(e/1e3);return t+"时"+n+"分"+r+"秒"},e.format_12=function(t){var n=Math.floor(t/this.MS_PER_HOUR);t-=n*this.MS_PER_HOUR;var r=Math.floor(t/this.MS_PER_MINUTE);t-=r*this.MS_PER_MINUTE;var i=Math.floor(t/1e3);return e.formatTimeNum(n)+":"+e.formatTimeNum(r)+":"+e.formatTimeNum(i)},e.format_13=function(t){var n=new Date(t),r=(n.getFullYear(),n.getMonth()+1),i=n.getDay(),o=n.getDate(),s=n.getHours(),a=n.getMinutes();return r+"月"+o+"日(周"+this.WEEK_CN[i]+") "+e.formatTimeNum(s)+":"+e.formatTimeNum(a)},e.format_14=function(e){var t=new Date(e),n=t.getHours(),r=t.getMinutes();return n+"时"+r+"分"},e.format_15=function(t){var n=new Date(t),r=n.getMonth()+1,i=n.getDate(),o=n.getHours(),s=n.getMinutes();return e.formatTimeNum(r)+"-"+e.formatTimeNum(i)+" "+e.formatTimeNum(o)+":"+e.formatTimeNum(s)},e.format_16=function(){var t=new Date,n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),o=t.getHours(),s=t.getMinutes(),a=t.getSeconds();return n+e.formatTimeNum(r)+e.formatTimeNum(i)+e.formatTimeNum(o)+e.formatTimeNum(s)+e.formatTimeNum(a)},e.formatTimeNum=function(e,t){return e>=10?e.toString():0==t?e.toString():"0"+e},e.checkTime=function(e,t){var n=(new Date).getTime(),r=e>n+t*this.MS_PER_DAY;return r},e.formatFullTime=function(e){var t,n,r=new Date(e),i=r.getFullYear(),o=r.getMonth()+1,s=r.getDate(),a=r.getDay(),h=r.getHours();n=10>h?"0"+h:h.toString();var l,u=r.getMinutes();l=10>u?"0"+u:u.toString();var c;switch(a){case 1:c="一";break;case 2:c="二";break;case 3:c="三";break;case 4:c="四";break;case 5:c="五";break;case 6:c="六";break;case 0:c="日"}return t=i+"年"+o+"月"+s+"日（周"+c+"） "+n+":"+l},e.formatStrTimeToMs=function(e){var t=new Date,n=e.split(".");t.setFullYear(n[0]),t.setMonth(+n[1]-1);var r=n[2].split("-");t.setDate(r[0]);var i=r[1].split(":");return t.setHours(i[0]),t.setMinutes(i[1]),t.setSeconds(0),t.getTime()},e.nowDay=function(){var e=new Date,t=(e.getTime()-60*e.getTimezoneOffset()*1e3)/864e5;return Math.floor(t)},e.TIME_FORMAT_0=0,e.TIME_FORMAT_1=1,e.TIME_FORMAT_2=2,e.TIME_FORMAT_3=3,e.TIME_FORMAT_4=4,e.TIME_FORMAT_5=5,e.TIME_FORMAT_6=6,e.TIME_FORMAT_7=7,e.TIME_FORMAT_8=8,e.TIME_FORMAT_9=9,e.TIME_FORMAT_10=10,e.TIME_FORMAT_11=11,e.TIME_FORMAT_12=12,e.TIME_FORMAT_13=13,e.TIME_FORMAT_14=14,e.TIME_FORMAT_15=15,e.TIME_FORMAT_16=16,e.MS_PER_SECOND=1e3,e.MS_PER_MINUTE=6e4,e.MS_PER_HOUR=36e5,e.MS_PER_DAY=864e5,e.SECOND_PER_HOUR=3600,e.SECOND_PER_DAY=86400,e.SECOND_PER_MONTH=2592e3,e.SECOND_PER_YEAR=31104e3,e.DAYS_PER_WEEK=7,e.YEAR_PER_YEAR=1,e.MONTH_PER_YEAR=12,e.DAYS_PER_MONTH=30,e.HOURS_PER_DAY=24,e.MUNITE_PER_HOUR=60,e.SECOND_PER_MUNITE=60,e.SECOND_PER_SECOND=1,e.SECOND_2010=1262275200,e.mod=[e.SECOND_PER_MUNITE,e.MUNITE_PER_HOUR,e.HOURS_PER_DAY,e.DAYS_PER_MONTH,e.MONTH_PER_YEAR,e.YEAR_PER_YEAR],e.mul=[e.SECOND_PER_SECOND,e.SECOND_PER_MUNITE,e.SECOND_PER_HOUR,e.SECOND_PER_DAY,e.SECOND_PER_MONTH,e.SECOND_PER_YEAR],e.MINI_DATE_TIME_BASE=Date.UTC(2010,0)+(new Date).getTimezoneOffset()*e.MS_PER_MINUTE,e.TIME_ZONE_OFFSET=8*e.MS_PER_HOUR,e.TO_SECOND=0,e.TO_MINUTE=1,e.TO_HOUR=2,e.TO_DAY=3,e.TO_MONTH=4,e.TO_YEAR=5,e.FORMAT_1=["秒","分","时","天","月","年"],e.FORMAT_2=[":",":",":",":",":",":"],e.WEEK_CN=["日","一","二","三","四","五","六"],e.STYLE_1=new DateStyle(e.FORMAT_1,e.TO_SECOND,e.TO_HOUR,!1),e.STYLE_2=new DateStyle(e.FORMAT_1,e.TO_SECOND,e.TO_DAY,!1),e.STYLE_3=new DateStyle(e.FORMAT_2,e.TO_SECOND,e.TO_HOUR,!0),e.STYLE_4=new DateStyle(e.FORMAT_1,e.TO_SECOND,e.TO_MINUTE,!0),e}();__reflect(DateUtils.prototype,"DateUtils"),window.DateStyle=DateStyle,window.DateUtils=DateUtils;var DebugUtils=function(){function e(){}return e.isOpen=function(e){this._isOpen=e},Object.defineProperty(e,"isDebug",{get:function(){return window.isDebug?window.isDebug:!1},enumerable:!0,configurable:!0}),e.log=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e.isDebug&&console.log(t,n.length?n:void 0)},e.warn=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];e.isDebug&&console.warn(t,n.length?n:void 0)},e.error=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error(e,t.length?t:void 0)},e.start=function(e){this._isOpen&&(this._startTimes[e]=egret.getTimer())},e.stop=function(e){if(!this._isOpen)return 0;if(!this._startTimes[e])return 0;var t=egret.getTimer()-this._startTimes[e];return t>this._threshold&&Log.trace(e+": "+t),t},e.setThreshold=function(e){this._threshold=e
},e._startTimes={},e._threshold=3,e}();__reflect(DebugUtils.prototype,"DebugUtils");var debug={log:DebugUtils.log,warn:DebugUtils.warn,error:DebugUtils.error};window.DebugUtils=DebugUtils;var DisplayUtils=function(){function e(){}return e.setScale=function(e,t){e.scaleX=e.scaleY=t},e.createBitmap=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},e.removeFromParent=function(e){e&&null!=e.parent&&e.parent.removeChild(e)},e.scrollerToBottom=function(e){e.viewport.validateNow(),e.viewport.contentHeight>e.height&&(e.viewport.scrollV=e.viewport.contentHeight-e.height)},e.scrollVTo=function(e,t,n){e.viewport.validateNow(),e.viewport.scrollV=t>n?n:t},e.alphaTween=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=1),e.alpha=n,egret.Tween.get(e).to({alpha:r},t)},e.shakingList={},e}();__reflect(DisplayUtils.prototype,"DisplayUtils"),window.DisplayUtils=DisplayUtils;var Log=function(){function e(){}return e.trace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];DebugUtils.isDebug&&(e[0]="[DebugLog]"+e[0],debug.log.apply(console,e))},e}();__reflect(Log.prototype,"Log"),window.Log=Log;var MathUtils=function(){function e(){}return e.getAngle=function(e){return 180*e/Math.PI},e.getRadian=function(e){return e/180*Math.PI},e.getRadian2=function(e,t,n,r){var i=n-e,o=r-t;return Math.atan2(o,i)},e.getDistance=function(e,t,n,r){var i=n-e,o=r-t,s=i*i+o*o;return Math.sqrt(s)},e.getDistanceByObject=function(e,t){return this.getDistance(e.x,e.y,t.x,t.y)},e.getDistanceX2ByObject=function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r},e.getDirMove=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=this.getRadian(e),o={x:0,y:0};return o.x=Math.cos(i)*t+n,o.y=Math.sin(i)*t+r,o},e.limit=function(e,t){var n=Math.random()*(t-e)+e;return n},e.limitInteger=function(e,t){return Math.round(this.limit(e,t))},e.randomArray=function(e){var t=Math.floor(Math.random()*e.length);return e[t]},e.toInteger=function(e){return e>>0},e.getPByDistance=function(e,t,n){var r=Math.atan2(t.y-e.y,t.x-e.x),i={x:0,y:0};return i.x=t.x+n*Math.cos(r),i.y=t.y+n*Math.sin(r),i},e}();__reflect(MathUtils.prototype,"MathUtils"),window.MathUtils=MathUtils;var md5=function(){function e(){}return e.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.any_hmac_md5=function(e,t,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),n)},e.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.rstr_hmac_md5=function(e,t){var n=this.rstr2binl(e);n.length>16&&(n=this.binl_md5(n,8*e.length));for(var r=Array(16),i=Array(16),o=0;16>o;o++)r[o]=909522486^n[o],i[o]=1549556828^n[o];var s=this.binl_md5(r.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(i.concat(s),640))},e.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var n,r=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",o=0;o<e.length;o++)n=e.charCodeAt(o),i+=r.charAt(n>>>4&15)+r.charAt(15&n);return i},e.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",i=e.length,o=0;i>o;o+=3)for(var s=e.charCodeAt(o)<<16|(i>o+1?e.charCodeAt(o+1)<<8:0)|(i>o+2?e.charCodeAt(o+2):0),a=0;4>a;a++)r+=8*o+6*a>8*e.length?this.b64pad:n.charAt(s>>>6*(3-a)&63);return r},e.rstr2any=function(e,t){var n,r,i,o,s,a=t.length,h=Array(Math.ceil(e.length/2));for(n=0;n<h.length;n++)h[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var l=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),u=Array(l);for(r=0;l>r;r++){for(s=Array(),o=0,n=0;n<h.length;n++)o=(o<<16)+h[n],i=Math.floor(o/a),o-=i*a,(s.length>0||i>0)&&(s[s.length]=i);u[r]=o,h=s}var c="";for(n=u.length-1;n>=0;n--)c+=t.charAt(u[n]);return c},e.str2rstr_utf8=function(e){for(var t,n,r="",i=-1;++i<e.length;)t=e.charCodeAt(i),n=i+1<e.length?e.charCodeAt(i+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),i++),127>=t?r+=String.fromCharCode(t):2047>=t?r+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?r+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(r+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return r},e.str2rstr_utf16le=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t},e.str2rstr_utf16be=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t},e.rstr2binl=function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},e.binl2rstr=function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t},e.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,h=r,l=i,u=o;n=this.md5_ff(n,r,i,o,e[s+0],7,-680876936),o=this.md5_ff(o,n,r,i,e[s+1],12,-389564586),i=this.md5_ff(i,o,n,r,e[s+2],17,606105819),r=this.md5_ff(r,i,o,n,e[s+3],22,-1044525330),n=this.md5_ff(n,r,i,o,e[s+4],7,-176418897),o=this.md5_ff(o,n,r,i,e[s+5],12,1200080426),i=this.md5_ff(i,o,n,r,e[s+6],17,-1473231341),r=this.md5_ff(r,i,o,n,e[s+7],22,-45705983),n=this.md5_ff(n,r,i,o,e[s+8],7,1770035416),o=this.md5_ff(o,n,r,i,e[s+9],12,-1958414417),i=this.md5_ff(i,o,n,r,e[s+10],17,-42063),r=this.md5_ff(r,i,o,n,e[s+11],22,-1990404162),n=this.md5_ff(n,r,i,o,e[s+12],7,1804603682),o=this.md5_ff(o,n,r,i,e[s+13],12,-40341101),i=this.md5_ff(i,o,n,r,e[s+14],17,-1502002290),r=this.md5_ff(r,i,o,n,e[s+15],22,1236535329),n=this.md5_gg(n,r,i,o,e[s+1],5,-165796510),o=this.md5_gg(o,n,r,i,e[s+6],9,-1069501632),i=this.md5_gg(i,o,n,r,e[s+11],14,643717713),r=this.md5_gg(r,i,o,n,e[s+0],20,-373897302),n=this.md5_gg(n,r,i,o,e[s+5],5,-701558691),o=this.md5_gg(o,n,r,i,e[s+10],9,38016083),i=this.md5_gg(i,o,n,r,e[s+15],14,-660478335),r=this.md5_gg(r,i,o,n,e[s+4],20,-405537848),n=this.md5_gg(n,r,i,o,e[s+9],5,568446438),o=this.md5_gg(o,n,r,i,e[s+14],9,-1019803690),i=this.md5_gg(i,o,n,r,e[s+3],14,-187363961),r=this.md5_gg(r,i,o,n,e[s+8],20,1163531501),n=this.md5_gg(n,r,i,o,e[s+13],5,-1444681467),o=this.md5_gg(o,n,r,i,e[s+2],9,-51403784),i=this.md5_gg(i,o,n,r,e[s+7],14,1735328473),r=this.md5_gg(r,i,o,n,e[s+12],20,-1926607734),n=this.md5_hh(n,r,i,o,e[s+5],4,-378558),o=this.md5_hh(o,n,r,i,e[s+8],11,-2022574463),i=this.md5_hh(i,o,n,r,e[s+11],16,1839030562),r=this.md5_hh(r,i,o,n,e[s+14],23,-35309556),n=this.md5_hh(n,r,i,o,e[s+1],4,-1530992060),o=this.md5_hh(o,n,r,i,e[s+4],11,1272893353),i=this.md5_hh(i,o,n,r,e[s+7],16,-155497632),r=this.md5_hh(r,i,o,n,e[s+10],23,-1094730640),n=this.md5_hh(n,r,i,o,e[s+13],4,681279174),o=this.md5_hh(o,n,r,i,e[s+0],11,-358537222),i=this.md5_hh(i,o,n,r,e[s+3],16,-722521979),r=this.md5_hh(r,i,o,n,e[s+6],23,76029189),n=this.md5_hh(n,r,i,o,e[s+9],4,-640364487),o=this.md5_hh(o,n,r,i,e[s+12],11,-421815835),i=this.md5_hh(i,o,n,r,e[s+15],16,530742520),r=this.md5_hh(r,i,o,n,e[s+2],23,-995338651),n=this.md5_ii(n,r,i,o,e[s+0],6,-198630844),o=this.md5_ii(o,n,r,i,e[s+7],10,1126891415),i=this.md5_ii(i,o,n,r,e[s+14],15,-1416354905),r=this.md5_ii(r,i,o,n,e[s+5],21,-57434055),n=this.md5_ii(n,r,i,o,e[s+12],6,1700485571),o=this.md5_ii(o,n,r,i,e[s+3],10,-1894986606),i=this.md5_ii(i,o,n,r,e[s+10],15,-1051523),r=this.md5_ii(r,i,o,n,e[s+1],21,-2054922799),n=this.md5_ii(n,r,i,o,e[s+8],6,1873313359),o=this.md5_ii(o,n,r,i,e[s+15],10,-30611744),i=this.md5_ii(i,o,n,r,e[s+6],15,-1560198380),r=this.md5_ii(r,i,o,n,e[s+13],21,1309151649),n=this.md5_ii(n,r,i,o,e[s+4],6,-145523070),o=this.md5_ii(o,n,r,i,e[s+11],10,-1120210379),i=this.md5_ii(i,o,n,r,e[s+2],15,718787259),r=this.md5_ii(r,i,o,n,e[s+9],21,-343485551),n=this.safe_add(n,a),r=this.safe_add(r,h),i=this.safe_add(i,l),o=this.safe_add(o,u)}return[n,r,i,o]},e.md5_cmn=function(e,t,n,r,i,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(r,o)),i),n)},e.md5_ff=function(e,t,n,r,i,o,s){return this.md5_cmn(t&n|~t&r,e,t,i,o,s)},e.md5_gg=function(e,t,n,r,i,o,s){return this.md5_cmn(t&r|n&~r,e,t,i,o,s)},e.md5_hh=function(e,t,n,r,i,o,s){return this.md5_cmn(t^n^r,e,t,i,o,s)},e.md5_ii=function(e,t,n,r,i,o,s){return this.md5_cmn(n^(t|~r),e,t,i,o,s)},e.safe_add=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n},e.bit_rol=function(e,t){return e<<t|e>>>32-t},e.hexcase=0,e.b64pad="",e}();__reflect(md5.prototype,"md5"),window.md5=md5;var RegExpUtil=function(){function e(){}return e.LINE_BREAK=/\r+/g,e.BLANK_REG=/[\s\\]/g,e.ARGB_COLOR=/[a-fA-F0-9]{8}/,e.HTML=/<[^>]+>/g,e.DELETE_SPACE=/\s/g,e.REPLACE_STRING=/%s/g,e.NumericExp=/^\d+$/,e.NonNumericExp=/\D/,e.ActorNameExp=/^([\u4e00-\u9fa5]?\w?[^>|!@#$%&*\^\?]){1,48}$/,e.CHAT_EMOJI=/#[0-9][0-9]#/g,e.CHAT_EMOJI_ID=/#/g,e}();__reflect(RegExpUtil.prototype,"RegExpUtil"),window.RegExpUtil=RegExpUtil;var ResourceUtils=function(e){function t(){var t=e.call(this)||this;return t._groupIndex=0,t._configs=new Array,t._groups={},t._urlResorce={},RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,t.onResourceLoadProgress,t),t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.addConfig=function(e,t){this._configs.push([e,t])},t.prototype.loadConfig=function(){return this.loadNextConfig()},t.prototype.loadNextConfig=function(){if(0==this._configs.length)return Promise.resolve();var e=this._configs.shift();return RES.loadConfig(e[0],e[1])},t.prototype.onConfigCompleteHandle=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},t.prototype.loadGroup=function(e,t,n,r){var i=this;this._groups[e]=[t,n,r],RES.loadGroup(e,0,this).then(function(t){i.onResourceLoadComplete(e)})["catch"](function(t){i.onResourceLoadError(e)})},t.prototype.loadGroups=function(e,t,n,r,i){RES.createGroup(e,t,!0),this.loadGroup(e,n,r,i)},t.prototype.pilfererLoadGroup=function(e,t){void 0===t&&(t=null);var n="pilferer_"+e;t||(t=[e]),RES.createGroup(n,t,!0),RES.loadGroup(n,-1)},t.prototype.onResourceLoadComplete=function(e){var t=e;if(this._groups[t]){var n=this._groups[t][0],r=this._groups[t][2];null!=n&&n.call(r),this._groups[t]=null,delete this._groups[t]}},t.prototype.onProgress=function(e,t,n){},t.prototype.onResourceLoadProgress=function(e){var t=e.groupName;if(this._groups[t]){var n=this._groups[t][1],r=this._groups[t][2];null!=n&&n.call(r,e.itemsLoaded,e.itemsTotal)}},t.prototype.onResourceLoadError=function(e){Log.trace(e+"资源组有资源加载失败"),this.onResourceLoadComplete(e)},t.prototype.loadResource=function(e,t,n,r,i){var o=this;void 0===e&&(e=[]),void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null);var s=e.concat(t),a="loadGroup"+this._groupIndex++;RES.createGroup(a,s,!0),this._groups[a]=[n,r,i],RES.loadGroup(a,0,this).then(function(e){o.onResourceLoadComplete(a)})["catch"](function(e){o.onResourceLoadError(a)})},t.prototype.loadUrlResource=function(e,t,n,r){var i=this;null==this._urlResorce[e]?(this._urlResorce[e]={data:null,compFun:n,thisObj:r},RES.getResByUrl(e,function(t){i._urlResorce[e].data=t,null!=n&&n.apply(i._urlResorce[e].thisObj)},this,t)):null!=n&&n.apply(r)},t.prototype.getUrlResource=function(e){return null==this._urlResorce[e]?(debug.log("资源未加载"),null):this._urlResorce[e].data},t}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils",["RES.PromiseTaskReporter"]),window.ResourceUtils=ResourceUtils;var StageUtils=function(e){function t(){var n=e.call(this)||this;return null==t._uiStage&&(t._uiStage=new eui.UILayer,t._uiStage.touchEnabled=!1,t._uiStage.percentHeight=100,t._uiStage.percentWidth=100,n.getStage().addChild(t._uiStage)),n}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.getHeight=function(){return this.getStage().stageHeight},t.prototype.getWidth=function(){return this.getStage().stageWidth},t.prototype.setTouchChildren=function(e){this.getStage().touchChildren=e},t.prototype.setMaxTouches=function(e){this.getStage().maxTouches=e},t.prototype.setFrameRate=function(e){this.getStage().frameRate=e},t.prototype.setScaleMode=function(e){this.getStage().scaleMode=e},t.prototype.resetMode=function(){var e=750,t=1334,n=750,r=1334,i=this.getWidth(),o=this.getHeight(),s=i/o/(n/r);s>1?e=i*t/o:t=e*o/i;var a=this.getStage();a.removeEventListener(egret.Event.RESIZE,this.resetMode,this),a.scaleMode=egret.StageScaleMode.FIXED_WIDTH,a.setContentSize(e,t),a.addEventListener(egret.Event.RESIZE,this.resetMode,this)},t.prototype.getScale=function(){var e=750,t=1334,n=this.getWidth(),r=this.getHeight();return r/t>n/e?n/e:r/t},t.prototype.adaptationIpx=function(e){var t=750,n=1334,r=this.getWidth(),i=this.getHeight(),o=r/t,s=i/n,a=o>s?o:s;DisplayUtils.setScale(e,a)},t.prototype.adaptationIpx2=function(e){var t=750,n=1547,r=this.getWidth(),i=this.getHeight(),o=r/t,s=i/n,a=o>s?o:s;DisplayUtils.setScale(e,a)},t.prototype.initBgm=function(){var e=this.getStage();e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setBgm,this)},t.prototype.setBgm=function(){var e=this.getStage();SoundManager.ins().playBg(),e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.setBgm,this)},t.prototype.getStage=function(){return egret.MainContext.instance.stage},t.prototype.getUIStage=function(){return t._uiStage},t}(BaseClass);__reflect(StageUtils.prototype,"StageUtils"),window.StageUtils=StageUtils;var StringUtils=function(){function e(){}return e.addChangeLine=function(e){for(var t="",n=0;n<e.length;n++)t+=e[n],n!=e.length-1&&(t+="\n");return t},e.deleteChangeLine=function(e){var t=e.replace("\r\n","");return t=t.replace("\r","")},e.trimSpace=function(e){return e.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},e.getStringLength=function(e){for(var t=e.split(""),n=0,r=0;r<t.length;r++){var i=t[r];n+=this.isChinese(i)?2:1}return n},e.replaceStrColor=function(e,t){for(var n=e.indexOf("0x"),r=n,i="",o="";-1!=r;)i=e.substring(n,n+8),e=e.replace(i,t),n+=8,o=e.substring(n),r=o.indexOf("0x"),n+=r;return e},e.isChinese=function(e){var t=/^[\u4E00-\u9FA5]+$/;return t.test(e)?!1:!0},e.strByteLen=function(e){for(var t=0,n=e.length,r=0;n>r;r++)t+=e.charCodeAt(r)>=127?2:1;return t},e.complementByChar=function(t,n,r,i){void 0===r&&(r=" "),void 0===i&&(i=!0);var o=this.strByteLen(i?t.replace(e.HTML,""):t);return t+this.repeatStr(r,n-o)},e.repeatStr=function(e,t){for(var n="",r=0;t>r;r++)n+=e;return n},e.addColor=function(e,t){var n;return"string"==typeof t?n=String(t):"number"==typeof t&&(n=Number(t).toString(10)),'<font color="'+n+'">'+e+"</font>"},e.addColor1=function(e,t){var n=new Object;return n.style=new Object,n.text=e,n.textColor=Number(t).toString(16),n},e.substitute=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=RegExpUtil.REPLACE_STRING,i=e.match(r);if(i&&i.length)for(var o=i.length,s=0;o>s;s++)e=e.replace(i[s],t[s]);return e},e.replaceStr=function(e,t,n){if(-1==e.indexOf(t))return e;var r=e.split(t);return r[0]+n+r[1]},e.replace=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)e=e.replace("%s",t[r]+"");return e},e.getStrByNumbers=function(e){var t=[];e.replace(/\d+/g,function(){return t.push(arguments[0]),arguments[0].toString()});return t},e.getStrByRegExp=function(e,t){void 0===t&&(t=/\d+/g);var n=[];e.replace(t,function(){return n.push(arguments[0]),"number"==typeof arguments[0]?arguments[0].toString():arguments[0]});return n},e.NumberToChinese=function(t){var n=0,r="",i="",o=!1,s=e.chnNumChar,a=e.chnUnitSection,h=t;if(0===t)return s[0];for(;t>0;){var l=t%1e4;o&&(i=s[0]+i),r=e.SectionToChinese(l),r+=0!==l?a[n]:a[0],i=r+i,o=1e3>l&&l>0,t=Math.floor(t/1e4),n++}return h/100>>0==0&&h/10>>0!=0&&"一"==i[0]&&(i=i.substr(1)),i},e.SectionToChinese=function(t){for(var n="",r="",i=0,o=!0,s=e.chnNumChar,a=e.chnUnitChar;t>0;){var h=t%10;0===h?o||(o=!0,r=s[h]+r):(o=!1,n=s[h],n+=a[i],r=n+r),i++,t=Math.floor(t/10)}return r},e.NumberToMaxString=function(e){return e>=999?"999+":e.toString()},e.HTML=/<[^>]+>/g,e.chnNumChar=["零","一","二","三","四","五","六","七","八","九"],e.chnUnitSection=["","万","亿","万亿","亿亿"],e.chnUnitChar=["","十","百","千"],e}();__reflect(StringUtils.prototype,"StringUtils"),window.StringUtils=StringUtils;var uint64=function(){function e(e){this._lowUint=0,this._highUint=0,this.value=e}return e.prototype.isEqual=function(e){return e?this._lowUint==e._lowUint&&this._highUint==e._highUint:!1},e.prototype.isGreaterThan=function(t){if(t instanceof e)return this._highUint>t._highUint||this._highUint==t._highUint&&this._lowUint>t._lowUint;var n=new e;return"string"==typeof t?(n.value=t,this.isGreaterThanOrEqual(n)):"number"==typeof t?(n.value=t.toString(),this.isGreaterThanOrEqual(n)):void 0},e.prototype.isGreaterThanOrEqual=function(t){if(t instanceof e)return this._highUint>t._highUint||this._highUint==t._highUint&&this._lowUint>=t._lowUint;var n=new e;return"string"==typeof t?(n.value=t,this.isGreaterThanOrEqual(n)):"number"==typeof t?(n.value=t.toString(),this.isGreaterThanOrEqual(n)):void 0},Object.defineProperty(e.prototype,"isZero",{get:function(){return 0==this._lowUint&&0==this._highUint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGreaterThanZero",{get:function(){return this._lowUint>0||this._highUint>0},enumerable:!0,configurable:!0}),e.prototype.writeByte=function(e){e.writeUnsignedInt(this._lowUint),e.writeUnsignedInt(this._highUint)},e.prototype.setValue=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._lowUint=e,this._highUint=t},Object.defineProperty(e.prototype,"value",{set:function(t){t instanceof egret.ByteArray?(this._lowUint=t.readUnsignedInt(),this._highUint=t.readUnsignedInt()):"string"==typeof t&&e.stringToUint64(t,10,this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueByString",{set:function(e){},enumerable:!0,configurable:!0}),e.prototype.leftMove=function(t,n){void 0===n&&(n=null),n=n||this;var r=e.LeftMoveMask[t],i=r&this._lowUint;i>>>=32-t,n._lowUint=this._lowUint<<t,n._highUint=this._highUint<<t,n._highUint=n._highUint|i},e.prototype.add=function(t,n){void 0===n&&(n=null),n=n||this;var r=this._lowUint+t._lowUint;n._highUint=this._highUint+t._highUint,r>=e.MaxLowUint?(n._highUint++,n._lowUint=r-e.MaxLowUint):n._lowUint=r},e.prototype.subtraction=function(t,n){void 0===n&&(n=null),n=n||this;var r=this._lowUint-t._lowUint;n._highUint=this._highUint-t._highUint,0>r?(n._highUint--,n._lowUint=r+e.MaxLowUint):n._lowUint=r},e.prototype.scale=function(t,n){void 0===n&&(n=null),n=n||this;var r=this._lowUint*t;n._highUint=this._highUint*t,n._highUint+=Math.floor(Math.abs(r/e.MaxLowUint)),n._lowUint=r%e.MaxLowUint},e.prototype.toString=function(t){void 0===t&&(t=10);for(var n,r,i,o="",s=this._lowUint,a=this._highUint;0!=a||0!=s;)n=a%t,i=n*e.MaxLowUint+s,r=i%t,o=r+o,a=(a-n)/t,s=(i-r)/t;return o.length?o:"0"},e.stringToUint64=function(t,n,r){void 0===n&&(n=10),void 0===r&&(r=null),r=r||new e;for(var i,o,s=0,a=0,h=t.length,l=0;h>l;l++)o=parseInt(t.charAt(l)),i=s*n+o,a=a*n+Math.floor(i/e.MaxLowUint),s=i%e.MaxLowUint;return r.setValue(s,a),r},e.LeftMoveMask=[0,2147483648,1073741824,536870912,268435456,134217728,67108864,33554432,16777216,8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],e.MaxLowUint=4294967296,e}();__reflect(uint64.prototype,"uint64"),window.uint64=uint64;var BaseComponent=function(e){function t(){var t=e.call(this)||this;return t.className="@策划@使用此组件必须填写逻辑类名",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged&&this.dataChanged()},enumerable:!0,configurable:!0}),t.filterKeys=["data"],t.copyKeys=["open","close"],t}(BaseView);__reflect(BaseComponent.prototype,"BaseComponent"),window.BaseComponent=BaseComponent;var Keyboard=function(){function e(){}return e.LEFT=37,e.UP=38,e.RIGHT=39,e.DOWN=40,e.KC_1=49,e.KC_2=50,e.KC_3=51,e.KC_4=52,e.KC_5=53,e.KC_6=54,e.KC_7=55,e.KC_8=56,e.KC_9=57,e.KC_0=48,e.A=65,e.B=66,e.C=67,e.D=68,e.E=69,e.F=70,e.G=71,e.H=72,e.I=73,e.J=74,e.K=75,e.L=76,e.M=77,e.N=78,e.O=79,e.P=80,e.Q=81,e.R=82,e.S=83,e.T=84,e.U=85,e.V=86,e.W=87,e.X=88,e.Y=89,e.Z=90,e.SPACE=32,e.BRACE_L=219,e.BACKSLASH=220,e.BRACE_R=221,e.BACK_QUOTE=192,e.ENTER=13,e.KC_BACKSPACE=8,e.KC_TAB=9,e.KC_ENTER=13,e.KC_SHIFT=16,e.KC_CONTROL=17,e.KC_ESCAPE=27,e.KC_SPACE=32,e.KC_WINDOWS=91,e.KC_MENU=93,e}();__reflect(Keyboard.prototype,"Keyboard"),window.Keyboard=Keyboard;var BaseItemRender=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.observe=function(e,t){MessageCenter.addListener(e,t,this)},t}(eui.ItemRenderer);__reflect(BaseItemRender.prototype,"BaseItemRender"),window.BaseItemRender=BaseItemRender;var BaseSpriteView=function(e){function t(t){var n=e.call(this)||this;return n._resources=null,n._myParent=t,n._isInit=!1,StageUtils.ins().getStage().addEventListener(egret.Event.RESIZE,n.onResize,n),n}return __extends(t,e),t.prototype.setResources=function(e){this._resources=e},Object.defineProperty(t.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),t.prototype.isInit=function(){return this._isInit},t.prototype.isShow=function(){return null!=this.stage&&this.visible},t.prototype.addToParent=function(){this._myParent.addChild(this)},t.prototype.removeFromParent=function(){DisplayUtils.removeFromParent(this)},t.prototype.initUI=function(){this._isInit=!0},t.prototype.initData=function(){},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.destroy=function(){this._myParent=null,this._resources=null},t.prototype.onResize=function(){},t.prototype.loadResource=function(e,t){this._resources&&this._resources.length>0?ResourceUtils.ins().loadResource(this._resources,[],function(){e(),t()},null,this):(e(),t())},t.prototype.setVisible=function(e){this.visible=e},t.openCheck=function(){return!0},t}(egret.DisplayObjectContainer);__reflect(BaseSpriteView.prototype,"BaseSpriteView",["IBaseView"]),window.BaseSpriteView=BaseSpriteView;var MovieClip=function(e){function t(){var n=e.call(this)||this;return n.rate=1,n.pixelHitTest=!1,n.isLoadingTexture=!1,n._mcFactory=new egret.MovieClipDataFactory,n.$hitTest=function(e,n){var r=this;if(!egret.nativeRender&&!r.$renderNode||!r.$visible||0==r.$scaleX||0==r.$scaleY)return null;var i=r.$getInvertedConcatenatedMatrix();if(0==i.a&&0==i.b&&0==i.c&&0==i.d)return null;var o=r.$getContentBounds(),s=i.a*e+i.c*n+i.tx,a=i.b*e+i.d*n+i.ty;if(o.contains(s,a)){if(!r.$children){var h=r.$scrollRect?r.$scrollRect:r.$maskRect;if(h&&!h.contains(s,a))return null;if(r.$mask&&!r.$mask.$hitTest(e,n))return null;if(this.pixelHitTest&&this instanceof t&&!this.hitTestPoint(e,n,!0))return null}return r}return null},n}return __extends(t,e),Object.defineProperty(t.prototype,"isResDestoryed",{get:function(){return Boolean(this.texture&&null==this.texture.bitmapData)},enumerable:!0,configurable:!0}),t.prototype.playFile=function(e,n,r,i){var o=this;if(void 0===n&&(n=1),void 0===r&&(r=null),void 0===i&&(i=!0),this.isLoadingTexture=!0,this.time=egret.getTimer(),this._compFun=r,this.playCount=n,this.remove=i,TimerManager.ins().remove(this.playComp,this),this.isResDestoryed);else if(this.name==e)return void this.createBody();this.name=e,this.texture&&t.removeDisplayObject(this,this.texture.bitmapData),this.jsonData=null,this.texture=null;var s=this.name.split("/");this.jsonData=RES.getRes(s[3]+"_json"),this.texture=RES.getRes(s[3]+"_png"),this.jsonData&&this.texture?(this.stage&&t.addDisplayObject(this,this.texture.bitmapData),this.createBody()):(RES.getResByUrl(this.name+".json",function(e,t){o.name+".json"==t&&e&&(o.jsonData=e,o.createBody())},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(this.name+".png",function(e,n){o.name+".png"==n&&e&&(o.texture=e,o.stage&&t.addDisplayObject(o,o.texture.bitmapData),o.createBody())},this,RES.ResourceItem.TYPE_IMAGE))},t.prototype.$onAddToStage=function(n,r){e.prototype.$onAddToStage.call(this,n,r),this.name&&this.isResDestoryed&&this.playFile(this.name,this.playCount,this._compFun,this.remove),this.texture&&t.addDisplayObject(this,this.texture.bitmapData)},t.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.texture&&t.removeDisplayObject(this,this.texture.bitmapData),this.dispose()},t.prototype.createBody=function(){if(this.jsonData&&this.texture){this.isLoadingTexture=!1,this._mcFactory.clearCache(),this._mcFactory.mcDataSet=this.jsonData,this._mcFactory.texture=this.texture;var e=this.name.split("/"),n=e.pop();if(this.movieClipData=this._mcFactory.generateMovieClipData(n),this.name in t.originalRate||(t.originalRate[this.name]=this.movieClipData.frameRate),this.frameRate=t.originalRate[this.name]*this.rate>>0,this.gotoAndPlay(1,this.playCount),this.visible=!0,this.playCount>0){var r=egret.getTimer()-this.time;r=this.playTime*this.playCount-r,r>0?TimerManager.ins().doTimer(r,1,this.playComp,this):this.playComp()}this.loadTextureComplete&&(this.loadTextureComplete(),this.loadTextureComplete=null),this.dispatchEventWith(egret.Event.CHANGE)}},t.prototype.playComp=function(){this.stage&&this._compFun&&this._compFun(),this.remove&&DisplayUtils.removeFromParent(this)},Object.defineProperty(t.prototype,"playTime",{get:function(){return this.movieClipData?1/this.frameRate*this.totalFrames*1e3:0},enumerable:!0,configurable:!0}),t.prototype.clearComFun=function(){this._compFun=null},t.prototype.dispose=function(){this.stop(),this.resetMovieClip(),this.clearComFun(),TimerManager.ins().removeAll(this)},t.prototype.destroy=function(){this.dispose(),ObjectPool.push(this)},t.prototype.resetMovieClip=function(){var e=this;e.rotation=0,e.scaleX=1,e.scaleY=1,e.alpha=1,e.anchorOffsetX=0,e.anchorOffsetY=0,e.x=0,e.y=0,e.rate=1,e.$renderNode&&e.$renderNode.cleanBeforeRender(),e._mcFactory.clearCache(),e._mcFactory.mcDataSet=null,e._mcFactory.texture=null,e.name=null,e.jsonData=null,e.filters=null;var n=e.texture;n&&t.removeDisplayObject(e,n.bitmapData),e.texture=null,e.remove=!1,egret.Tween.removeTweens(e)},t.prototype.setGrey=function(e){this.isLoadingTexture&&(this.loadTextureComplete=function(){})},t.addDisplayObject=function(e,n){if(n){var r=n.hashCode;if(!t.displayList[r])return void(t.displayList[r]=[e]);var i=t.displayList[r];i.indexOf(e)<0&&i.push(e)}},t.removeDisplayObject=function(e,n){if(n){var r=n.hashCode;if(t.displayList[r]){var i=t.displayList[r],o=i.indexOf(e);o>=0&&i.splice(o,1),0==i.length&&delete t.displayList[r]}}},t.originalRate={},t.displayList=egret.createMap(),t}(egret.MovieClip);__reflect(MovieClip.prototype,"MovieClip"),window.MovieClip=MovieClip;var AndroidAd=function(){function e(){}return e.videoResult=function(e){return void 0===e&&(e=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e?[4,TimerManager.ins().deleyPromisse(3e3)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.awardType===AwardType.LOGIN_AWARD?AdService.loginAward(!0):this.awardType===AwardType.WATCH_AD_AWARD?AdService.watchAdAward():this.awardType==AwardType.TIP_VIDEO&&this.videoCallback&&(this.videoCallback(),this.videoCallback=null),[2]}})})},e.Splash=function(){var e=App.ins().getAd(0),t=JSON.stringify({type:e});Openadsdk.SplashAd(function(){},this,t)},e.Reward=function(t,n){if(this.awardType=t,t==AwardType.TIP_VIDEO&&(this.videoCallback=n),!App.ins().isOpenAd())return void e.videoResult(!1);var r={is_horizontal:!1,userID:"user0",rewardAmount:1,rewardName:"体力",type:App.ins().getAd(2)};Openadsdk.RewardVideoAd(function(t){console.log("激励广告事件:"+t);var n=JSON.parse(t);if("onRewardVerify"===n.event){n.verify,n.amount,n.name;console.log(n)}else"onAdShow"===n.event?console.log("广告显示"):"onAdVideoBarClick"===n.event?console.log("点击banner"):"onAdClose"===n.event?(console.log("关闭广告"),e.videoResult()):"onVideoComplete"===n.event?console.log("视频播放完毕"):"onVideoError"===n.event?console.log("视频播放错误"):"onSkippedVideo"===n.event&&console.log("跳过")},this,JSON.stringify(r))},e.FullScreen=function(){var e={is_horizontal:!1};Openadsdk.FullScreenVideoAd(function(e){console.log("全屏广告事件:"+e)},this,JSON.stringify(e))},e.Banner=function(){if(App.ins().isOpenAd()){var e={is_top:!1,width:600,height:150,type:App.ins().getAd(1)};Openadsdk.BannerExpressAd(function(e){console.log("banner广告事件:"+e)},this,JSON.stringify(e))}},e.CloseBannerAd=function(){Openadsdk.CloseBannerAd()},e.Interaction=function(){var e={width:900,height:900};Openadsdk.InteractionAd(function(e){console.log("插屏广告事件:"+e)},this,JSON.stringify(e))},e}();__reflect(AndroidAd.prototype,"AndroidAd"),window.AndroidAd=AndroidAd;var sdk={RewardVideoAd:"TTRewardVideoAd",SplashAd:"TTSplashAd",FullScreenVideoAd:"TTFullScreenVideoAd",BannerExpressAd:"TTBannerExpressAd",InteractionAd:"TTInteractionAd"},Openadsdk=function(){function e(){}return e.RewardVideoAd=function(t,n,r){e.addCallBack(sdk.RewardVideoAd,t,n,r)},e.SplashAd=function(t,n,r){e.addCallBack(sdk.SplashAd,t,n,r)},e.FullScreenVideoAd=function(t,n,r){e.addCallBack(sdk.FullScreenVideoAd,t,n,r)},e.BannerExpressAd=function(t,n,r){e.addCallBack(sdk.BannerExpressAd,t,n,r)},e.InteractionAd=function(t,n,r){e.addCallBack(sdk.InteractionAd,t,n,r)},e.GetDevice=function(e,t,n){egret.ExternalInterface.addCallback("setDeviceCode",function(n){e&&t&&e.apply(t,[n])}),egret.ExternalInterface.call("getDeviceCode",n)},e.CloseBannerAd=function(t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=""),e.addCallBack("closeAd",t,n,r)},e.OpenURL=function(t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=""),e.addCallBack("OpenURL",t,n,r)},e.addCallBack=function(e,t,n,r){egret.ExternalInterface.addCallback(e+"-js",function(e){t&&n&&t.apply(n,[e])}),egret.ExternalInterface.call(e,r)},e}();__reflect(Openadsdk.prototype,"Openadsdk"),window.Openadsdk=Openadsdk;var Api=function(){function e(){}return e.AD_CONFIG="/user/ad/getAdConfig",e.USER_LOGIN="/word/user/login",e.USER_GET_USER_DATA="/word/user/getUserData",e.USER_WATCH_AD="/word/user/watchAd",e.USER_WATCH_ADV2="/word/user/watchAdV2",e.USER_SHARE_VIDEO="/word/user/shareVideo",e.USER_SHARE_PROGRAM="/word/user/shareProgram",e.USER_LOGIN_AWARD="/word/user/loginAward",e.USER_REFRESH="/word/user/refresh",e.STAGE_PLAY="/word/stage/play",e.STAGE_FINSH="/word/stage/finish",e.STAGE_TIPS="/word/stage/tips",e.STAGE_WORD="/word/stage/queryWord",e.STAGE_NEXTUPGRADE="/word/stage/nextUpGrade",e.PERSION_UPPERSION="/word/person/upgradePerson",e.PERSION_GET="/word/person/getPerson",e.PERSION_PAGE="/word/person/pagePerson",e.HOUSE_UP="/word/house/upgradeHouse",e.HOUSE_GET="/word/house/getHouse",e.HOUSE_PAGE="/word/house/pageHouse",e.HERO="/word/sage/recruit",e.HERO_GET="/word/sage/getSage",e.HERO_PAGE="/word/sage/pageSage",e.HERO_LIST="/word/sage/listSage",e.HERO_GROUP_AWARD="/word/sage/drawSageReward",e.HERO_GROUP_HASAWARD="/word/sage/getHasDraw",e.HERO_UP_LEVEL="/word/sage/upgrade",e.HERO_DAILY="/word/sage/dailyRecruit",e.WORD_ADD="/word/wordBook/add",e.WORD_CHANGESTATE="/word/wordBook/changeState",e.WORD_LIST="/word/wordBook/list",e.WORD_DETAIL="/word/wordBook/detail",e.WORD_ERR="/word/wordBook/wrongWord",e.EXCHANGE_ENERGY="/word/user/exchangeEnergy",e
}();__reflect(Api.prototype,"Api"),window.Api=Api;var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function i(e){t.call(r,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(r))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var a=e.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(h,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(r,generateJSON.paths[e])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]),window.ThemeAdapter=ThemeAdapter;var Ad=function(){function e(){}return e.video="18uirlsxvgd19j4ky9",e.videoTip="4ihfo5gui520550an6",e.loadingBanner="2ec1gm57ng77j4lq6d",e.playBanner="11qn31acsnp3j1ihmk",e.dialogBanner="1413045c8be6261gtg",e}();__reflect(Ad.prototype,"Ad"),window.Ad=Ad;var AwardType=function(){function e(){}return e.LOGIN_AWARD=1,e.WATCH_AD_AWARD=2,e.SHARE_VIDEO_AWARD=3,e.TIP_VIDEO=4,e}();__reflect(AwardType.prototype,"AwardType"),window.AwardType=AwardType;var BrushConfig=function(){function e(e,t,n,r){this.data=e,this.width=t,this.scale=n,this.dist=r}return e}();__reflect(BrushConfig.prototype,"BrushConfig"),window.BrushConfig=BrushConfig;var Constant=function(){function e(){}return e.COLOR_LOCK_NAME="color-lock",e.COLOR_SELECTED_NAME="color-selected",e.IMAGE_BASE64_PREFIX="data:image/png;base64,",e.SYSTEM_INFO_WIDTH="system_info_width",e.SYSTEM_INFO_HEIGHT="system_info_height",e.LOGIN_TOKEN="login_token",e.LOGIN_USER_ID="login_user_id",e.LOGIN_AWARD="login_award",e.RECORD_SHARE_URL="record_share_url",e.WATCH_AD_COUNT="watch_ad_count",e.WATCH_AD_DAY="watch_ad_day",e.HEADER_X_WWW_FORM_URLENCODED={"content-type":"application/x-www-form-urlencoded",platform:Main.gamePlatform},e.STAGE_COMMON_KEY="stage-",e.STAGE_MYSTERY_KEY="mystery-stage-",e.MUSIC_OPEN="MUSIC_OPEN",e.HERO_HIDE="HERO_HIDE",e.USER_PROTO="USER_PROTO",e.DAILY_RECRUIT_DATA="DAILY_RECRUIT_DATA",e.AD_DATA="AD_DATA",e.AD_CFG="AD_CFG",e}();__reflect(Constant.prototype,"Constant"),window.Constant=Constant;var CustomEventBus=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.Event={UPDATE_USER_INFO:"用户信息更新",UPDATE_OPEN_BONUS_COUNT:"开启的免费体力获取奖励任务数更新",RECORD_START_EVENT:"开始录屏",RECORD_STOP_EVENT:"录屏结束",RECORD_SHARE_EVENT:"录屏分享"},t}(egret.EventDispatcher);__reflect(CustomEventBus.prototype,"CustomEventBus"),window.CustomEventBus=CustomEventBus;var GameSocket=function(){function e(){this._socketStatus=0,this._lastReceiveTime=0,this.pid=0,this.PACK_HANDLER=[],this._serverId=0,this._user="",this._pwd="",this.lastPos=-1,this.hasShowReLoginWin=!1,this.disconnectTime=0,egret.startTick(this.update,this),this.newSocket(),this.recvPack=new GameByteArray,this._packets=[]}return e.ins=function(){return e._ins||(e._ins=new e),e._ins},e.prototype.getSocket=function(){return this.socket_},e.prototype.newSocket=function(){this.socket_&&this.removeEvent(),this.socket_=new egret.WebSocket,this.socket_.type=egret.WebSocket.TYPE_BINARY,this.socket_.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket_.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket_.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket_.addEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this)},e.prototype.removeEvent=function(){this.socket_.removeEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket_.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket_.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket_.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this)},e.prototype.isConnected=function(){return this._socketStatus==e.STATUS_COMMUNICATION},e.prototype.sendToServer=function(e){this.send(e),e.position=12,this.recycleByte(e)},e.prototype.connectError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window.connectError(),TimerManager.ins().remove(this.reLogin,this),TimerManager.ins().doTimer(1e3,1,this.reLogin,this)},e.prototype.connect=function(t,n){this.updateStatus(e.STATUS_CONNECTING),this._host=t,this._port=n},e.prototype.close=function(){this.socket_&&this.socket_.close()},e.prototype.send=function(t){return this._socketStatus==e.STATUS_COMMUNICATION?(this.sendPack(t),!0):(console.log("发送数据时没和服务连接或者未进入通信状态"),!1)},e.prototype.onSocketConnected=function(t){console.log("Socket connected！ip:"+this._host+" port:"+this._port),TimerManager.ins().remove(this.reLogin,this),this.updateStatus(e.STATUS_CHECKING);var n=new GameByteArray;n.writeUnsignedInt(Encrypt.getSelfSalt()),this.socket_.writeBytes(n),this.socket_.flush(),this._onConnected&&this._onConnected()},e.prototype.onSocketRead=function(t){if(-1!=this.lastPos){for(var n=0;n<=this.lastPos;n++)this.recycleByte(this._packets[n]);this._packets.splice(0,this.lastPos+1),this.lastPos=-1}if(this._socketStatus<e.STATUS_COMMUNICATION)return void this.sendKeyToServer();var r=new GameByteArray;this._lastReceiveTime=egret.getTimer(),this.socket_.readBytes(r,r.length);var i=r.readUnsignedShort();if(i==e.DEFAULT_TAG){r.readUnsignedShort();r.position+=4,this._packets.push(r)}},e.prototype.update=function(e){for(var t=0,n=this._packets;t<n.length;t++){var r=n[t];this.lastPos++,this.processRecvPacket(r),this.recycleByte(r)}return this._packets.length=0,this.lastPos=-1,!1},e.prototype.sendKeyToServer=function(){var t=new GameByteArray;this.socket_.readBytes(t),t.position=0;var n=t.readUnsignedInt();Encrypt.setTargetSalt(n),t.position=0,t.writeShort(Encrypt.getCheckKey()),this.socket_.writeBytes(t,0,2),this.updateStatus(e.STATUS_COMMUNICATION)},e.prototype.onSocketClose=function(t){console.log("与服务器的连接断开了！ip:"+this._host+" port:"+this._port),this.updateStatus(e.STATUS_DISCONNECT),TimerManager.ins().remove(this.reLogin,this),this.showReLoginWin()},e.prototype.showReLoginWin=function(){this.hasShowReLoginWin=!0,this.disconnectTime=egret.getTimer()},e.prototype.reLogin=function(){this.close(),this.newSocket()},e.prototype.updateStatus=function(e){if(this._socketStatus!=e){var t=this._socketStatus;this._socketStatus=e,this.onFinishCheck(e,t)}},e.prototype.onFinishCheck=function(t,n){t==e.STATUS_COMMUNICATION?(console.log("与服务器建立通信成功！ip:"+this._host+" port:"+this._port),this.sendCheckAccount(this._user,this._pwd)):t==e.STATUS_DISCONNECT},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),e.prototype.sendCheckAccount=function(e,t){var n=this.getBytes();n.writeCmd(255,1),n.writeInt(this._serverId),n.writeString(e),n.writeString(t),this.sendToServer(n)},e.prototype.login=function(e,t,n,r,i){this._user=e,this._pwd=t,this._serverId=n,r.split(":")[1]&&r.split(":")[1].length&&(i=parseInt(r.split(":")[1])),this.socket_.connected?this.sendCheckAccount(e,t):(console.log("connect to "+r+" ,port: "+i),this.connect(r,i))},e.prototype.processRecvPacket=function(e){var t=e.readUnsignedByte(),n=e.readUnsignedByte();this.dispatch(t,n,e)},e.prototype.dispatch=function(e,t,n){if(this.PACK_HANDLER[e]&&this.PACK_HANDLER[e][t]){var r=this.PACK_HANDLER[e][t];r[0].call(r[1],n)}},e.prototype.recycleByte=function(e){ObjectPool.push(e)},e.prototype.getBytes=function(){var t=ObjectPool.pop(e.CLASSNAME);return t.clear(),t.writeShort(e.DEFAULT_TAG),t.writeShort(0),t.writeShort(0),t.writeShort(e.DEFAULT_CRC_KEY),t.writeUnsignedInt(this.pid++),t},e.prototype.registerSTCFunc=function(e,t,n,r){if(this.PACK_HANDLER[e]){if(this.PACK_HANDLER[e][t])return void console.error("重复注册协议接口"+e+"-"+t)}else this.PACK_HANDLER[e]=[];this.PACK_HANDLER[e][t]=[n,r]},e.prototype.setOnClose=function(e,t){this._onClosed=e.bind(t)},e.prototype.setOnConnected=function(e,t){this._onConnected=e.bind(t)},e.prototype.sendPack=function(t){if(null==t||0==t.length)throw new egret.error("创建客户端数据包时数据不能为空！");var n=e.HEAD_SIZE;t.position=2,t.writeShort(t.length-n);var r=Encrypt.getCRC16ByPos(t,n);t.position=4,t.writeShort(r);var i=Encrypt.getCRC16(t,n);t.position=6,t.writeShort(i),Encrypt.encode(t,4,4),this.socket_.writeBytes(t)},e.DEFAULT_TAG=52462,e.DEFAULT_CRC_KEY=30301,e.HEAD_SIZE=8,e.STATUS_CONNECTING=1,e.STATUS_CHECKING=2,e.STATUS_COMMUNICATION=3,e.STATUS_DISCONNECT=4,e.CLASSNAME=egret.getQualifiedClassName(GameByteArray),e}();__reflect(GameSocket.prototype,"GameSocket"),window.GameSocket=GameSocket;var PartConfCollection=function(){function e(){}return e}();__reflect(PartConfCollection.prototype,"PartConfCollection"),window.PartConfCollection=PartConfCollection;var Point=function(){function e(e,t,n){this.x=e,this.y=t,this.id=n}return e}();__reflect(Point.prototype,"Point"),window.Point=Point;var Scale=function(){function e(){}return e}();__reflect(Scale.prototype,"Scale"),window.Scale=Scale;var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.isLoaded=!1,t.urls=[],t.remoteNum=0,t.preNum=0,t.skinName="LoadingUISkin",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.observe(UserModel.ins().postUserProto,this.startGame,this),StageUtils.ins().adaptationIpx(this.bg)},t.start=function(){var e=ViewManager.ins().getView(t);e&&(e.upView(),App.ins().playBannerAd(Ad.loadingBanner))},t.setLoadingState=function(e){var n=ViewManager.ins().getView(t);n&&n.setLoadingState(e)},t.prototype.upView=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,i,o,s;return __generator(this,function(a){switch(a.label){case 0:return e=new MyLoading(this),[4,this.loadCfg()];case 1:return a.sent(),t=[],[4,this.getRole()];case 2:return n=a.sent(),r=n.data,r.extraParts&&t.push(r.extraParts.img),t.push(n.bodyImg),t.push(n.headImg),[4,this.getHouse()];case 3:i=a.sent(),t.push(i.houseImg),t.push(i.bgImg),o=this.getHeroImg();for(s in o)t.push(o[s]);return this.urls=t,this.remoteNum=t.length,RES.loadGroup("main",0,e),[2]}})})},t.prototype.next=function(){this.setLoadingState(this.currentNum/(this.preNum+this.remoteNum)*.7+.3),this.currentNum++;var e=this.urls.pop();if(e)if(RES.hasRes(e)){var t=RES.getRes(e);t?this.next():RES.getResAsync(e,this.next,this)}else RES.getResByUrl(e,this.next,this,RES.ResourceItem.TYPE_IMAGE);else this.isLoaded=!0,App.ins().getShowUserProto()?this.startGame():Main.startGame()},t.prototype.startGame=function(){if(this.isLoaded){var e=ViewManager.ins().isShow(UserProtoWin);e||Main.startGame()}},t.prototype.getHeroImg=function(){var e=[],t=HeroModel.ins().getHeroShowData();if(!t)return e;for(var n=t.show0,r=0,i=n;r<i.length;r++){var o=i[r],s=o,a=HeroModel.ins().getIsUpLevel(s.id),h=a?s.data2:s.data;h.extraParts&&e.push(h.extraParts.img),e.push(a?s.bodyImg2:s.bodyImg),e.push(a?s.headImg2:s.headImg)}for(var l=t.show1,u=0,c=l;u<c.length;u++){var o=c[u],s=o,a=HeroModel.ins().getIsUpLevel(s.id),h=a?s.data2:s.data;h.extraParts&&e.push(h.extraParts.img),e.push(a?s.bodyImg2:s.bodyImg),e.push(a?s.headImg2:s.headImg)}return e},t.prototype.getRole=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){RoleModel.ins().getSingle(UserModel.ins().getRoleId(),function(t){e(t)})})]})})},t.prototype.getHouse=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){HouseModel.ins().getSingle(UserModel.ins().getHouseId(),function(t){var n=t.data;n=StringUtils.deleteChangeLine(n);var r=JSON.parse(n);e(r)})})]})})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner(),this.isLoaded=!1},t.prototype.onProgress=function(e,t,n){this.setLoadingState(e/(t+this.remoteNum)*.7+.3),e>=t&&(console.log("加载完"),this.preNum=t,this.currentNum=t,this.next())},t.prototype.loadCfg=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n;return __generator(this,function(r){switch(r.label){case 0:return[4,RES.getResByUrl(Main.res_url+"?"+Math.random(),null,null,RES.ResourceItem.TYPE_JSON)];case 1:return e=r.sent(),this.setLoadingState(.2),[4,RES.getResByUrl(e.heroUrl,null,null,RES.ResourceItem.TYPE_JSON)];case 2:return t=r.sent(),HeroModel.ins().setCfg(t),this.setLoadingState(.25),[4,RES.getResByUrl(e.personUrl,null,null,RES.ResourceItem.TYPE_JSON)];case 3:return n=r.sent(),RoleModel.ins().setCfg(n),this.setLoadingState(.3),[2]}})})},t.prototype.setLoadingState=function(e){this.loadingStatus.width=e*(this.loadingBar.width-6)},t.prototype.onComplete=function(){},t}(BaseEuiView);__reflect(LoadingUI.prototype,"LoadingUI"),ViewManager.ins().reg(LoadingUI,LayerManager.UI_LOADING),window.LoadingUI=LoadingUI;var LoginAwardWin=function(e){function t(){var t=e.call(this)||this;return t.defScale=1.2,t.btnScale=t.defScale,t.skinName="LoginAwardSkin",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEndEvent(this.award,this.onClick),this.addTouchEndEvent(this.doubleAward,this.onClick),this.addTouchEndEvent(this.closeBtn,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=Main.energyConfig;if(this.count.text=e.loginAward,this.doubleAward.visible=!App.ins().hideAdIcon(),App.ins().adNotScore()){this.doubleAward.icon="energy_dialog_watch_02_png",this.award.visible=!0,egret.Tween.removeTweens(this.doubleAward),this.doubleAward.scaleX=1,this.doubleAward.scaleY=1;var t=egret.Tween.get(this.doubleAward,{loop:!0});t.to({scaleX:1,scaleY:1},500).to({scaleX:.92,scaleY:.92},500).to({scaleX:1,scaleY:1},500)}else this.doubleAward.icon="energy_score_get_png",this.award.visible=!1},t.prototype.onClick=function(e){switch(e.currentTarget){case this.doubleAward:App.ins().adNotScore()?App.ins().playRewardVideoAd(AwardType.LOGIN_AWARD):AdService.loginAward(!1),ViewManager.ins().close(this);break;case this.award:AdService.loginAward(!1),ViewManager.ins().close(this);break;case this.closeBtn:ViewManager.ins().close(this)}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner(),egret.Tween.removeTweens(this.doubleAward)},t}(BaseEuiView);__reflect(LoginAwardWin.prototype,"LoginAwardWin"),ViewManager.ins().reg(LoginAwardWin,LayerManager.UI_Popup),window.LoginAwardWin=LoginAwardWin;var MyLoading=function(){function e(e,t){this.loadingUI=e,this.isLast=t}return e.prototype.onProgress=function(e,t){this.loadingUI.onProgress(e,t,this.isLast)},e}();__reflect(MyLoading.prototype,"MyLoading",["RES.PromiseTaskReporter"]),window.MyLoading=MyLoading;var UserProtoDetialWin=function(e){function t(){var t=e.call(this)||this;return t.content={"private":{title:"隐私政策",content:"本应用尊重并保护所有使用服务用户的个人隐私权。为了给您提供更准确、更有个性化的服务，本应用会按照本隐私权政策的规定使用和披露您的个人信息。但本应用将以高度的勤勉、审慎义务对待这些信息。除本隐私权政策另有规定外，在未征得您事先许可的情况下，本应用不会将这些信息对外披露或向第三方提供。本应用会不时更新本隐私权政策。 您在同意本应用服务使用协议之时，即视为您已经同意本隐私权政策全部内容。本隐私权政策属于本应用服务使用协议不可分割的一部分。\n\n1. 适用范围\n(a)在您注册本应用帐号时，您根据本应用要求提供的个人注册信息；\n\n(b)在您使用本应用网络服务，或访问本应用平台网页时，本应用自动接收并记录的您的浏览器和计算机上的信息，包括但不限于您的IP地址、浏览器的类型、使用的语言、访问日期和时间、软硬件特征信息及您需求的网页记录等数据；\n\n(c)本应用通过合法途径从商业伙伴处取得的用户个人数据。\n\n您了解并同意，以下信息不适用本隐私权政策：\n\n(a)您在使用本应用平台提供的搜索服务时输入的关键字信息；\n\n(b)本应用收集到的您在本应用发布的有关信息数据，包括但不限于参与活动、成交信息及评价详情；\n\n(c)违反法律规定或违反本应用规则行为及本应用已对您采取的措施\n\n2. 信息使用\n(a)本应用不会向任何无关第三方提供、出售、出租、分享或交易您的个人信息，除非事先得到您的许可，或该第三方和本应用（含本应用关联公司）单独或共同为您提供服务，且在该服务结束后，其将被禁止访问包括其以前能够访问的所有这些资料。\n\n(b)本应用亦不允许任何第三方以任何手段收集、编辑、出售或者无偿传播您的个人信息。任何本应用平台用户如从事上述活动，一经发现，本应用有权立即终止与该用户的服务协议。\n\n(c)为服务用户的目的，本应用可能通过使用您的个人信息，向您提供您感兴趣的信息，包括但不限于向您发出产品和服务信息，或者与本应用合作伙伴共享信息以便他们向您发送有关其产品和服务的信息（后者需要您的事先同意）。\n\n3. 信息披露\n在如下情况下，本应用将依据您的个人意愿或法律的规定全部或部分的披露您的个人信息：\n\n(a)经您事先同意，向第三方披露；\n\n(b)为提供您所要求的产品和服务，而必须和第三方分享您的个人信息；\n\n(c)根据法律的有关规定，或者行政或司法机构的要求，向第三方或者行政、司法机构披露；\n\n(d)如您出现违反中国有关法律、法规或者本应用服务协议或相关规则的情况，需要向第三方披露；\n\n(e)如您是适格的知识产权投诉人并已提起投诉，应被投诉人要求，向被投诉人披露，以便双方处理可能的权利纠纷；\n\n(f)在本应用平台上创建的某一交易中，如交易任何一方履行或部分履行了交易义务并提出信息披露请求的，本应用有权决定向该用户提供其交易对方的联络方式等必要信息，以促成交易的完成或纠纷的解决。\n\n(g)其它本应用根据法律、法规或者网站政策认为合适的披露。\n\n4. 信息存储和交换\n本应用收集的有关您的信息和资料将保存在本应用及（或）其关联公司的服务器上，这些信息和资料可能传送至您所在国家、地区或本应用收集信息和资料所在地的境外并在境外被访问、存储和展示。\n\n5. Cookie的使用\n(a)在您未拒绝接受cookies的情况下，本应用会在您的计算机上设定或取用cookies，以便您能登录或使用依赖于cookies的本应用平台服务或功能。本应用使用cookies可为您提供更加周到的个性化服务，包括推广服务。\n\n(b)您有权选择接受或拒绝接受cookies。您可以通过修改浏览器设置的方式拒绝接受cookies。但如果您选择拒绝接受cookies，则您可能无法登录或使用依赖于cookies的本应用网络服务或功能。\n\n(c)通过本应用所设cookies所取得的有关信息，将适用本政策。\n\n6. 信息安全\n(a)本应用帐号均有安全保护功能，请妥善保管您的用户名及密码信息。本应用将通过对用户密码进行加密等安全措施确保您的信息不丢失，不被滥用和变造。尽管有前述安全措施，但同时也请您注意在信息网络上不存在“完善的安全措施”。\n\n(b)在使用本应用网络服务进行网上交易时，您不可避免的要向交易对方或潜在的交易对\n\n7.本隐私政策的更改\n(a))如果决定更改隐私政策，我们会在本政策中、本人网站中以及我们认为适当的位置发布这些更改，以便您了解我们如何收集、使用您的个人信息，哪些人可以访问这些信息，以及在什么情况下我们会透露这些信息。\n\n(b)本人保留随时修改本政策的权利，因此请经常查看。如对本政策作出重大更改，本人会通过网站通知的形式告知。\n\n方披露自己的个人信息，如联络方式或者邮政地址。请您妥善保护自己的个人信息，仅在必要的情形下向他人提供。如您发现自己的个人信息泄密，尤其是本应用用户名及密码发生泄露，请您立即联络本应用客服，以便本应用采取相应措施。\n\n8.与我们联系\n当您有其他的投诉、建议、未成年人个人信息相关问题时，请与我们的官方微信号: ttpyapp联系。您也可以将您的问题发到以下邮箱：zmth@zmfamily.cn或寄到如下地址：\n\n广东省广州市番禺区大学城青蓝街28号创智大厦603 逐梦网络科技有限公司（收）\n\n邮编：511400\n\n我们将尽快审核所涉问题，并在验证您的用户身份后的十五天内予以回复。\n\n海南逐梦网络科技有限公司"},user:{title:"《海南逐梦网络用户服务协议》\n<font size=24>生效日期：2019 年 11 月 27 日 星期三</font>",content:"在您下载、安装或使用海南逐梦网络科技有限公司的产品及任何随附的文档（如有），包括提供给您的更新或升级版本（依据本协议之外的其他协议提供给您的更新或升级版本除外）之前，请您务必仔细阅读本协议中约定的下述条款。\n\n除非您与海南逐梦网络科技有限公司（以下简称“公司”）就我司应用的使用另外签署了其他协议，否则您对我司应用的使用受本《我司应用用户服务协议》（以下简称“本协议”）中各项条款的约束。\n\n请您仔细阅读以下条款，在您同意并接受本协议全部条款的前提下，公司将我司应用的合法使用授权授予您。如果您是未成年人，则请您在法定监护人陪同下审阅和判断是否同意本协议，未成年人使用我司应用的行为视为已获得了法定监护人的认可。如果您不同意接受本协议的全部条款，则您无权注册、登录或使用本协议所涉及服务，您下载、安装、使用我司应用等行为，则意味着您将自愿遵守本协议及我司应用的其他有关规则，并完全服从于我司应用的统一管理。\n\n我司应用有权根据业务需要对本协议不定时进行调整，并将调整后的协议公布于公司官网或者我司应用APP中，如果您不同意调整后的本协议的，您应当停止使用我司应用，否则，如果在公司调整本协议并公布后，您继续使用我司应用提供的服务的，则视为您同意遵守调整后的协议。\n\n一、用户的权利与义务\n1.用户须通过合法渠道（包括但不限于各大应用市场、我司应用官网）下载、安装并使用我司应用，这是您获得我司应用使用授权的前提。\n\n2.用户一经注册或登录使用我司应用，即视为用户同意公司的客服人员与其进行电话联系。\n\n3.用户在我司应用内享有的服务内容由公司根据实际提供，并有权不时进行增加、删除、修改、或调整，包括但不限于：\n\n（1）拍照（修改头像、发布状态）：用户通过拍照（语音、文字）修改自己的用户头像或者发布个人状态。\n\n（2）问答解题：用户通过照片、语音、文字内容向其他用户提问，其他用户自愿给出解答内容，我司应用不对解答内容承担任何责任。\n\n（3）直播课学习：用户可选择我司应用产品内相关课程学习，老师进行音视频即时教学，所产生费用由用户自行承担；用户购买课程后产生的课程回放，用户可在规定时间内随时观看复习，所产生的流量费用、上网费用由用户自行承担。\n\n（4）老师答疑辅导：用户可通过答疑入口约定老师进行AI纠音或者人工纠音。\n\n（5）在线练习：用户可通过我司应用进行同步题目练习。\n\n（6）单词查询：用户可通过单词形式在单词查询中进行单词检索。\n\n（7）录音：用户要通过录音为自己配音作品配音，前提是用户自主点击录音功能才会触发录音功能。\n\n4. 使用我司应用时产生的通讯流量费用由用户自行承担。\n\n5.用户应妥善保管自己的账号、密码，不得转让、出借、出租、出售或分享予他人使用。否则我司应用有权根据实际情况暂时封停或永久查封此账号，当用户的账号或密码遭到未经授权的使用时，用户应当立即通知我司应用，否则未经授权的使用行为均视为用户本人行为。\n\n6.公司有权随时对我司应用提供的服务内容等进行调整，包括但不限于增加、删除、修改我司应用服务内容，一旦我司应用的服务内容发生增加、删除、修改，我司应用将在相关页面上进行提示；如果用户不同意相关变更和修改，可以取消已经获取的服务并停止使用；如果用户继续使用我司应用提供的服务，则视为用户已经接受全部变更、修改。除非另有明确约定，否则用户使用我司应用内新增的服务内容将同样受本协议各项条款的约束。\n\n7.我司应用内提供的服务分为免费服务和收费服务。对于现阶段免费提供的服务内容，公司有权随时根据公司政策的调整将其变更为收费服务，如果发生该等变更的，公司将提前告知用户，如果用户不同意的，可以停止使用该服务。对于收费的服务内容，公司有权自行确定该等服务的价格并不时调整，调整后的价格将在我司应用平台中进行公示，如果用户不同意调整后的价格的，则用户可以在其原购买的收费服务到期后停止付费购买收费服务。如果用户在公司调整价格并公示后，仍继续购买收费服务的，则视为用户同意该调整后的价格。\n\n8.用户如对付费购买的服务不满意的，有权终止服务。用户需在规定时间内，在客户端自行申请或拨打客服电话（020-84503561），申请终止服务及退款，退款金额按照客户端公示的退款规则计算，公司有权根据业务发展不时调整退款规则并在端内公示；如果客户端公示的退款规则跟本协议约定不一致的，以客户端公示的为准。其中，购买直播课的用户，仅有权对未开始直播的课程提出退款申请，已经消费的直播课程无法申请退款；购买1对1辅导的用户，需在套餐有效期内对未使用的时长提出退款申请；购买其他付费服务的退款按照平台内公示的规则执行。如果用户在购买付费服务时使用了本协议第一条第8、9款约定的优惠券或折扣等其他优惠方式的，则用户按照本款约定申请退款时，用户无权就该等优惠券或折扣申请退款或补偿。公司有权保留已终止服务的用户的所有使用信息，对用户在使用付费服务期间发生的违反本协议及相关规定的行为，公司仍有权行使本协议规定的权利并追究用户的法律责任。\n\n9.公司不时将对付费服务提供优惠政策或开展优惠活动，该等优惠政策或优惠活动以我司应用平台上的实时信息为准，用户知悉并认可，公司作有权自行决定是否提供优惠政策或开展优惠互动，以及优惠政策或优惠活动的内容、条件和有效期，并不时进行调整或终止。\n\n10.如果用户通过合法方式获得了相关付费服务的优惠券或折扣等其他优惠方式的，则用户知悉并认可，该等优惠券或折扣必须满足一定条件才能使用，以优惠券上的信息提示和优惠券使用说明、或我司应用公示的折扣使用说明为准。优惠券或折扣不兑现（即不直接兑换现金）、不找零（即订单金额不足抵用券金额的，抵用券剩余金额无效）、过期作废；优惠券或折扣仅限同一用户账号使用，严禁出售、转让或共享，如经公司发现存在出售、转让或共享优惠券或折扣等其他优惠方式的，该优惠券或折扣将予以作废处理，且公司有权视情节严重程度予以封号处理，并保留追究相关责任人法律责任的权利。\n\n11.公司禁止以任何形式倒卖、贩售、出租、出借、转让用户账号、优惠券或折扣等其他优惠方式及使用第三方渠道（即非我司应用官方渠道）代充学币的行为，一经查明，公司将采取包括但不限于封号、封禁IP、追究相关责任人法律责任的处理措施。\n\n二、平台管理\n（1）在我司应用产品使用期间，公司有权删除不符合法律法规、部门规章、公序良俗的问答、评论、帖子等，以及公司认为跟我司应用产品和服务不相关或者认为不适当、不合理的用户内容，包括但不限于，含有色情、暴力、恐怖内容，具有广告性质，含有反动内容，含有人身攻击内容，含有违背伦理道德内容，具有恶意、无聊和灌水性质，涉及违法犯罪的内容，以及其他违反法律及我司应用平台管理制度的内容。\n\n1.作弊行为与处罚方法\n\n（1）作弊的行为包括但不限于通过非公平不正当途径获取积分、利用系统漏洞获取优惠或做异常使用、违规贩卖优惠券、使用第三方渠道（即非我司应用官方渠道）代充学币等。对于作弊行为的判断，公司保留最终解释权。特别注意：任何形式的自问自答，刷分，转分，送分等都属于作弊行为。\n\n（2）作弊的处罚指向所有通过非正当行为获得的积分、优惠、购买的课程等，作弊所得将被全部扣除。涉嫌作弊行为一经初步确认，涉及该涉嫌作弊行为的所有相关用户的登录账号将被酌情扣分、有限期封禁，情节严重者会被永久封禁，甚至进行刑事追诉。涉嫌作弊内容的发布者在我司应用平台上发布的内容（不论作弊与否）均将被严肃处理，情节严重者将被删除在我司应用平台上发布的全部提问内容。\n\n2.问答、评论、文档、知识删除原则与处罚方法\n\n（1）在天天配音产品使用期间，公司有权删除不符合法律法规、部门规章、公序良俗的问答、评论、帖子等，以及公司认为跟天天配音产品和服务不相关或者认为不适当、不合理的用户内容，包括但不限于，含有色情、暴力、恐怖内容，具有广告性质，含有反动内容，含有人身攻击内容，含有违背伦理道德内容，具有恶意、无聊和灌水性质，涉及违法犯罪的内容，以及其他违反法律及天天配音平台管理制度的内容。\n\n（2）相应处罚方法\n\n用户发布不良信息，账号会做封号处理。\n\n用户在应用内有严重干扰其他用户行为的，账号做封号处理\n\n帖子被删除后，发帖者的积分将被酌情扣除0到5分。\n\n由于问题/原帖被删除而导致的回复、评论删除不单独扣分。\n\n情节严重者，将酌情对其进行加倍扣分、有限期封禁和永久封禁等处罚。\n\n3.对账号的管理原则\n（1）您应保证您注册、登录并使用的账号符合中国相关法律法规的规定，符合《互联网用户账号名称管理规定》，符合本协议的各项规定。公司有权对您注册、登录并使用的账号名称、头像和简介等注册信息进行审核，您确保您登录本软件使用的用户账号名称、头像和简介等信息中不得出现违法和不良信息，不存在以虚假信息骗取账号名称注册的情形；您应确保您登录我司应用使用的用户账号名称不得为您冒用关联机构或社会名人注册的账号名称。\n\n（2）如果您以虚假信息骗取账号名称注册，或您的账号头像、简介等注册信息存在违法和不良信息的，公司有权采取通知限期改正、暂停使用、注销登记等措施；如果您冒用关联机构或社会名人注册账号名称的，公司有权注销您的账号，并向互联网信息内容主管部门报告。\n\n（3）凡用户存在作弊行为，发布广告，发布黄色、反动内容，发布不文明内容，抄袭，模仿管理人员ID，用以假冒管理人员或破坏管理人员形象，模仿或盗用他人ID 个人签名，发布的内容包含有严重影响网友浏览的内容或格式，或者存在其他扰乱我司应用秩序的，或影响我司应用一课正常经营行为的，公司有权删除其相应账号，情节严重者，将酌情封禁对应IP。\n\n（4）我司应用提供账号注销功能，可以在“我司应用”-“我的”-设置-注销我司应用账号中实现。注销账号之后此账号内的数据无法恢复，包括但不限于账户内的资产信息如学币、帮帮币、优惠券等；账号信息内容也将全部清除，包含但不限于该账号发布过的文章、评论等。注销行为操作后无法撤销，请用户谨慎申请。\n\n4.投诉、举报制度\n\n如果您认为我司应用中的提问、回答、帖子、发言或其他信息、资料、内容等存在违反法律法规及我司应用平台相关管理规定的，涉嫌侮辱或者诽谤他人，或者侵犯您或第三方的商标权、著作权或其他合法权利情形的，您可以通过我司应用APP内“我要吐槽”渠道进行举报、投诉，或者向我司应用官方邮箱zmth@zmfamily.cn发送权利通知书，公司将在收到您的投诉后将依据中国法律法规和政府规范性文件及我司应用平台管理规定采取措施进行处理，包括但不限于移除相关内容或屏蔽相关链接，以及其他公司认为适当的处理方式，情节严重者，公司有权向政府相关部门进行举报。\n\n三、广告及推广\n1.公司有权根据其现行有效的政策自行决定，使用我司应用为公司或任何第三方的产品或服务提供广告、推广或任何增值服务，且因该等广告、推广或增值服务而获取的任何收益（如有）均由公司单独享有。\n\n2.公司有权，无需事先向您通知，自行决定更改利用我司应用展示、发布广告或进行推广的形式、模式和范围；您应意识到我司应用上展示给您的内容，包括但不限于我司应用中的广告及推广服务中展示的内容，可能受知识产权的保护。您不得修改、租赁、出租、出借、出售、分发该内容（无论全部还是部分）或根据该内容创作衍生作品，除非公司或内容权利人在相关协议、相关业务规则中特别告知您可以为之。\n\n3.您于天天配音或经由天天配音与广告商进行通讯或商业往来，或参与促销活动，包含相关商品或服务之付款及交付，以及前述交易其他任何相关条款、条件、保证或声明，完全为您与前述广告商之间的行为，公司不承担对广告及广告商进行审查、甄别之义务； 以及公司不对您或广告商，基于天天配音发生的前述通讯、商业往来或交易可能遭受的任何性质的损失或损害承担任何责任。\n\n四、知识产权\n1.公司拥有我司应用的所有权，包括其中的知识产权。我司应用受中华人民共和国著作权法的保护，用户不得删除或以其他方式改变我司应用上附带的版权、商标或其他所有权声明或标识。用户不得对我司应用进行反向工程、反向编译或反汇编，不得试图进行任何获得我司应用源代码的访问或行为，不得发行、出租、信息网络传播、翻译我司应用软件。\n\n2.我司应用的用户不能侵犯包括他人的著作权在内的知识产权以及其他权利。一旦由于用户的提问、回答、发言发生法律纠纷，其责任在于用户本人，与我司应用及公司无关。\n\n3.对于用户发表到我司应用上的任何内容，用户同意我司应用在全世界范围内具有免费的、永久性的、不可撤销的、非独家的和完全再许可的权利和许可，以使用、复制、修改、改编、出版、翻译、据以创作衍生作品、传播、表演和展示此等内容（整体或部分），和/或将此等内容编入当前已知的或以后开发的其他任何形式的作品、媒体或技术中。并且，用户许可我司应用公司有权利就任何主体侵权而单独采取法律行动（包括但不限于诉讼、举报、律师函等形式）。\n\n4.我司应用用户的言论侵犯了第三方的著作权或其他权利，第三方提出异议的时候，我司应用有权删除相关的内容，提出异议者和用户之间以和解、调解、仲裁、诉讼等方式解决了争议后，以此为依据，我司应用在得到有关申请后可以恢复被删除的内容。\n\n5.用户从我司应用的服务中获得的信息在没有得到事先许可的情况下，自行或提供给第三方利用复制，发送，传播等手段用于盈利目的时，将追究相关当事人的法律责任。\n\n6.未经本公司事先许可，禁止使用任何机器人、爬虫程序、其他自动设备，或手动程序等来监视或复制我司应用网页或其所包含的任何内容。否则，我司应用有权依法追究法律责任。\n\n7.如果第三方要使用我司应用上的提问、回答或评论的，则需要事先获得相关用户同意后方能使用。\n\n五、不允诺担保、责任有限及免责\n1.不允诺担保：我司应用用户提问、回答、发言仅代表用户个人观点，与公司无关，且我司应用不对用户发表的回答或评论的正确性、准确性、真实性进行保证。我司应用为按现状提供，包含瑕疵及缺陷，公司不提供任何其他担保。公司不允诺其他无论是明示的还是默示的保证和担保，包括但不限于对特定目的的适销性和适应性，不侵权，以及任何出自交易过程或商业惯例的保证和条件。从公司或他处获取的任何建议或信息，不论是口头的还是书面的，都不会对公司产生本协议明确约定之外的其他保证和担保。\n\n2.责任有限：适用法律所允许的最大范围内，不论出于何种原因，公司对您的全部责任为您为使用我司应用的产品和服务而向公司支付的费用总额。如果公司免费向您提供了我司应用服务，则公司无义务对您承担任何赔偿责任。任何情况下，公司不对出自本协议或与本协议有关的或与我司应用的运行有关的任何特殊的、偶然的、惩罚性或间接的损害（包括但不限于数据损失、利润损失或营业损失）或采购替代产品承担责任，不论该等责任是基于合同，担保，侵权（包括过失），严格责任或其他，也不论公司是否被事先告知了损失或损害发生的可能性。即使本协议约定的有限补救措施未能实现其根本目的，前述的责任限制依然适用。\n\n3.免责：如因下所列任何原因而造成的用户资料泄露、丢失、被盗用或被篡改等，公司均有权获得免责：\n\n（1）任何因政府管制而造成的暂时性关闭等影响网络正常浏览的不可抗力原因；\n\n（2）任何计算机系统问题、黑客攻击、计算机病毒侵入或发作的原因；\n\n（3）任何因网络安全问题导致的账户或银行卡信息泄露，该风险可能会给用户造成经济损失，用户承诺自行承担向侵权方追究责任及追究责任不能的后果；\n\n（4）任何因用户个人原因导致的用户资料泄露、丢失、被盗用或被篡改等；\n\n（5）其他不能归责于公司的原因。\n\n六、用户隐私声明\n1.公司仅出于向用户提供更优质、更个性化服务的目的收集用户的信息，且，公司重视未成年人的个人信息保护，如您为未成年人，请务必由您的监护人仔细阅读本隐私条款，并在征得监护人同意的前提下使用我司应用或向我司应用提供相关用户信息。\n\n2.在用户使用我司应用的过程中，公司将遵循合法、正当、必要的原则，收集用户使用我司应用的相关信息，包括但不限于：\n\n（1）用户注册或登录的账户信息，例如用户注册账户使用的电话号码、姓名或昵称，用户自行填写的班级、学校等；\n\n（2）用户上传的信息，例如用户的发帖、评论、分享、用户主动填写的信息或用户与我司应用客服联系时提供的相关信息等；\n\n（3）用户使用我司应用过程中产生的信息。公司会根据用户授予的权限，接收并记录用户所使用的设备相关信息，例如设备属性信息、设备位置信息、设备连接信息等；\n\n（4）我司应用根据用户授权通过合法方式收集的其他用户信息。\n\n4. 公司非常重视用户的信息安全，并尽最大合理努力采取各种合理的物理、电子和管理方面的安全措施来保护用户信息，确保用户信息不会被泄漏、篡改、毁损或丢失，包括但不限于SSL、信息加密存储、数据中心的访问控制、信息访问权限控制等。且，公司不会非法出售、非法向他人提供用户信息；公司不会将用户的该等信息提供给任何第三方，也不会用于任何其他目的和用途，但是以下情形除外，1）经用户事先同意，向第三方披露； 2）根据法律的有关规定，或者行政或司法机构的要求，向第三方或者行政、司法机构披露；3）公司与第三方合作向用户提供我司应用平台的相关服务或其他网络服务，且该等第三方同意承担与公司同等的保护用户隐私的责任；4）其他根据法律、法规或者政策应进行的披露。\n\n七、其他\n1.如果我司应用平台上某一子服务附有单独的使用协议的，则该子服务的使用将受该单独使用协议的约束。\n\n2.本协议的签订、生效、履行、争议的解决均适用中华人民共和国法律。\n\n3.有关本协议的争议应通过友好协商解决，如果协商不成，该争议将提交公司所在地有管辖权的法院诉讼解决。\n\n4.用户对我司应用平台的意见及建议可通过客服邮箱zmth@zmfamily.cn与公司进行联系。"}},t.skinName="UserProtoDetialSkin",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onTap),this.type=e[0],this.upView()},t.prototype.onTap=function(){ViewManager.ins().close(this)},t.prototype.upView=function(){0==this.type?(this.title.textFlow=(new egret.HtmlTextParser).parser(this.content.user.title),this.lab.text=this.content.user.content,this.scrol.top=this.title.y+60+20):1==this.type&&(this.title.textFlow=(new egret.HtmlTextParser).parser(this.content["private"].title),this.lab.text=this.content["private"].content,this.scrol.top=this.title.y+30+20)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t}(BaseEuiView);__reflect(UserProtoDetialWin.prototype,"UserProtoDetialWin"),ViewManager.ins().reg(UserProtoDetialWin,LayerManager.UI_LOADING),window.UserProtoDetialWin=UserProtoDetialWin;var UserProtoWin=function(e){function t(){var t=e.call(this)||this;return t.xy0={x:2010,x2:2134},t.xy1={x:2180,x2:2304},t.skinName="UserProtoSkin",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.grp0,this.agree),this.addTouchEvent(this.grp1,this.reject),this.addTouchEvent(this.lab,this.onLab),this.upView()},t.prototype.onLab=function(e){console.log(e);var t=e.localX+395*Math.floor(e.localY/36);t>=this.xy0.x&&t<this.xy0.x2?(console.log("服务协议"),ViewManager.ins().open(UserProtoDetialWin,0)):t>=this.xy1.x&&t<this.xy1.x2&&(console.log("隐私政策"),ViewManager.ins().open(UserProtoDetialWin,1))},t.prototype.agree=function(){App.ins().setShowUserProto(!0),ViewManager.ins().close(this)},t.prototype.reject=function(){ViewManager.ins().close(this)},t.prototype.upView=function(){var e="请务必仔细阅读、礼节“服务协议”和“隐私政策”各项条款。包括但不限于IP地址、读取个人通讯录等个人信息您可以在“设置”中查看、变更、删除个人信息并管理您的授权信息。您可阅读<font color = '#25D1E0'>《服务协议》</font>和<font color = '#25D1E0'>《隐私政策》</font>了解详细信息。若您同意，请点击“同意”开始接受我们的服务。";this.lab.textFlow=(new egret.HtmlTextParser).parser(e)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];UserModel.ins().postUserProto()},t}(BaseEuiView);__reflect(UserProtoWin.prototype,"UserProtoWin"),ViewManager.ins().reg(UserProtoWin,LayerManager.UI_LOADING),window.UserProtoWin=UserProtoWin;var BaseBtn=function(e){function t(){var t=e.call(this)||this;return t.miniIcon="",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.onClick=function(){SoundManager.ins().playEffect("square_tap_mp3")},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t}(eui.Button);__reflect(BaseBtn.prototype,"BaseBtn"),window.BaseBtn=BaseBtn;var PackageID;!function(e){e[e.User=1]="User"}(PackageID||(PackageID={}));var EnergyAdWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="EnergyAdSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=Main.energyConfig;if(this.count.text=e.watchAdAward,App.ins().adNotScore())this.titleImg.source="energy_ad_title_png",this.lab.text="观看完30秒视频\n即可获得",this.btn.icon="energy_dialog_watch_01_png";else{this.titleImg.source="energy_score_title_png";var t=ScoreService.getScoreNeed();this.lab.text="使用"+t+"积分即可获得",this.btn.icon="energy_score_btn_png"}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this);break;case this.btn:console.log("watch ad btn click!"),App.ins().playRewardVideoAd(AwardType.WATCH_AD_AWARD)}},t}(BaseEuiView);__reflect(EnergyAdWin.prototype,"EnergyAdWin"),ViewManager.ins().reg(EnergyAdWin,LayerManager.UI_Popup),window.EnergyAdWin=EnergyAdWin;var EnergyFreeItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="EnergyFreeItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.dataChanged=function(){var e,t,n,r,i=this.data.type,o=Main.energyConfig,s=0,a=1;i==EnergyFreeType.share?(e="分享获取",s=o.shareProgramAward,t="energy_dialog_share_btn_png",n="energy_dialog_share_png",r="energy_bar_icon_png",a=.5):i==EnergyFreeType.watchAdAward?(e="观看广告",s=o.watchAdAward,t="energy_dialog_watch_png",n="energy_dialog_ad_png",r="energy_bar_icon_png",a=.5):i==EnergyFreeType.tip&&(e="观看广告",s=1,t="energy_dialog_watch_png",n="energy_dialog_ad_png",r="tip_icon_ad_png",a=1),this.lab1.text=e,this.lab2.textFlow=(new egret.HtmlTextParser).parser("获得：<font color = '#747474'>"+s+"</font>"),this.img.source=n,this.btn.icon=t,this.imgGet.source=r,DisplayUtils.setScale(this.imgGet,a)},t.prototype.onClick=function(e){switch(e.currentTarget){case this.btn:var t=this.data;if(ViewManager.ins().close(EnergyFreeWin),t.type==EnergyFreeType.share){var n=JSON.stringify({share:!0});wx.shareAppMessage({title:"我要分享",query:n,imageUrl:GlobalConfig.helpImgUrl,success:function(e){console.log("拉起分享 成功"),console.log(e),AdService.shareProgramAward()},fail:function(e){console.log("拉起分享 失败"),console.log(e)}})}else t.type==EnergyFreeType.watchAdAward?App.ins().playRewardVideoAd(AwardType.WATCH_AD_AWARD):t.type==EnergyFreeType.tip&&App.ins().watchAdCall(AwardType.TIP_VIDEO,function(){AdService.adAddTip(function(){PlayModel.ins().clearNext()})}.bind(this))}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),this.btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)
},t}(eui.ItemRenderer);__reflect(EnergyFreeItem.prototype,"EnergyFreeItem");var EnergyFreeType;!function(e){e[e.share=1]="share",e[e.watchAdAward=2]="watchAdAward",e[e.tip=3]="tip"}(EnergyFreeType||(EnergyFreeType={})),window.EnergyFreeItem=EnergyFreeItem;var EnergyFreeWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="EnergyFreeSkin",t.list.itemRenderer=EnergyFreeItem,t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=[{type:EnergyFreeType.watchAdAward},{type:EnergyFreeType.tip}];this.list.dataProvider=new eui.ArrayCollection(e)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(EnergyFreeWin.prototype,"EnergyFreeWin"),ViewManager.ins().reg(EnergyFreeWin,LayerManager.UI_Popup),window.EnergyFreeWin=EnergyFreeWin;var EnergyFriendItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="EnergyFriendItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){var e=this.data;this.lab.text=e.num+""},t.prototype.setInactive=function(){this.img.source="energy_icon_inactive_png",this.bg.source="energy_help_bg_inactive_png"},t.prototype.setActive=function(){this.img.source="energy_icon_png",this.bg.source="energy_help_bg_png"},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(EnergyFriendItem.prototype,"EnergyFriendItem"),window.EnergyFriendItem=EnergyFriendItem;var EnergyFriendWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="EnergyFriendSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=Main.energyConfig.shareVideoAward;this.item1.data={num:e},this.item2.data={num:e},this.item3.data={num:e}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this);break;case this.btn:var t=JSON.stringify({share:!0});wx.shareAppMessage({title:"我要分享",query:t,imageUrl:GlobalConfig.helpImgUrl,success:function(e){console.log("拉起分享 成功"),console.log(e),AdService.shareVideoAward()},fail:function(e){console.log("拉起分享 失败"),console.log(e)}})}},t}(BaseEuiView);__reflect(EnergyFriendWin.prototype,"EnergyFriendWin"),ViewManager.ins().reg(EnergyFriendWin,LayerManager.UI_Popup),window.EnergyFriendWin=EnergyFriendWin;var EnergyWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="EnergySkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btnR,this.onClick),this.addTouchEvent(this.btnL,this.onClick),this.observe(UserModel.ins().postData,this.upView),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=UserModel.ins(),t=e.isMaxEnergy(),n=e.getEnergyRefresh(),r=e.getMaxCdRefresh();TimerManager.ins().remove(this.timer,this),TimerManager.ins().remove(this.timerAll,this),t?(this.energyLab.text="您的体力已经满了哦",this.leftTimeLab.text=""):(this.energyLab.text="全部恢复："+DateUtils.getFormatBySecond(r,DateUtils.TIME_FORMAT_9),this.leftTimeLab.text=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_0),n>0&&TimerManager.ins().doTimer(1e3,0,this.timer,this),r>0&&TimerManager.ins().doTimer(1e3,0,this.timerAll,this))},t.prototype.timer=function(){var e=UserModel.ins().getEnergyRefresh();e>0?this.leftTimeLab.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_0):(TimerManager.ins().remove(this.timer,this),this.leftTimeLab.text="")},t.prototype.timerAll=function(){var e=UserModel.ins().getMaxCdRefresh();e>0?this.energyLab.text="全部恢复："+DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_9):(TimerManager.ins().remove(this.timerAll,this),this.energyLab.text="您的体力已经满了哦")},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];TimerManager.ins().remove(this.timer,this),TimerManager.ins().remove(this.timerAll,this),App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.btnR:ViewManager.ins().open(EnergyAdWin),ViewManager.ins().close(this);break;case this.btnL:var t=UserModel.ins().getEnergyRefresh();t>0||UserModel.ins().refreshEnergy();break;case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(EnergyWin.prototype,"EnergyWin"),ViewManager.ins().reg(EnergyWin,LayerManager.UI_Popup),window.EnergyWin=EnergyWin;var HeroGroupItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroGroupItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.click,this),MessageCenter.addListener(HeroModel.ins().postHero,this.dataChanged,this)},t.prototype.dataChanged=function(){if(this.data){var e=this.data.data;this.grp.removeChildren();for(var t=!0,n=0,r=e;n<r.length;n++){var i=r[n],o=new HeroItem;o.data=i,this.grp.addChild(o),t=HeroModel.ins().getIsUnlock(i.id)?t:!1}var s=e[0].cd,a=e[0].energy,h="集齐可";a>0&&(h+="获得"+a+"体力",s>0&&(h+="    ")),s>0&&(h+="减少"+s+"s体力时间"),this.lab.text=e[0].sageTypeName,this.tip.text=h,this.upBtn(t)}},t.prototype.upBtn=function(e){var t=HeroModel.ins().getGroupAward();if(!t)return null;var n=this.data.data[0].sageType,r=e?1:0;t&&t.length>0&&t.indexOf(n)>=0&&(r=-1),0==r?(this.btn.enabled=!1,this.btn.icon="character_bonus_btn_disabled_png"):1==r?(this.btn.enabled=!0,this.btn.icon="character_bonus_btn_png"):-1==r&&(this.btn.enabled=!1,this.btn.icon="character_bonus_btn_received_png")},t.prototype.click=function(){var e=this.data.data[0].sageType;console.log("sageType:"+e),HeroModel.ins().groupAward(e)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),this.btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.click,this),this.grp.removeChildren(),MessageCenter.ins().removeAll(this)},t}(eui.ItemRenderer);__reflect(HeroGroupItem.prototype,"HeroGroupItem"),window.HeroGroupItem=HeroGroupItem;var HeroInformationItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroInformationItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){var e=this.data;e&&(1==e.type&&(this.lab1.text="人物传记"),this.lab2.text="        "+e.description)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(HeroInformationItem.prototype,"HeroInformationItem"),window.HeroInformationItem=HeroInformationItem;var HeroInformationWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroInformationSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.data=e[0]?e[0]:null,this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=this.data;if(e){this.heroItem.data=e,this.grp.removeChildren();var t=new HeroInformationItem;t.data={type:1,description:e.description},this.grp.addChild(t)}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.data=null,this.grp.removeChildren(),App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(HeroInformationWin.prototype,"HeroInformationWin"),ViewManager.ins().reg(HeroInformationWin,LayerManager.UI_Popup),window.HeroInformationWin=HeroInformationWin;var HeroItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this),"mini"!=this.currentState&&this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.dataChanged=function(){var e=this.data;if(e){this.lab.text=StringUtils.addChangeLine(e.name);var t=HeroModel.ins().getIsUpLevel(e.id),n=t?e.data2:e.data,r=HeroModel.ins().getIsUnlock(e.id);if(r?this.img.source=n.fullImg:this.img.source=n.outlineImg,this.bg.source=r&&t?"hero_uplv_bg_png":"character_item_bg_png",this.checkbox.selected=!HeroModel.ins().isHide(e.id),"mini"==this.currentState)return this.grp0.visible=!1,this.grp1.visible=!1,this.grp2.visible=!1,void(this.red.visible=!1);if(this.grp0.visible=r,this.grp1.visible=!1,this.grp2.visible=!1,this.red.visible=!1,egret.Tween.removeTweens(this.grp2),r&&t)this.grp0.x=48;else if(r&&!t){this.grp0.x=100,this.grp1.visible=!0;var i=HeroModel.ins().getHeroData(e.id),o=null==i.count?0:i.count,s=null==Main.energyConfig.sageUpgradeCount?3:Main.energyConfig.sageUpgradeCount;if(o>=s){var a="<font  color=0x19a10b>"+o+"</font>/"+s+"\n";this.lab1.textFlow=(new egret.HtmlTextParser).parser(a),this.img1.source="hero_rect1_png",this.red.visible=!0,this.grp2.visible=!0,this.grp2.scaleX=this.grp2.scaleY=1;var h=egret.Tween.get(this.grp2,{loop:!0});h.to({scaleX:.8,scaleY:.8},500).to({scaleX:1,scaleY:1},500)}else{var a="<font  color=0xff0000>"+o+"</font>/"+s+"\n";this.lab1.textFlow=(new egret.HtmlTextParser).parser(a),this.img1.source="hero_rect2_png"}}}},t.prototype.onClick=function(e){if(e.target==this.checkbox){console.log(e.target,this.checkbox.selected,this.data.id);var t=!this.checkbox.selected,n=HeroModel.ins().setHideOrShow(this.data.id,t);return void(t&&!n&&(this.checkbox.selected=!0,wx.showToast({icon:"none",title:"至少显示一个人物"})))}return e.target==this.lab2||e.target==this.img2||e.target==this.grp2?void HeroModel.ins().upLevel(this.data.id):void ViewManager.ins().open(HeroInformationWin,this.data)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),egret.Tween.removeTweens(this.grp2)},t}(eui.ItemRenderer);__reflect(HeroItem.prototype,"HeroItem"),window.HeroItem=HeroItem;var HeroModel=function(e){function t(){var t=e.call(this)||this;return t.heroCfg=null,t.singleCfg=null,t.pages=0,t.isAllGet=!1,t.hideIds=null,t.hasAwardHero=null,t._dailyRecruitCount=0,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.setCfg=function(e){this.heroCfg=e,this.isAllGet=!0},Object.defineProperty(t.prototype,"dailyRecruitCount",{get:function(){var e=CacheUtil.get(Constant.DAILY_RECRUIT_DATA);if(e&&""!=e){var t=JSON.parse(e),n=DateUtils.nowDay();n!=t.freshDay&&(this.dailyRecruitCount=Main.energyConfig.dailyRecruitCount)}else this.dailyRecruitCount=Main.energyConfig.dailyRecruitCount;return this._dailyRecruitCount},set:function(e){this._dailyRecruitCount=e>0?e:0;var t={count:this._dailyRecruitCount,freshDay:DateUtils.nowDay()};CacheUtil.set(Constant.DAILY_RECRUIT_DATA,JSON.stringify(t)),this.postDailyRecruit()},enumerable:!0,configurable:!0}),t.prototype.isHide=function(e){if(null==this.hideIds){var t=CacheUtil.get(Constant.HERO_HIDE);if(!t||""==t)return this.hideIds=[],CacheUtil.set(Constant.HERO_HIDE,JSON.stringify(this.hideIds)),!1;this.hideIds=JSON.parse(t)}var n=this.hideIds.indexOf(e);return n>=0},t.prototype.setHideOrShow=function(e,t){if(null==this.hideIds&&(this.hideIds=[]),t){var n=this.getHeroShow();if(!n||n.length<=1)return!1;this.hideIds.push(e)}else{var r=this.hideIds.indexOf(e);this.hideIds.splice(r,1)}return CacheUtil.set(Constant.HERO_HIDE,JSON.stringify(this.hideIds)),this.postHero(),!0},t.prototype.getIsUnlock=function(e){var t=UserModel.ins().getHeros();if(t&&t.length>0)for(var n in t)if(t[n].sageId==e)return!0;return!1},t.prototype.getIsUpLevel=function(e){var t=UserModel.ins().getHeros();if(t&&t.length>0)for(var n in t)if(t[n].sageId==e&&t[n].level>0)return!0;return!1},t.prototype.getHeroData=function(e){var t=UserModel.ins().getHeros();if(t&&t.length>0)for(var n in t)if(t[n].sageId==e)return t[n];return null},t.prototype.getHeroShowData=function(){var e=this.getHeroShow();if(e&&e.length>0){for(var t={show0:[],show1:[]},n=0;n<e.length;n++)4>=n?t.show1.push(e[n]):9>=n?t.show0.push(e[n]):n-9&1?t.show1.push(e[n]):t.show0.push(e[n]);return t}return null},t.prototype.getHeroShow=function(){var e=UserModel.ins().getHeros();if(!e||0==e.length)return null;for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];this.isHide(i.sageId)||t.push(this.getCfgById(i.sageId))}return t},t.prototype.getALLCfg=function(e){null==this.heroCfg?this.getHeroCfg(e):e(this.heroCfg)},t.prototype.getCfgById=function(e){for(var t=0,n=this.heroCfg;t<n.length;t++){var r=n[t];if(r.id==e)return r}return null},t.prototype.getHeroCfg=function(e){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return this.heroCfg=[],t=1,[4,this.getPage(t)];case 1:r.sent(),n=!0,r.label=2;case 2:return this.isAllGet||!n?[3,4]:(t++,[4,this.getPage(t)]);case 3:return n=r.sent(),[3,2];case 4:return e&&e(this.heroCfg),[2]}})})},t.prototype.getPage=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(i){switch(i.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HERO_PAGE),data:{current:e,size:20}})];case 1:if(t=i.sent(),console.log("HERO_PAGE data:",t),0===t.code){n=t.data;for(r in n.records)this.heroCfg.push(n.records[r]);return this.pages=n.pages,n.current>=n.pages&&(this.isAllGet=!0),[2,!0]}return console.error(t),[2,!1]}})})},t.prototype.hero=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HERO)})];case 1:return e=t.sent(),console.log("HERO data:",e),0===e.code?(2==e.data.award.awardType&&(UserModel.ins().pushHero(e.data.award.sage),this.postHero()),UserModel.ins().upUserData(e.data.userData),[2,e.data]):[2]}})})},t.prototype.heroDaily=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HERO_DAILY)})];case 1:return e=t.sent(),console.log("HERO_DAILY data:",e),0===e.code?(this.dailyRecruitCount--,2==e.data.award.awardType&&(UserModel.ins().pushHero(e.data.award.sage),this.postHero()),[2,e.data]):[2,null]}})})},t.prototype.upLevel=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HERO_UP_LEVEL),data:{sageId:e}})];case 1:return t=n.sent(),console.log("HERO_UP_LEVEL data:",t),0===t.code&&(UserModel.ins().upLevelHero(t.data.sageId),this.postHero()),[2]}})})},t.prototype.groupAward=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HERO_GROUP_AWARD),data:{sageType:e}})];case 1:return t=n.sent(),console.log("HERO_GROUP_AWARD data:",t),0===t.code&&(null==this.hasAwardHero&&(this.hasAwardHero=[]),this.hasAwardHero.push(e)),[2]}})})},t.prototype.getGroupAward=function(){return this.hasAwardHero?this.hasAwardHero:null},t.prototype.groupAwardData=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.hasAwardHero?[2,this.hasAwardHero]:[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HERO_GROUP_HASAWARD)})];case 1:return e=t.sent(),console.log("HERO_GROUP_HASAWARD data:",e),0===e.code?(e.data?this.hasAwardHero=e.data:this.hasAwardHero=[],[2,this.hasAwardHero]):[2]}})})},t.prototype.postHero=function(){},t.prototype.postDailyRecruit=function(){},t}(BaseClass);__reflect(HeroModel.prototype,"HeroModel"),MessageCenter.compile(HeroModel),window.HeroModel=HeroModel;var HeroResultWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroResultSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.result=e[0],this.upView()},t.prototype.upView=function(){console.log(this.result);var e=this.result.award;this.imgE.visible=!1,this.imgHero.visible=!1;var t="获得";if(0==e.awardType)this.imgE.visible=!0,t+=e.energy+"体力值";else if(1==e.awardType);else if(2==e.awardType){this.imgHero.visible=!0;var n=HeroModel.ins().getCfgById(e.sage.id),r=n.data;this.imgHero.source=r.fullImg,t+=e.sage.name}this.lab.text=t,this.playTw()},t.prototype.playTw=function(){var e;e=egret.Tween.get(this.img2,{loop:!0}),e.to({rotation:-180},1e3).to({rotation:-360},1e3),e=egret.Tween.get(this.img3,{loop:!0}),e.to({rotation:180},1e3).to({rotation:360},1e3),e=egret.Tween.get(this.img4,{loop:!0}),e.to({scaleX:.4,scaleY:.4},1e3).to({scaleX:1,scaleY:1},1e3),e=egret.Tween.get(this.img5,{loop:!0}),e.to({scaleX:.4,scaleY:.4},1e3).to({scaleX:1,scaleY:1},1e3),e=egret.Tween.get(this.img6,{loop:!0}),e.to({scaleX:.4,scaleY:.4},1e3).to({scaleX:1,scaleY:1},1e3)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.result=null,egret.Tween.removeTweens(this.img2),egret.Tween.removeTweens(this.img3),egret.Tween.removeTweens(this.img4),egret.Tween.removeTweens(this.img5),egret.Tween.removeTweens(this.img6)},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this),ViewManager.ins().close(HeroSelectWin)}},t}(BaseEuiView);__reflect(HeroResultWin.prototype,"HeroResultWin"),ViewManager.ins().reg(HeroResultWin,LayerManager.UI_Popup),window.HeroResultWin=HeroResultWin;var HeroSelectItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroSelectItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.dataChanged=function(){this.energyNum.text="",this.imgE.visible=!1,this.imgHero.visible=!1;var e=this.data;return console.log("HeroSelectItem:"+e),e?void(e.award?(this.bg.source="recruit_card_other_png",0==e.awardType?(this.energyNum.text=e.energy,this.imgE.visible=!0):1==e.awardType||2==e.awardType&&(this.imgHero.visible=!0,this.imgHero.source=e.img)):this.bg.source="recruit_card_png"):void(this.bg.source="recruit_card_png")},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(HeroSelectItem.prototype,"HeroSelectItem"),window.HeroSelectItem=HeroSelectItem;var HeroSelectWin=function(e){function t(){var t=e.call(this)||this;return t.isDaily=!1,t.skinName="HeroSelectSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.card0,this.onClick),this.addTouchEvent(this.card1,this.onClick),this.addTouchEvent(this.card2,this.onClick),this.addTouchEvent(this.card3,this.onClick),this.isDaily=e[0]?!0:!1,this.upView()},t.prototype.upView=function(){for(var e=0;4>e;e++){var t=this["card"+e];t.data={award:!1}}},t.prototype.upResult=function(e,t){for(var n=e.other,r=0,i=0;4>i;i++){var o=this["card"+i];if(i==t){var s="",a=null;if(2==e.award.awardType){var h=HeroModel.ins().getCfgById(e.award.sage.id),l=h.data;s=e.award.sage.name,a=l.fullImg}o.data={award:!0,awardType:e.award.awardType,energy:e.award.energy,name:s,img:a}}else{var u="",a=null;if(2==n[r].awardType){var h=HeroModel.ins().getCfgById(n[r].sage.id),l=h.data;u=n[r].sage.name,a=l.fullImg}o.data={award:!0,awardType:n[r].awardType,energy:n[r].energy,name:u,img:a},r++}}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.onClick=function(e){switch(e.currentTarget){case this.card0:this.select(0);break;case this.card1:this.select(1);break;case this.card2:this.select(2);break;case this.card3:this.select(3)}},t.prototype.select=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return this.isDaily?[4,HeroModel.ins().heroDaily()]:[3,2];case 1:return t=n.sent(),null==t?(wx.showToast({icon:"none",title:"今日次数不足"}),[2,ViewManager.ins().close(this)]):[3,4];case 2:return[4,HeroModel.ins().hero()];case 3:t=n.sent(),n.label=4;case 4:return this.upResult(t,e),ViewManager.ins().open(HeroResultWin,t),[2]}})})},t}(BaseEuiView);__reflect(HeroSelectWin.prototype,"HeroSelectWin"),ViewManager.ins().reg(HeroSelectWin,LayerManager.UI_Popup),window.HeroSelectWin=HeroSelectWin;var HeroWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroSkin",t.list.itemRenderer=HeroGroupItem,t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.data=e[0],this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return[4,HeroModel.ins().groupAwardData()];case 1:return t.sent(),HeroModel.ins().getALLCfg(function(t){var n={},r=[];for(var i in t){var o=t[i];n[o.sageType]||(n[o.sageType]=[]),n[o.sageType].push(o)}for(var s in n)r.push({data:n[s],type:Number(s)});e.list.dataProvider=new eui.ArrayCollection(r);for(var a=e.data.sageType,h=0,l=6,u=20,i=0;i<r.length&&r[i].type!=a;i++){var c=Math.ceil(r[i].data.length/3);h+=326*c+(c-1)*l+120+u}DisplayUtils.scrollVTo(e.scrol,h,h)}.bind(this)),[2]}})})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.data=null,App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(HeroWin.prototype,"HeroWin"),ViewManager.ins().reg(HeroWin,LayerManager.UI_Popup),window.HeroWin=HeroWin;var HomeWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="HomeSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.energyBtn,this.onClick),this.addTouchEvent(this.recruitkBtn,this.onClick),this.addTouchEvent(this.setBtn,this.onClick),this.addTouchEvent(this.rankBtn,this.onClick),this.addTouchEvent(this.freeBtn,this.onClick),this.addTouchEvent(this.wordBtn,this.onClick),this.addTouchEvent(this.musicBtn,this.onClick),this.addTouchEvent(this.upgradeBtn,this.onClick),this.addTouchEvent(this.roleJob,this.openRoleLevel),this.addTouchEvent(this.role,this.openRoleLevel),this.addTouchEvent(this.house,this.openHouse),this.addTouchEvent(this.playBtn,this.onPlay),this.observe(UserModel.ins().postData,this.upView),this.observe(HeroModel.ins().postHero,this.setHero),this.observe(HeroModel.ins().postHero,this.setHero),this.observe(HouseModel.ins().postUpLevel,this.upgradeMc),this.observe(HeroModel.ins().postDailyRecruit,this.upRecruitkBtn),this.freeBtn.visible=!App.ins().hideAdIcon(),this.upRecruitkBtn(),this.upView(),this.setHero(),StageUtils.ins().adaptationIpx2(this.bg),this.setUserProto(),SoundManager.ins().playBg()},t.prototype.setUserProto=function(){var e=Main.gamePlatform==Main.platformApp||Main.gamePlatform==Main.platformIOS;this.setBtn.visible=e},t.prototype.upView=function(){this.upRole(),this.upHouse(),this.upTop(),this.upBottom()},t.prototype.upRecruitkBtn=function(){var e=HeroModel.ins().dailyRecruitCount;this.recruitkBtn.label=e+"";var t=Main.gamePlatform!=Main.platformTT;this.recruitkBtn.visible=t,this.recruitRed.visible=t&&e>0},t.prototype.setHero=function(){this.clearHero();var e=HeroModel.ins().getHeroShowData();if(e){for(var t=e.show0,n=150,r=75,i=0,o=t;i<o.length;i++){var s=o[i],a=new RoleItem;this.heroGrp0.addChild(a),a.data=s,a.x=r,r+=n,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openHeroWin,this)}var h=e.show1;r=0;for(var l=0,u=h;l<u.length;l++){var s=u[l],a=new RoleItem;this.heroGrp1.addChild(a),a.data=s,a.x=r,r+=n,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openHeroWin,this)}}},t.prototype.clearHero=function(){var e=this.heroGrp0.$children;for(var t in e)e[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openHeroWin,this);this.heroGrp0.removeChildren();var n=this.heroGrp1.$children;for(var t in n)n[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openHeroWin,this);this.heroGrp1.removeChildren()},t.prototype.upTop=function(){var e=UserModel.ins(),t=e.isMaxEnergy(),n=e.getEnergyRefresh(),r=e.getEnergy();this.energyNum.text=r+"",TimerManager.ins().remove(this.timer,this),t?this.leftTimeLab.text="已满":(this.leftTimeLab.text=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_3),n>0?TimerManager.ins().doTimer(1e3,0,this.timer,this):UserModel.ins().refreshEnergy())},t.prototype.timer=function(){var e=UserModel.ins().getEnergyRefresh();e>0?this.leftTimeLab.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3):(TimerManager.ins().remove(this.timer,this),this.leftTimeLab.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3),UserModel.ins().refreshEnergy())},t.prototype.upBottom=function(){this.rankBtn.visible=RankModel.ins().isExist();var e=UserModel.ins().musicOpen;e?this.musicBtn.icon="index_bgm_on_btn_png":this.musicBtn.icon="index_bgm_off_btn_png";var t,n,r,i=Main.userData.upGradeVo,o=!1,s=!1;if(i&&(t=i.count,n=0==t,0==i.nextBonusState?n?(this.upgradeBtn.icon="upgrade_action_house_png",o=!0):(r="number_house_png",s=!0):1==i.nextBonusState?n?(this.upgradeBtn.icon="upgrade_action_protagonist_png",o=!0):(r="number_protagonist_png",s=!0):2==i.nextBonusState?n?(this.upgradeBtn.icon="upgrade_action_character_png",o=!0):(r="number_character_png",s=!0):3==i.nextBonusState),this.upgradeBtn.visible=o,this.stageGrp.visible=s,s){var a=StringUtil.getImgByNumber(t);this.stageGrp.removeChildren();var h=new eui.Image;h.source="number_need_png",this.stageGrp.addChild(h);for(var l=0;l<a.length;l++)h=new eui.Image,h.source=a[l],this.stageGrp.addChild(h);h=new eui.Image,h.source=r,this.stageGrp.addChild(h)}},t.prototype.upRole=function(){var e=this;RoleModel.ins().getSingle(UserModel.ins().getRoleId(),function(t){e.role.data=t,e.roleJob.data=t.name})},t.prototype.upHouse=function(){var e=this;HouseModel.ins().getSingle(UserModel.ins().getHouseId(),function(t){var n=t.data;n=StringUtils.deleteChangeLine(n);var r=JSON.parse(n);e.house.source=r.houseImg,e.bg.source=r.bgImg})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.clearHero(),TimerManager.ins().remove(this.timer,this),this.stageGrp.removeChildren(),SoundManager.ins().stopBg(),DisplayUtils.removeFromParent(this.mc)},t.prototype.openHouse=function(){SoundManager.ins().playEffect("square_tap_mp3"),ViewManager.ins().open(HouseWin)},t.prototype.openRoleLevel=function(){SoundManager.ins().playEffect("square_tap_mp3"),ViewManager.ins().open(RoleUpLevelWin)},t.prototype.openHeroWin=function(e){SoundManager.ins().playEffect("square_tap_mp3");var t=e.currentTarget;ViewManager.ins().open(HeroWin,t.data)},t.prototype.onPlay=function(e){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return UserModel.ins().getEnergy()>0||UserModel.ins().isStartStage()?[4,PlayModel.ins().play()]:[3,2];case 1:return e=t.sent(),e?(ViewManager.ins().open(PlayWin),ViewManager.ins().close(this)):wx.showToast({icon:"none",title:"已全部通关"}),[3,3];case 2:App.ins().hideAdIcon()?wx.showToast({icon:"none",title:"体力不足"}):ViewManager.ins().open(EnergyAdWin),t.label=3;case 3:return[2]}})})},t.prototype.onClick=function(e){switch(e.currentTarget){case this.energyBtn:App.ins().hideAdIcon()||ViewManager.ins().open(EnergyAdWin);break;case this.setBtn:ViewManager.ins().open(SetWin);break;case this.rankBtn:RankModel.ins().show();break;case this.freeBtn:ViewManager.ins().open(EnergyFreeWin);break;case this.wordBtn:ViewManager.ins().open(WordBookWin);break;case this.musicBtn:UserModel.ins().musicOpen=!UserModel.ins().musicOpen,this.upBottom();break;case this.upgradeBtn:var t=Main.userData.upGradeVo;t&&(0==t.nextBonusState?HouseModel.ins().upLevel():1==t.nextBonusState?RoleModel.ins().upLevel():2==t.nextBonusState&&ViewManager.ins().open(HeroSelectWin));break;case this.recruitkBtn:var n=Main.energyConfig.dailyRecruitCount,r=HeroModel.ins().dailyRecruitCount;n==r?ViewManager.ins().open(HeroSelectWin,!0):App.ins().watchAdCall(AwardType.TIP_VIDEO,function(){ViewManager.ins().open(HeroSelectWin,!0)})}},t.prototype.upgradeMc=function(){this.mc?DisplayUtils.removeFromParent(this.mc):this.mc=new MovieClip,this.mainGrp.addChild(this.mc);var e=GlobalConfig.getUpHouseMc();this.mc.x=e.x,this.mc.y=e.y,this.mc.playFile(App.ins().getResRoot()+e.url,1,this.upView.bind(this))},t}(BaseEuiView);__reflect(HomeWin.prototype,"HomeWin"),ViewManager.ins().reg(HomeWin,LayerManager.UI_Main),window.HomeWin=HomeWin;var NavigationWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="NavigationSkin",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.observe(UserModel.ins().postVideoStart,this.start),this.observe(UserModel.ins().postVideoStop,this.stop),this.observe(UserModel.ins().postVideoShare,this.share),this.upView()},t.prototype.upView=function(){this.initRecorderState(),this.initRecorder()
},t.prototype.share=function(){RecordService.recordShare()},t.prototype.start=function(){Main.recorder&&(Main.recording=!0,egret.localStorage.removeItem(Constant.RECORD_SHARE_URL),Main.recorder.start({duration:120}))},t.prototype.stop=function(){Main.recorder&&(Main.recording=!1,Main.recorder.stop())},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.onClick=function(e){},t.prototype.initRecorder=function(){Main.recorder&&(Main.recorder.onStart(function(e){console.log("录屏开始"),Main.recordStartTime=(new Date).getTime()}),Main.recorder.onStop(function(e){console.log("录屏结束",e);var t=(new Date).getTime();t-Main.recordStartTime<Main.recordTime?console.log("录屏时间过短"):e.videoPath&&(Main.recording=!1,CacheUtil.set(Constant.RECORD_SHARE_URL,e.videoPath))}))},t.prototype.initRecorderState=function(){},t}(BaseEuiView);__reflect(NavigationWin.prototype,"NavigationWin"),ViewManager.ins().reg(NavigationWin,LayerManager.UI_Tips),window.NavigationWin=NavigationWin;var SetWin=function(e){function t(){var t=e.call(this)||this;return t.version={app:"V2.0"},t.skinName="SetSkin",t}return __extends(t,e),t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.priviteProto,this.onClick),this.addTouchEvent(this.userProto,this.onClick),this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.set_about,this.onClick),this.upView(),App.ins().playBannerAd(Ad.loadingBanner)},t.prototype.upView=function(){this.userProto.textFlow=(new egret.HtmlTextParser).parser("<u>服务协议</u>"),this.priviteProto.textFlow=(new egret.HtmlTextParser).parser("<u>隐私政策</u>"),this.verLab.text=this.version.app,this.appLab.text="单词喵"},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.priviteProto:ViewManager.ins().open(UserProtoDetialWin,1);break;case this.userProto:ViewManager.ins().open(UserProtoDetialWin,0);break;case this.closeBtn:ViewManager.ins().close(this);break;case this.set_about:var t="https://h5.zmfamily.cn/#/WordAboutUs";window&&window.open?window.open(t):Openadsdk.OpenURL(null,null,t)}},t}(BaseEuiView);__reflect(SetWin.prototype,"SetWin"),ViewManager.ins().reg(SetWin,LayerManager.UI_Popup),window.SetWin=SetWin;var UserModel=function(e){function t(){var t=e.call(this)||this;return t._musicOpen=null,t.isRefreshing=!1,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},Object.defineProperty(t.prototype,"musicOpen",{get:function(){if(null==this._musicOpen){var e=CacheUtil.get(Constant.MUSIC_OPEN);"0"==e?this._musicOpen=!1:this._musicOpen=!0}return this._musicOpen},set:function(e){this._musicOpen=e;var t=e?"1":"0";CacheUtil.set(Constant.MUSIC_OPEN,t),e?SoundManager.ins().playBg():SoundManager.ins().stopBg()},enumerable:!0,configurable:!0}),t.prototype.login=function(){WxService.login()},t.prototype.getData=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.USER_GET_USER_DATA)})];case 1:return e=t.sent(),console.log("USER_GET_USER_DATA data:",e),0===e.code,[2]}})})},t.prototype.refreshEnergy=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.isRefreshing?[2]:(this.isRefreshing=!0,[4,TimerManager.ins().deleyPromisse(1e3)]);case 1:return t.sent(),[4,RequestUtil.postPromise({url:encodeURI(Main.host+Api.USER_REFRESH)})];case 2:return e=t.sent(),console.log("USER_REFRESH data:",e),0===e.code&&(this.upUserData(e.data),this.setRefreshTimer()),this.isRefreshing=!1,[2]}})})},t.prototype.setRefreshTimer=function(){var e=this,t=this.getEnergyRefresh();t>0?TimerManager.ins().doTimer(1e3*t,1,function(){e.refreshEnergy()},this):this.refreshEnergy()},t.prototype.getEnergy=function(){return Main.userData.energy},t.prototype.isMaxEnergy=function(){var e=this.getEnergy();return e>=Main.energyConfig.maxEnergy?!0:!1},t.prototype.getEnergyRefresh=function(){if(!Main.userData.refreshTime)return 0;var e=Main.userData.refreshTime?Main.userData.refreshTime:DateUtil.getUnixtime(),t=Main.energyConfig.refreshInterval?Main.energyConfig.refreshInterval:1200,n=1e3*e,r=n+1e3*t,i=Math.ceil((r-Date.now())/1e3);return i=i>0?i:0},t.prototype.getMaxCdRefresh=function(){var e=Main.energyConfig.maxEnergy,t=Main.energyConfig.refreshInterval?Main.energyConfig.refreshInterval:1200,n=this.getEnergyRefresh()+(e-1)*t;return n},t.prototype.getHouseId=function(){return Main.userData.houseId},t.prototype.getRoleId=function(){return Main.userData.personId},t.prototype.getHeros=function(){return Main.sageList},t.prototype.pushHero=function(e){Main.sageList||(Main.sageList=[]);for(var t=0,n=Main.sageList;t<n.length;t++){var r=n[t];if(r.sageId==e.id)return void(r.count=null==r.count?1:r.count+1)}Main.sageList.push({sageId:e.id,sage:e,count:0,level:0})},t.prototype.upLevelHero=function(e){if(Main.sageList)for(var t=0,n=Main.sageList;t<n.length;t++){var r=n[t];if(r.sageId==e)return r.count=0,void(r.level=1)}},t.prototype.getStageNum=function(){return Main.userData.stageNum},t.prototype.getStageFinNum=function(){return Main.userData.stageNum},t.prototype.isStartStage=function(){return Main.userData.stageNum==Main.userData.stageFinNum+1},t.prototype.upUserData=function(e){Main.userData=e,this.postData()},t.prototype.upHeroData=function(e){Main.sageList=e,this.postData()},t.prototype.postVideoStart=function(){},t.prototype.postVideoStop=function(){},t.prototype.postVideoShare=function(){},t.prototype.postData=function(){},t.prototype.postUserProto=function(){},t}(BaseClass);__reflect(UserModel.prototype,"UserModel"),MessageCenter.compile(UserModel),window.UserModel=UserModel;var HouseModel=function(e){function t(){var t=e.call(this)||this;return t.houseCfg=null,t.singleCfg=null,t.pages=0,t.isAllGet=!1,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.getALLCfg=function(e){null==this.houseCfg?this.getHouseCfg(e):e(this.houseCfg)},t.prototype.getCfgById=function(e){for(var t=0,n=this.houseCfg;t<n.length;t++){var r=n[t];if(r.id==e)return r}return null},t.prototype.getHouseCfg=function(e){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return this.houseCfg=[],t=1,[4,this.getPage(t)];case 1:r.sent(),n=!0,r.label=2;case 2:return this.isAllGet||!n?[3,4]:(t++,[4,this.getPage(t)]);case 3:return n=r.sent(),[3,2];case 4:return e&&e(this.houseCfg),[2]}})})},t.prototype.getPage=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(i){switch(i.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HOUSE_PAGE),data:{current:e,size:20}})];case 1:if(t=i.sent(),console.log("HOUSE_PAGE data:",t),0===t.code){n=t.data;for(r in n.records)this.houseCfg.push(n.records[r]);return this.pages=n.pages,n.current>=n.pages&&(this.isAllGet=!0),[2,!0]}return console.error(t),[2,!1]}})})},t.prototype.getSingle=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(i){switch(i.label){case 0:return this.singleCfg&&this.singleCfg.id==e?(t(this.singleCfg),[3,4]):[3,1];case 1:return this.isAllGet&&this.houseCfg?(n=this.getCfgById(e),t(n),[3,4]):[3,2];case 2:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HOUSE_GET),data:{houseId:e}})];case 3:r=i.sent(),console.log("HOUSE_GET data:",r),0===r.code&&(this.singleCfg=r.data,t(this.singleCfg)),i.label=4;case 4:return[2]}})})},t.prototype.upLevel=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.HOUSE_UP)})];case 1:return e=t.sent(),console.log("HOUSE_UP data:",e),0===e.code&&(this.singleCfg=e.data.house?e.data.house:this.singleCfg,Main.userData=e.data.userData,this.postUpLevel()),[2]}})})},t.prototype.postUpLevel=function(){},t}(BaseClass);__reflect(HouseModel.prototype,"HouseModel"),MessageCenter.compile(HouseModel),window.HouseModel=HouseModel;var HouseWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="RoleUpLevelSkin",t.list.itemRenderer=RoleLevelItem,t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=this;this.topImg.source="house_dialog_title_png",HouseModel.ins().getALLCfg(function(t){var n=[],r=UserModel.ins().getHouseId();for(var i in t)n.push({cfg:t[i],curId:r});n.sort(function(e,t){return t.cfg.id-e.cfg.id});var o=n[0].cfg.id;for(var i in n)n[i].maxId=o;e.list.dataProvider=new eui.ArrayCollection(n);for(var s=0,i=0;i<n.length;i++)if(n[i].cfg.id==n[i].curId){s=i;break}var a=107,h=a*(0==s?0:s-1),l=a*n.length-12-640;l=l>=0?l:0,DisplayUtils.scrollVTo(e.scrol,h,l)})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(HouseWin.prototype,"HouseWin"),ViewManager.ins().reg(HouseWin,LayerManager.UI_Popup),window.HouseWin=HouseWin;var AlphabetItem=function(e){function t(){var t=e.call(this)||this;return t.imgArray=["square_input_png","square_input_wrong_png","square_state_blank_png","square_state_letter_png","square_state_locked_png","square_state_wrong_png","play_letter_select_png","play_letter_select_png"],t.skinName="AlphabetItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t.anchorOffsetX=26,t.anchorOffsetY=26,t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.upDate=function(){if(this.dataChanged(),4==this.data.state){egret.Tween.removeTweens(this),DisplayUtils.setScale(this,.9);var e=egret.Tween.get(this,{loop:!1});e.to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},200)}},t.prototype.dataChanged=function(){var e=this.data,t=!0;e&&e.alphabet?(this.img.source=this.imgArray[e.state],(0==e.state||2==e.state)&&(t=!1),5==e.state||1==e.state?this.lab.text=e.input:this.lab.text=e.alphabet):(this.img.source=this.imgArray[2],this.lab.text=""),this.lab.visible=t},t.prototype.upColor=function(){var e=2956296,t=this.data;(5==t.state||1==t.state)&&(e=PlayModel.ins().isWordErr(t)?13113898:e),this.lab.textColor=e},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),egret.Tween.removeTweens(this)},t}(eui.ItemRenderer);__reflect(AlphabetItem.prototype,"AlphabetItem"),window.AlphabetItem=AlphabetItem;var CoursePlayWin=function(e){function t(){var t=e.call(this)||this;return t.cur=0,t.skinName="CoursePlaySkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btnL,this.onClick),this.addTouchEvent(this.btnR,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){this.mc?DisplayUtils.removeFromParent(this.mc):this.mc=new MovieClip,this.mc.x=50,this.mc.y=200,this.grp.addChild(this.mc);var e=GlobalConfig.getCoursePlay();this.mc.playFile(e[this.cur],-1),this.upSelect()},t.prototype.upSelect=function(){var e=GlobalConfig.getCoursePlay(),t=e.length;this.btnL.enabled=!0,this.btnR.enabled=!0,0==this.cur?(this.btnL.icon="course_btn_left_not_operate_png",this.btnR.icon="course_btn_right_operate_png",this.btnL.enabled=!1):this.cur+1>=t?(this.btnL.icon="course_btn_left_operate_png",this.btnR.icon="course_btn_right_not_operate_png",this.btnR.enabled=!1):(this.btnL.icon="course_btn_left_operate_png",this.btnR.icon="course_btn_right_operate_png")},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner(),this.mc&&DisplayUtils.removeFromParent(this.mc),this.cur=0},t.prototype.onClick=function(e){switch(e.currentTarget){case this.btnR:this.cur++,this.upView();break;case this.btnL:this.cur--,this.upView();break;case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(CoursePlayWin.prototype,"CoursePlayWin"),ViewManager.ins().reg(CoursePlayWin,LayerManager.UI_Popup),window.CoursePlayWin=CoursePlayWin;var PlayFinshWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="PlayFinshSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.returnBtn,this.onClick),this.addTouchEvent(this.energyBtn,this.onClick),this.addTouchEvent(this.shareBtn,this.onClick),this.addTouchEvent(this.nextBtn,this.onNext),this.observe(WordModel.ins().postBook,this.upWord),this.observe(UserModel.ins().postData,this.upTop),SoundManager.ins().playEffect("pass_mp3"),this.upView(),App.ins().playBannerAd(Ad.playBanner)},t.prototype.upView=function(){this.showCheck(),this.playTw(),this.upTop(),this.upWord(),this.upStage(),this.playMc()},t.prototype.showCheck=function(){if(!App.ins().isOpenAd()||Main.gamePlatform!=Main.platformApp)return void(this.checkbox.visible=!1);var e=!1,t=UserModel.ins().getStageNum(),n=Main.energyConfig.stageWatchAdInterval;n=n>0?n:3,t%n==n-1&&(e=!0),this.checkbox.visible=!0,this.checkbox.selected=e},t.prototype.playTw=function(){if(App.ins().isShowShareBtn()){this.shareBtn.visible=!0,egret.Tween.removeTweens(this.shareBtn),this.shareBtn.scaleX=1,this.shareBtn.scaleY=1;var e=egret.Tween.get(this.shareBtn,{loop:!0});e.to({scaleX:1,scaleY:1},500).to({scaleX:.92,scaleY:.92},500).to({scaleX:1,scaleY:1},500)}else this.shareBtn.visible=!1},t.prototype.playMc=function(){this.mc?DisplayUtils.removeFromParent(this.mc):this.mc=new MovieClip,this.grp.addChild(this.mc);var e=GlobalConfig.getHeroResult();this.mc.x=e.x,this.mc.y=e.y,this.mc.playFile(App.ins().getResRoot()+e.url,1)},t.prototype.upStage=function(){this.red.visible=!1;var e,t=Main.userData.upGradeVo,n=!1;if(t&&t.count>0&&(0==t.nextBonusState?(n=!0,e="number_house_png"):1==t.nextBonusState?(n=!0,e="number_protagonist_png"):2==t.nextBonusState?(n=!0,e="number_character_png"):3==t.nextBonusState),t&&0==t.count&&3!=t.nextBonusState&&(this.red.visible=!0),this.stageGrp.visible=n,n){var r=StringUtil.getImgByNumber(t.count);this.stageGrp.removeChildren();var i=new eui.Image;i.source="number_need_png",this.stageGrp.addChild(i);for(var o=0;o<r.length;o++)i=new eui.Image,i.source=r[o],this.stageGrp.addChild(i);i=new eui.Image,i.source=e,this.stageGrp.addChild(i)}this.stageNumGrp.removeChildren();var s=new eui.Image;s.source="number_no_png",this.stageNumGrp.addChild(s);for(var a=UserModel.ins().getStageNum(),h=StringUtil.getImgByNumber(a),o=0;o<h.length;o++)s=new eui.Image,s.source=h[o],this.stageNumGrp.addChild(s);s=new eui.Image,s.source="number_level_png",this.stageNumGrp.addChild(s)},t.prototype.upWord=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,i,o,s,a,h;return __generator(this,function(l){switch(l.label){case 0:this.wordGrp.removeChildren(),e=JSON.parse(PlayModel.ins().oldStage.words),t=[];for(n in e)t.push(n);r=0,l.label=1;case 1:return r<t.length?(i=t[r],o=e[i].word,[4,WordModel.ins().getWordSource(o)]):[3,4];case 2:s=l.sent(),a={word:o,source:s,type:1},h=new WordItem,h.data=a,this.wordGrp.addChild(h),l.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.prototype.upTop=function(){var e=UserModel.ins(),t=e.isMaxEnergy(),n=e.getEnergyRefresh(),r=e.getEnergy();this.energyNum.text=r+"",TimerManager.ins().remove(this.timer,this),t?this.leftTimeLab.text="已满":(this.leftTimeLab.text=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_3),n>0&&TimerManager.ins().doTimer(1e3,0,this.timer,this))},t.prototype.timer=function(){var e=UserModel.ins().getEnergyRefresh();e>0?this.leftTimeLab.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3):(TimerManager.ins().remove(this.timer,this),this.leftTimeLab.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3),UserModel.ins().refreshEnergy())},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];PlayModel.ins().oldStage=null,this.wordGrp.removeChildren(),this.stageGrp.removeChildren(),this.stageNumGrp.removeChildren(),TimerManager.ins().remove(this.timer,this),DisplayUtils.removeFromParent(this.mc),egret.Tween.removeTweens(this.shareBtn),this.mc=null,App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.returnBtn:ViewManager.ins().close(this),ViewManager.ins().open(HomeWin);break;case this.energyBtn:ViewManager.ins().open(EnergyAdWin);break;case this.shareBtn:UserModel.ins().postVideoShare(),this.shareBtn.visible=!1}},t.prototype.onNext=function(e){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return this.checkbox.visible&&this.checkbox.selected?(App.ins().watchAdCall(AwardType.TIP_VIDEO,function(){AdService.adAddTip(e.toNext.bind(e))}.bind(this)),[2]):(this.toNext(),[2])})})},t.prototype.toNext=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return UserModel.ins().getEnergy()>0?[4,PlayModel.ins().play()]:[3,2];case 1:return e=t.sent(),e?(ViewManager.ins().open(PlayWin),ViewManager.ins().close(this)):wx.showToast({icon:"none",title:"已全部通关"}),[3,3];case 2:App.ins().hideAdIcon()?wx.showToast({icon:"none",title:"体力不足"}):ViewManager.ins().open(EnergyAdWin),t.label=3;case 3:return[2]}})})},t}(BaseEuiView);__reflect(PlayFinshWin.prototype,"PlayFinshWin"),ViewManager.ins().reg(PlayFinshWin,LayerManager.UI_Popup),window.PlayFinshWin=PlayFinshWin;var PlayModel=function(e){function t(){var t=e.call(this)||this;return t.stage=null,t.stageWords=null,t.wordGroup=null,t.topWords=null,t.bottomWords=null,t.oldStage=null,t._tipCount=0,t.showMeans=!1,t.nextUpgrade=null,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},Object.defineProperty(t.prototype,"tipCount",{get:function(){return this._tipCount},set:function(e){this._tipCount=e},enumerable:!0,configurable:!0}),t.prototype.replay=function(){this.topWords=null,this.bottomWords=null},t.prototype.getTopWords=function(){return this.topWords||this.initWords(),this.topWords},t.prototype.getBottomWords=function(){return this.bottomWords||this.initWords(),this.bottomWords},t.prototype.isWordErr=function(e){for(var t=e.fromWord,n=!1,r=!1,i=0,o=t;i<o.length;i++){for(var s=o[i],a=!0,h=!0,l=this.wordGroup[s],u=0,c=l;u<c.length;u++){var p=c[u];p.isBlank&&(-1==p.num?(h=!1,a=!1):p.input!=p.alphabet&&(a=!1))}h&&(a?n=!0:r=!0)}return!n&&r},t.prototype.isSame=function(e,t){for(var n=0,r=e;n<r.length;n++)for(var i=r[n],o=0,s=t;o<s.length;o++){var a=s[o];if(i==a)return!0}return!1},t.prototype.getStateWord=function(e){for(var t=e.fromWord,n=[],r=[],i=0,o=t;i<o.length;i++){for(var s=o[i],a=!0,h=!0,l=this.wordGroup[s],u=0,c=l;u<c.length;u++){var p=c[u];p.isBlank&&(-1==p.num?(h=!1,a=!1):p.input!=p.alphabet&&(a=!1))}h&&(a?n.push(l):r.push(l))}var d={type:0,data:[]};if(n.length>0?d={type:1,data:n}:r.length>0&&(d={type:-1,data:r}),d.data.length>0){for(var g=[],f=[],_=[],m=0,y=d.data;m<y.length;m++)for(var v=y[m],w=0,E=v;w<E.length;w++){var p=E[w];(f.indexOf(p.x)<0&&_.indexOf(p.y)<0||f.indexOf(p.x)!=_.indexOf(p.y))&&(g.push(p),f.push(p.x),_.push(p.y))}d.data=g}return d},t.prototype.initWords=function(){null==this.stageWords&&(this.stageWords=JSON.parse(this.stage.words),this.wordGroup={});for(var e=[],t=!1,n=0,r=this.stageWords;n<r.length;n++){var i=r[n];this.wordGroup[i.word]=[];for(var o in i.blankList)i.blankList[o]=Number(i.blankList[o]);for(var s=i.word.length,a=i.firstLetterY,h=i.firstLetterX,l=i.isHorizon,o=0;s>o;o++){var u=3,c=i.blankList.indexOf(o)>=0;c&&(t?u=2:(t=!0,u=0));var p={alphabet:i.word[o],x:a,y:h,isBlank:c,state:u,num:-1,fromWord:[i.word]};if(l?a++:h++,p.isBlank){for(var d=!0,g=0,f=e;g<f.length;g++){var _=f[g];_.x==p.x&&_.y==p.y&&(d=!1,_.fromWord.push(i.word),p=_)}d&&e.push(p)}else{for(var d=!0,m=0,y=e;m<y.length;m++){var _=y[m];_.x==p.x&&_.y==p.y&&(d=!1,_.fromWord.push(i.word),p=_)}d&&e.push(p)}this.wordGroup[i.word].push(p)}}this.topWords=e;var v=[],w=this.stage.blankLetters.split(",");for(var o in w)v.push({alphabet:w[o],state:6,num:Number(o)});this.bottomWords=v},t.prototype.getStageWord=function(e){for(var t in this.stageWords)if(this.stageWords[t].word==e)return this.stageWords[t]},t.prototype.play=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return null!=this.stage?[3,2]:[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.STAGE_PLAY)})];case 1:return e=t.sent(),console.log("STAGE_PLAY data:",e),0===e.code?(this.stage=e.data.stage,this.tipCount=e.data.remainTipsCount,this.upUserData(e.data.userData),[2,!0]):[2,!1];case 2:return[2,!0]}})})},t.prototype.playFinsh=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.STAGE_FINSH)})];case 1:return e=t.sent(),console.log("STAGE_FINSH data:",e),0===e.code&&(this.upUserData(e.data.nud),this.oldStage=this.stage,this.stage=null,this.stageWords=null,this.wordGroup=null,this.topWords=null,this.bottomWords=null,this.nextUpgrade=null,this.setShowMeans(!1),RankModel.ins().setData(UserModel.ins().getStageFinNum())),[2]}})})},t.prototype.clearNext=function(){this.stage=null},t.prototype.playTip=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.STAGE_TIPS)})];case 1:return e=t.sent(),console.log("STAGE_TIPS data:",e),0===e.code&&(this.tipCount=e.data),[2]}})})},t.prototype.setShowMeans=function(e){this.showMeans=e},t.prototype.getNextUpgrade=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.nextUpgrade?[2,this.nextUpgrade]:[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.STAGE_NEXTUPGRADE)})];case 1:return e=t.sent(),console.log("STAGE_NEXTUPGRADE data:",e),0===e.code&&(this.nextUpgrade=e.data),[2,this.nextUpgrade]}})})},t.prototype.upUserData=function(e){e&&UserModel.ins().upUserData(e)},t.prototype.testMax=function(e){return void 0===e&&(e=100),__awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:t=0,n.label=1;case 1:return e>t?[4,this.play()]:[3,5];case 2:return n.sent(),[4,this.playFinsh()];case 3:n.sent(),n.label=4;case 4:return t++,[3,1];case 5:return[2]}})})},t.prototype.testAddEnergy=function(e){return void 0===e&&(e=100),__awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){for(t=0;e>t;t++)AdService.shareProgramAward(),AdService.shareVideoAward(),AdService.watchAdAward();return[2]})})},t}(BaseClass);__reflect(PlayModel.prototype,"PlayModel"),MessageCenter.compile(PlayModel),window.PlayModel=PlayModel;var PlaySearchWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="PlaySearchSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.fun=e[0],this.callthis=e[1],this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){App.ins().adNotScore()?this.btn.icon="energy_dialog_watch_01_png":this.btn.icon="score_search_png"},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.btn:ViewManager.ins().close(this),this.fun.call(this.callthis);break;case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(PlaySearchWin.prototype,"PlaySearchWin"),ViewManager.ins().reg(PlaySearchWin,LayerManager.UI_Popup),window.PlaySearchWin=PlaySearchWin;var PlayTipItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="PlayTipItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){var e=this.data;if(1==e.type){var t="",n=e.upGradeVo;t+="还差<font  color=0xFF3535>"+n.count+"</font>关\n",0==n.nextBonusState?t+="升级房屋":1==n.nextBonusState?t+="升级人物":2==n.nextBonusState&&(t+="招贤"),this.lab.textFlow=(new egret.HtmlTextParser).parser(t)}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(PlayTipItem.prototype,"PlayTipItem"),window.PlayTipItem=PlayTipItem;var PlayWin=function(e){function t(){var t=e.call(this)||this;return t.weight=0,t.skinName="PlaySkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.courseBtn,this.onClick),this.addTouchEvent(this.returnBtn,this.onClick),this.addTouchEvent(this.replayBtn,this.onClick),this.addTouchEvent(this.searchGrp,this.onSearchGrp),this.addTouchEvent(this.tipBtn,this.tip),this.searchGrp.mask=new egret.Rectangle(0,0,714,42),this.initView(),this.initTip(),this.upSearch(),UserModel.ins().postVideoStart()},t.prototype.initTip=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.playTip.visible=!1,[4,PlayModel.ins().getNextUpgrade()];case 1:return e=t.sent(),e&&3!=e.nextBonusState&&e.count>0?(this.playTip.data={type:1,upGradeVo:e},this.playTip.visible=!0):this.playTip.visible=!1,[2]}})})},t.prototype.onSearchGrp=function(){console.log("onSearchGrp btn!");var e=PlayModel.ins().showMeans;e||ViewManager.ins().open(PlaySearchWin,this.upMean,this)},t.prototype.upMean=function(){var e=this;App.ins().watchAdCall(AwardType.TIP_VIDEO,function(){PlayModel.ins().setShowMeans(!0),e.upSearch()}.bind(this))},t.prototype.upSearch=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,i,o,s,a,h,l,u,c,p,d,g,f,_=this;return __generator(this,function(m){switch(m.label){case 0:if(e=PlayModel.ins().showMeans,t=!1,n=null,r=this.getCurItem(),!e||!r)return[3,5];this.searchLabGrp.visible=!0,this.searchImg.visible=!1,this.searchLab.visible=!1,t=!0,i=r.data.fromWord,o=[];for(s in i)o.push(s);a=0,m.label=1;case 1:return a<o.length?(h=o[a],null==n?n="":n+="  ",l=PlayModel.ins().getStageWord(i[h]),n+=l.isHorizon?"横向:":"纵向:",[4,WordModel.ins().getWord(i[h])]):[3,4];case 2:for(u=m.sent(),c=0,p=u.basic.explains;c<p.length;c++)d=p[c],n+=d+";";m.label=3;case 3:return a++,[3,1];case 4:return[3,6];case 5:this.searchLabGrp.visible=!1,this.searchImg.visible=!0,this.searchLab.visible=!0,m.label=6;case 6:return t?(this.searchLab0.text=n,this.searchLab1.text=n,egret.Tween.removeTweens(this),this.weight=0,this.changeSearch(),g=this.searchLab0.width,g>this.searchGrp.width?(f=egret.Tween.get(this,{loop:!0,onChange:this.changeSearch,onChangeObj:this}),f.wait(500).to({weight:1},30*g).call(function(){_.weight=0},this)):this.searchLab1.text=""):(egret.Tween.removeTweens(this),this.searchLab0.text="",this.searchLab1.text=""),[2]}})})},t.prototype.changeSearch=function(){this.searchLab0.x=this.searchLab0.width*-this.weight,this.searchLab1.x=this.searchLab0.width*(-this.weight+1)},t.prototype.initView=function(){this.grp1.removeChildren(),this.grp2.removeChildren(),this.topItems=[],this.bottomItems=[];for(var e=PlayModel.ins().getTopWords(),t=PlayModel.ins().getBottomWords(),n=0,r=e;n<r.length;n++){var i=r[n],o=new AlphabetItem;o.currentState="top",o.data=i,this.grp1.addChild(o),o.x=57*i.x+20+26,o.y=57*i.y+20+26,i.isBlank&&this.addTouchEvent(o,this.onTop),this.topItems.push(o)}for(var s=26,a=26,h=0,l=t;h<l.length;h++){var i=l[h],o=new AlphabetItem;o.currentState="bottom",o.data=i,o.x=s,o.y=a,o.scaleX=1.175,o.scaleY=1.175,s>=606?(a+=104,s=26):s+=101,this.grp2.addChild(o),7==i.state&&(o.visible=!1),this.addTouchEvent(o,this.onBottom),this.bottomItems.push(o)}this.upTipCount(),this.upStage(),this.upTopColor(),this.getCurItem()||this.goWin()},t.prototype.upTipCount=function(){var e=PlayModel.ins().tipCount;e>0?(this.tipBtn.miniLabel=String(e),this.tipBtn.icon="tip_btn_png"):(this.tipBtn.miniLabel="",App.ins().adNotScore()?this.tipBtn.icon=App.ins().hideAdIcon()?"tip_btn_png":"tip_btn_share_png":this.tipBtn.icon="tip_btn_score_png")},t.prototype.upStage=function(){this.stageNumGrp.removeChildren();var e=new eui.Image;e.source="number_no_png",this.stageNumGrp.addChild(e);for(var t=UserModel.ins().getStageNum(),n=StringUtil.getImgByNumber(t),r=0;r<n.length;r++)e=new eui.Image,e.source=n[r],this.stageNumGrp.addChild(e);e=new eui.Image,e.source="number_level_png",this.stageNumGrp.addChild(e)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.topItems=null,this.bottomItems=null,this.stageNumGrp.removeChildren(),UserModel.ins().postVideoStop(),egret.Tween.removeTweens(this)},t.prototype.onTop=function(e){SoundManager.ins().playEffect("square_tap_mp3");var t=e.currentTarget,n=this.getCurItem();if(4!=t.data.state){if(n.data.state=0==n.data.state?2:5,2==t.data.state)t.data.state=0;else if(5==t.data.state||1==t.data.state){var r=this.bottomItems[t.data.num];r.visible=!0,r.data.state=6,r.upDate(),t.data.state=0,t.data.num=-1,t.data.input=null}n.upDate(),t.upDate(),this.upTopColor(),this.upSearch()}},t.prototype.onBottom=function(e){var t=e.currentTarget,n=this.getCurItem();this.inputWord(n,t)},t.prototype.inputWord=function(e,t){if(t.visible=!1,t.data.state=7,-1!=e.data.num){var n=this.bottomItems[e.data.num];n.visible=!0,n.data.state=6,n.upDate()}e.data.num=t.data.num;var r=this.bottomItems[e.data.num].data.alphabet;e.data.input=r;var i=PlayModel.ins().getStateWord(e.data);1==i.type?(SoundManager.ins().playEffect("finish_mp3"),this.upLock(i.data),this.resetNext(e)):-1==i.type?(SoundManager.ins().playEffect("error_mp3"),e.data.state=1,e.upDate()):(SoundManager.ins().playEffect("letter_tap_mp3"),e.data.state=5,e.upDate(),this.resetNext(e)),this.upTopColor(),this.upSearch()},t.prototype.getCurItem=function(){for(var e=0,t=this.topItems;e<t.length;e++){var n=t[e];if(0==n.data.state||1==n.data.state)return n}},t.prototype.getTopItem=function(e){for(var t=0,n=this.topItems;t<n.length;t++){var r=n[t];if(r.data.x==e.x&&r.data.y==e.y)return r}},t.prototype.upTopColor=function(){if(this.topItems)for(var e=0,t=this.topItems;e<t.length;e++){var n=t[e];n.upColor()}},t.prototype.upLock=function(e){if(e&&0!=e.length)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=this.getTopItem(r);i.data.state=4,i.upDate()}},t.prototype.resetNext=function(e){for(var t=!0,n=null,r=null,i=0,o=this.topItems;i<o.length;i++){var s=o[i];if(s!=e){var a=s.data.state;if(2==a){t=!1;var h=PlayModel.ins().isSame(s.data.fromWord,e.data.fromWord);h&&(r=r?r:s),n=n?n:s
}else 5==a&&(t=!1,n=n?n:s)}}return t?void this.goWin():(n=r?r:n,n.data.state=2==n.data.state?0:1,void n.upDate())},t.prototype.goWin=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return[4,PlayModel.ins().playFinsh()];case 1:return t.sent(),TimerManager.ins().doTimer(1e3,1,function(){ViewManager.ins().close(e),ViewManager.ins().open(PlayFinshWin)},this),[2]}})})},t.prototype.replay=function(){for(var e=0,t=this.grp1.$children;e<t.length;e++){var n=t[e];this.removeTouchEvent(n,this.onClick)}for(var r=0,i=this.grp2.$children;r<i.length;r++){var n=i[r];this.removeTouchEvent(n,this.onClick)}this.topItems=null,this.bottomItems=null,PlayModel.ins().replay(),this.initView()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.returnBtn:ViewManager.ins().open(HomeWin),ViewManager.ins().close(this);break;case this.courseBtn:ViewManager.ins().open(CoursePlayWin);break;case this.replayBtn:ViewManager.ins().open(RePlayWin,this.replay,this)}},t.prototype.tip=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return console.log("tip"),PlayModel.ins().tipCount>0?[4,PlayModel.ins().playTip()]:[3,2];case 1:return e.sent(),this.showTip(),this.upTipCount(),[3,3];case 2:if(App.ins().hideAdIcon())return[2];App.ins().watchAdCall(AwardType.TIP_VIDEO,this.showTip.bind(this)),e.label=3;case 3:return[2]}})})},t.prototype.showTip=function(){var e=this.getCurItem();if(e){var t=this.getShowBottom(e.data.alphabet);t||(this.reWord(e.data.alphabet),t=this.getShowBottom(e.data.alphabet)),this.inputWord(e,t),this.upTopColor()}},t.prototype.reWord=function(e){for(var t=null,n=0,r=this.topItems;n<r.length;n++){var i=r[n];if(i.visible&&(5==i.data.state||1==i.data.state)&&i.data.input==e){t=i;break}}t&&this.resetAlphabet(t)},t.prototype.resetAlphabet=function(e){if(2==e.data.state)e.data.state=0;else if(5==e.data.state||1==e.data.state){var t=this.bottomItems[e.data.num];t.visible=!0,t.data.state=6,t.upDate(),e.data.state=2,e.data.num=-1,e.data.input=null}e.upDate()},t.prototype.getShowBottom=function(e){for(var t=0,n=this.bottomItems;t<n.length;t++){var r=n[t];if(r.visible&&r.data.alphabet==e)return r}return null},t}(BaseEuiView);__reflect(PlayWin.prototype,"PlayWin"),ViewManager.ins().reg(PlayWin,LayerManager.UI_Main),window.PlayWin=PlayWin;var RePlayWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="RePlaySkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btn,this.onClick),this.fun=e[0],this.callthis=e[1],this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.btn:ViewManager.ins().close(this),this.fun.call(this.callthis);break;case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(RePlayWin.prototype,"RePlayWin"),ViewManager.ins().reg(RePlayWin,LayerManager.UI_Popup),window.RePlayWin=RePlayWin;var RankModel=function(e){function t(){var t=e.call(this)||this;return t.isdisplay=!1,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.init=function(){var e=window.platform;Main.gamePlatform==Main.platformTT&&e&&e.openDataContext&&e.openDataContext.postMessage({command:"loadRes"})},t.prototype.isExist=function(){return Main.gamePlatform==Main.platformTT},t.prototype.setData=function(e){this.isExist()&&wx.setUserGroup({groupId:"rank",success:function(t){var n={ttgame:{score:e,update_time:DateUtil.getUnixtime()}};wx.setUserCloudStorage({KVDataList:[{key:"score",value:JSON.stringify(n)}],success:function(e){},fail:function(e){console.log("获取数据失败")}})},fail:function(e){console.log("获取数据失败")}})},t.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n;return __generator(this,function(r){return e=window.platform,this.isdisplay?(App.ins().destoryBanner(),this.btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.show,this),DisplayUtils.removeFromParent(this.btn),DisplayUtils.removeFromParent(this.bitmap),DisplayUtils.removeFromParent(this.rankingListMask),this.isdisplay=!1,e.openDataContext.postMessage({isDisplay:this.isdisplay,text:"hello",year:(new Date).getFullYear(),command:"close"})):(App.ins().playBannerAd(Ad.dialogBanner),t=StageUtils.ins().getStage(),n=StageUtils.ins().getUIStage(),this.rankingListMask=new egret.Shape,this.rankingListMask.graphics.beginFill(0,1),this.rankingListMask.graphics.drawRect(0,0,t.width,t.height),this.rankingListMask.graphics.endFill(),this.rankingListMask.alpha=.5,this.rankingListMask.touchEnabled=!0,n.addChild(this.rankingListMask),this.bitmap=e.openDataContext.createDisplayObject(null,t.stageWidth,t.stageHeight),n.addChild(this.bitmap),this.btn=new BaseBtn,this.btn.skinName="BaseBtnSkin",this.btn.verticalCenter=-552,this.btn.horizontalCenter=306,this.btn.icon="dialog_close_btn_png",n.addChild(this.btn),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.show,this),e.openDataContext.postMessage({isDisplay:this.isdisplay,text:"hello",year:(new Date).getFullYear(),command:"open"}),this.isdisplay=!0),[2]})})},t}(BaseClass);__reflect(RankModel.prototype,"RankModel"),window.RankModel=RankModel;var RoleItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="RoleItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this),this.role2.addEventListener(egret.Event.COMPLETE,this.onComplete,this)},t.prototype.onComplete=function(){this.playTw()},t.prototype.dataChanged=function(){var e=this.data;if(null!=e&&""!=e){var t=e.bodyImg,n=e.headImg,r=!1;null==e.stageNum&&null!=e.sageType&&(r=HeroModel.ins().getIsUpLevel(e.id)),r&&(t=e.bodyImg2,n=e.headImg2),this.role1.source=t,this.role2.source=n,this.playTw()}},t.prototype.playTw=function(){var e=this.data;if(egret.Tween.removeTweens(this.role2),this.role2.rotation=0,this.role2.texture){var t=!1;null==e.stageNum&&null!=e.sageType&&(t=HeroModel.ins().getIsUpLevel(e.id));var n=t?e.data2:e.data;n.extraParts?(this.role3.source=n.extraParts.img,this.role3.y=n.bodyY,this.role3.visible=!0):(this.role3.source="",this.role3.visible=!1),this.role1.y=n.bodyY,this.role2.y=n.bodyY+n.headY+n.headH,this.role2.anchorOffsetY=n.headH,this.role2.anchorOffsetX=this.role2.width/2,DisplayUtils.setScale(this.role1,n.scale),DisplayUtils.setScale(this.role2,n.scale),DisplayUtils.setScale(this.role3,n.scale);var r=egret.Tween.get(this.role2,{loop:!0});r.to({rotation:5},500).to({rotation:0},500).to({rotation:-5},500).to({rotation:0},500)}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.role2.removeEventListener(egret.TouchEvent.COMPLETE,this.onComplete,this),this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),egret.Tween.removeTweens(this.role2)},t}(eui.ItemRenderer);__reflect(RoleItem.prototype,"RoleItem"),window.RoleItem=RoleItem;var RoleJobItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="RoleJobItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){var e=this.data;this.lab.text=StringUtils.addChangeLine(e)},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(RoleJobItem.prototype,"RoleJobItem"),window.RoleJobItem=RoleJobItem;var RoleLevelItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="RoleLevelItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){var e=this.data.cfg;if(e){this.lab1.text=e.name,e.stageNum>0?this.lab2.text="完成第"+e.stageNum+"关":this.lab2.text="";var t=this.data.curId,n=-1;t==e.id?n=0:t<e.id&&(n=1),this.img1.visible=!(this.data.maxId==e.id),this.setState(n)}},t.prototype.setState=function(e){var t=823508,n=1525856,r="upgrade_dialog_bar_active_png",i="radiobutton_unselect_png",o="upgrade_dialog_bg_active_png";0==e?(t=9848065,n=7024896,r="upgrade_dialog_bar_inactive_png",i="upgrade_dialog_icon_current_png",o="upgrade_dialog_bg_current_png"):1==e&&(t=8421504,n=4605510,r="upgrade_dialog_bar_inactive_png",i="radiobutton_select_png",o="upgrade_dialog_bg_inactive_png"),this.img1.source=r,this.img2.source=i,this.bg.source=o,this.lab1.textColor=t,this.lab2.textColor=n},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(RoleLevelItem.prototype,"RoleLevelItem"),window.RoleLevelItem=RoleLevelItem;var RoleModel=function(e){function t(){var t=e.call(this)||this;return t.roleCfg=null,t.singleCfg=null,t.pages=0,t.isAllGet=!1,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.setCfg=function(e){this.roleCfg=e,this.isAllGet=!0},t.prototype.getALLCfg=function(e){null==this.roleCfg?this.getRoleCfg(e):e(this.roleCfg)},t.prototype.getCfgById=function(e){for(var t=0,n=this.roleCfg;t<n.length;t++){var r=n[t];if(r.id==e)return r}return null},t.prototype.getRoleCfg=function(e){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return this.roleCfg=[],t=1,[4,this.getPage(t)];case 1:r.sent(),n=!0,r.label=2;case 2:return this.isAllGet||!n?[3,4]:(t++,[4,this.getPage(t)]);case 3:return n=r.sent(),[3,2];case 4:return e&&e(this.roleCfg),[2]}})})},t.prototype.getPage=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(i){switch(i.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.PERSION_PAGE),data:{current:e,size:20}})];case 1:if(t=i.sent(),console.log("PERSION_PAGE data:",t),0===t.code){n=t.data;for(r in n.records)this.roleCfg.push(n.records[r]);return this.pages=n.pages,n.current>=n.pages&&(this.isAllGet=!0),[2,!0]}return console.error(t),[2,!1]}})})},t.prototype.getSingle=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(i){switch(i.label){case 0:return this.isAllGet&&this.roleCfg?(n=this.getCfgById(e),t(n),[3,4]):[3,1];case 1:return this.singleCfg&&this.singleCfg.id==e?(t(this.singleCfg),[3,4]):[3,2];case 2:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.PERSION_GET),data:{personId:e}})];case 3:r=i.sent(),console.log("PERSION_GET data:",r),0===r.code&&(this.singleCfg=r.data,t(this.singleCfg)),i.label=4;case 4:return[2]}})})},t.prototype.upLevel=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.PERSION_UPPERSION)})];case 1:return e=t.sent(),console.log("PERSION_UPPERSION data:",e),0===e.code&&(this.singleCfg=e.data.person?e.data.person:this.singleCfg,UserModel.ins().upUserData(e.data.userData)),[2]}})})},t}(BaseClass);__reflect(RoleModel.prototype,"RoleModel"),MessageCenter.compile(RoleModel),window.RoleModel=RoleModel;var RoleUpLevelWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="RoleUpLevelSkin",t.list.itemRenderer=RoleLevelItem,t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.upView(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upView=function(){var e=this;this.topImg.source="protagonist_dialog_title_png",RoleModel.ins().getALLCfg(function(t){var n=[],r=UserModel.ins().getRoleId();for(var i in t)n.push({cfg:t[i],curId:r});n.sort(function(e,t){return t.cfg.id-e.cfg.id});var o=n[0].cfg.id;for(var i in n)n[i].maxId=o;e.list.dataProvider=new eui.ArrayCollection(n);for(var s=0,i=0;i<n.length;i++)if(n[i].cfg.id==n[i].curId){s=i;break}var a=107,h=a*(0==s?0:s-1),l=a*n.length-12-640;l=l>=0?l:0,DisplayUtils.scrollVTo(e.scrol,h,l)})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this)}},t}(BaseEuiView);__reflect(RoleUpLevelWin.prototype,"RoleUpLevelWin"),ViewManager.ins().reg(RoleUpLevelWin,LayerManager.UI_Popup),window.RoleUpLevelWin=RoleUpLevelWin;var TipItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="TipItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){},t.prototype.show=function(e){this.lab.text=e},t.prototype.hide=function(){this.lab.text="",this.visible=!1},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this)},t}(eui.ItemRenderer);__reflect(TipItem.prototype,"TipItem"),window.TipItem=TipItem;var TipModel=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.show=function(e){this._view||(this._view=LayerManager.UI_Tips),this._view.parent&&(this.tipItem||(this.tipItem=new TipItem,this.tipItem.verticalCenter=0,this.tipItem.horizontalCenter=0),this.tipItem.parent?TimerManager.ins().remove(this.hide,this):this._view.addChild(this.tipItem),this.tipItem.visible=!0,this.tipItem.show(e.title),TimerManager.ins().doTimer(3e3,1,this.hide,this))},t.prototype.hide=function(){this.tipItem.visible=!1,this.tipItem.hide(),DisplayUtils.removeFromParent(this.tipItem)},t}(BaseClass);__reflect(TipModel.prototype,"TipModel"),window.TipModel=TipModel;var WordBookWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="WordBookSkin",t.list.itemRenderer=WordGroupItem,t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.btnL,this.onClick),this.addTouchEvent(this.btnR,this.onClick),this.observe(WordModel.ins().postBook,this.upPost),this.upView(1),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upPost=function(){this.cur=null==this.cur?1:this.cur,this.upView(this.cur)},t.prototype.upView=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(o){switch(o.label){case 0:return this.cur=e,t=e,[4,WordModel.ins().getWordList(0)];case 1:return n=o.sent(),[4,WordModel.ins().getWordList(1)];case 2:return r=o.sent(),this.btnL.label="未掌握（"+StringUtils.NumberToMaxString(n.length)+"）",this.btnR.label="已掌握（"+StringUtils.NumberToMaxString(r.length)+"）",1==t?(this.btnL.icon="glossary_tab_selected_png",this.btnR.icon="glossary_tab_not_select_png",i=WordModel.ins().getWordGroup(0)):2==t&&(this.btnL.icon="glossary_tab_not_select_png",this.btnR.icon="glossary_tab_selected_png",i=WordModel.ins().getWordGroup(1)),i?(this.list.dataProvider=new eui.ArrayCollection(i),this.scrol.visible=!0,this.bookImg.visible=!1):(this.scrol.visible=!1,this.bookImg.visible=!0),[2]}})})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];App.ins().destoryBanner()},t.prototype.onClick=function(e){switch(e.currentTarget){case this.closeBtn:ViewManager.ins().close(this);break;case this.btnL:this.upView(1);break;case this.btnR:this.upView(2)}},t}(BaseEuiView);__reflect(WordBookWin.prototype,"WordBookWin"),ViewManager.ins().reg(WordBookWin,LayerManager.UI_Popup),window.WordWin=WordBookWin,window.WordBookWin=WordBookWin;var WordDetilsWin=function(e){function t(){var t=e.call(this)||this;return t.skinName="WordDetilsSkin",t}return __extends(t,e),t.prototype.initUI=function(){e.prototype.initUI.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addTouchEvent(this.closeBtn,this.onClick),this.addTouchEvent(this.errBtn,this.onClick),this.addTouchEvent(this.btnL,this.onClick),this.addTouchEvent(this.btnR,this.onClick),this.addTouchEvent(this.img1,this.onClick),this.addTouchEvent(this.img2,this.onClick),this.observe(WordModel.ins().postAdd,this.upView),this.observe(WordModel.ins().postErr,this.upErr),this.data=e[0],this.upView(),this.upErr(),this.upShare(),App.ins().playBannerAd(Ad.dialogBanner)},t.prototype.upShare=function(){var e=WordModel.ins().isShowShare();e?(this.labR.visible=!0,this.btnR.visible=!0):(this.labR.visible=!1,this.btnR.visible=!1)},t.prototype.upView=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,i,o,s,a;return __generator(this,function(h){switch(h.label){case 0:return e=this.data,this.lab0.text=e.word,1!=e.from?[3,2]:[4,WordModel.ins().getWord(e.word)];case 1:return t=h.sent(),this.btnL.icon=WordModel.ins().isAddBook(e.word)?"added_glossary_btn_png":"add_glossary_btn_png",this.btnL.touchEnabled=!WordModel.ins().isAddBook(e.word),n="随时复习",[3,3];case 2:2==e.from?(this.btnL.icon="mastered_btn_png",t=WordModel.ins().getBookWord(0,e.wid),n="加入已掌握"):3==e.from&&(this.btnL.icon="unmaster_btn_png",t=WordModel.ins().getBookWord(1,e.wid),n="加入未掌握"),h.label=3;case 3:for(this.labL.text=n,console.log(t),this.wordDate=t,this.lab1.text="美 ["+t.basic["us-phonetic"]+"]",this.lab2.text="英 ["+t.basic["uk-phonetic"]+"]",this.img1.x=this.lab1.x+this.lab1.width+10,r=this.lab1.width>150,r?(this.img2.y=185,this.lab2.y=190,this.img2.x=this.img1.x,this.lab2.x=this.lab1.x):(this.img2.y=150,this.lab2.y=155,this.img2.x=this.lab2.x+this.lab2.width+10,this.lab2.x=380),i="<font  size='32' bold='true'>词意：</font>\n",o=0,s=t.basic.explains;o<s.length;o++)a=s[o],i+="<font  size='24'>     "+a+"</font>\n";return i+="<font  size='32' bold='true'>出处：</font>\n",i+="<font  size='24'>     "+e.source+"</font>\n",this.content.textFlow=(new egret.HtmlTextParser).parser(i),[2]}})})},t.prototype.upErr=function(){var e=WordModel.ins().isReportErr(this.data.word);e?(this.errBtn.enabled=!1,this.errBtn.icon="word_errored_png"):(this.errBtn.enabled=!0,this.errBtn.icon="word_error_png")},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.data=null,App.ins().destoryBanner()},t.prototype.onClick=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,n,r,i=this;return __generator(this,function(o){switch(o.label){case 0:switch(t=e.currentTarget){case this.errBtn:return[3,1];case this.closeBtn:return[3,2];case this.img1:return[3,3];case this.img2:return[3,4];case this.btnL:return[3,5];case this.btnR:return[3,11]}return[3,12];case 1:return WordModel.ins().reportErrWord(this.data.word),[3,12];case 2:return ViewManager.ins().close(this),[3,12];case 3:return SoundManager.ins().playWord(this.wordDate.basic["us-speech"],1),this.img1.source="horn_play_png",TimerManager.ins().doTimer(2e3,1,function(){i.img1.source="horn_unplay_png"},this),[3,12];case 4:return SoundManager.ins().playWord(this.wordDate.basic["uk-speech"],1),this.img2.source="horn_play_png",TimerManager.ins().doTimer(2e3,1,function(){i.img2.source="horn_unplay_png"},this),[3,12];case 5:return 1!=this.data.from?[3,6]:(WordModel.ins().addWord(this.data.word),[3,10]);case 6:return 2!=this.data.from?[3,8]:[4,WordModel.ins().changeWordState(this.data.wid,1)];case 7:return n=o.sent(),n&&(this.data.from=3,this.upView()),[3,10];case 8:return 3!=this.data.from?[3,10]:[4,WordModel.ins().changeWordState(this.data.wid,0)];case 9:n=o.sent(),n&&(this.data.from=2,this.upView()),o.label=10;case 10:return[3,12];case 11:return r=JSON.stringify({share:!0}),wx.shareAppMessage({title:this.data.word,query:r,imageUrl:GlobalConfig.shareImgUrl,success:function(e){console.log("拉起分享 成功"),console.log(e)},fail:function(e){console.log("拉起分享 失败"),console.log(e)}}),[3,12];case 12:return[2]}})})},t}(BaseEuiView);__reflect(WordDetilsWin.prototype,"WordDetilsWin"),ViewManager.ins().reg(WordDetilsWin,LayerManager.UI_Popup),window.WordDetilsWin=WordDetilsWin;var WordGroupItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="WordGroupItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this)},t.prototype.dataChanged=function(){var e=this.data;if(e&&e.data){this.lab.text=e.s,this.grp.removeChildren();for(var t=0,n=e.data;t<n.length;t++){var r=n[t],i=new WordItem;i.data={word:r.word,source:r.source,type:e.type,id:r.wbId},this.grp.addChild(i)}}},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),this.grp.removeChildren()},t}(eui.ItemRenderer);__reflect(WordGroupItem.prototype,"WordGroupItem"),window.WordGroupItem=WordGroupItem;var WordItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="WordItemSkin",t.addEventListener(egret.TouchEvent.ADDED_TO_STAGE,t.open,t),t.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,t.close,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.ADDED_TO_STAGE,this.open,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t.prototype.dataChanged=function(){var e=this.data;this.lab1.text=e.word,this.lab2.text=e.source;var t=WordModel.ins().isAddBook(e.word);t?this.img.source="star_bright_png":this.img.source="star_gray_png"},t.prototype.onClick=function(){1==this.data.type&&ViewManager.ins().open(WordDetilsWin,{word:this.data.word,from:1,source:this.data.source}),2==this.data.type&&ViewManager.ins().open(WordDetilsWin,{word:this.data.word,from:2,source:this.data.source,wid:this.data.id}),3==this.data.type&&ViewManager.ins().open(WordDetilsWin,{word:this.data.word,from:3,source:this.data.source,wid:this.data.id})},t.prototype.close=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.close,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},t}(eui.ItemRenderer);__reflect(WordItem.prototype,"WordItem"),window.WordItem=WordItem;var WordModel=function(e){function t(){var t=e.call(this)||this;return t.words={},t.wordsSource={},t.wordsErr={},t.hasAddBook={},t.wordBook1=null,t.wordBook2=null,t}return __extends(t,e),t.ins=function(){return e.ins.call(this)},t.prototype.isShowShare=function(){return Main.gamePlatform==Main.platformTT?!0:Main.gamePlatform==Main.platformApp?!1:Main.gamePlatform==Main.platformIOS?!1:Main.gamePlatform==Main.platformH5?!1:!1},t.prototype.isReportErr=function(e){return this.wordsErr[e]?!0:!1},t.prototype.changeState=function(e,t){0==t&&null==this.wordBook1&&(this.wordBook1=[]),1==t&&null==this.wordBook2&&(this.wordBook2=[]);for(var n=0==t?this.wordBook2:this.wordBook1,r=0==t?this.wordBook1:this.wordBook2,i=0;i<n.length;i++)if(n[i].wbId==e){n[i].state=t;var o=n.splice(i,1);r.push(o[0]);break}},t.prototype.isAddBook=function(e){if(this.hasAddBook[e])return!0;if(this.wordBook1)for(var t=0,n=this.wordBook1;t<n.length;t++){var r=n[t];if(r.word==e)return!0}if(this.wordBook2)for(var i=0,o=this.wordBook2;i<o.length;i++){var r=o[i];if(r.word==e)return!0}return!1},t.prototype.getWordGroup=function(e){var t=0==e?this.wordBook1:this.wordBook2;if(!t||0==t.length)return null;var n=[],r={};for(var i in t){var o=t[i].word,s=o[0];r[s]||(r[s]=[]),r[s].push(t[i])}var a=0==e?2:3;for(var i in r)n.push({data:r[i],type:a,s:i});return n.sort(function(e,t){var n=e.s<t.s;return n?-1:1}),n},t.prototype.getBookWord=function(e,t){var n=0==e?this.wordBook1:this.wordBook2;if(!n||0==n.length)return null;for(var r=0,i=n;r<i.length;r++){var o=i[r];if(o.wbId==t)return JSON.parse(o.dirt)}return null},t.prototype.getWordSource=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.wordsSource[e]?[3,2]:[4,this.query(e)];case 1:t.sent(),t.label=2;case 2:return[2,this.wordsSource[e]]}})})},t.prototype.getWord=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.words[e]?[3,2]:[4,this.query(e)];case 1:t.sent(),t.label=2;case 2:return[2,this.words[e]]}})})},t.prototype.query=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.STAGE_WORD),data:{word:e}})];case 1:return t=n.sent(),console.log("STAGE_WORD data:",t),0===t.code&&(this.words[t.data.dict.word]=JSON.parse(t.data.dict.response),this.wordsSource[t.data.dict.word]=t.data.source,t.data.hasAdd&&(this.hasAddBook[t.data.dict.word]=!0)),[2]}})})},t.prototype.addWord=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.WORD_ADD),data:{word:e}})];case 1:return t=n.sent(),console.log("WORD_ADD data:",t),0===t.code&&(this.hasAddBook[e]=!0,this.postAdd(),this.getWordList(0,!0)),[2]}})})},t.prototype.getWordList=function(e,t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:if(!t){if(this.wordBook1&&0==e)return[2,this.wordBook1];if(this.wordBook2&&1==e)return[2,this.wordBook2]}return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.WORD_LIST),data:{state:e}})];case 1:return n=r.sent(),console.log("WORD_LIST data:",n),0===n.code?(0==e?this.wordBook1=n.data:this.wordBook2=n.data,t&&this.postBook(),[2,n.data]):[2]}})})},t.prototype.changeWordState=function(e,t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.WORD_CHANGESTATE),data:{wbId:e,state:t}})];case 1:return n=r.sent(),console.log("WORD_CHANGESTATE data:",n),0===n.code?(this.changeState(e,t),this.postBook(),[2,!0]):[2,!1]}})})},t.prototype.reportErrWord=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,RequestUtil.getPromise({url:encodeURI(Main.host+Api.WORD_ERR),data:{word:e}})];case 1:return t=n.sent(),console.log("WORD_ERR data:",t),0===t.code&&(this.wordsErr[e]=!0,this.postErr()),[2]}})})},t.prototype.postAdd=function(){},t.prototype.postErr=function(){},t.prototype.postBook=function(){},t}(BaseClass);__reflect(WordModel.prototype,"WordModel"),MessageCenter.compile(WordModel),window.WordModel=WordModel;var MainScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onEnter=function(){e.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Main2),this.addLayer(LayerManager.UI_Popup),this.addLayer(LayerManager.UI_Tips),this.addLayer(LayerManager.UI_LOADING),ViewManager.ins().open(LoadingUI),App.ins().getShowUserProto()&&ViewManager.ins().open(UserProtoWin)},t.prototype.onExit=function(){e.prototype.onExit.call(this)},t}(BaseScene);__reflect(MainScene.prototype,"MainScene"),window.MainScene=MainScene;var AdService=function(){function e(){}return e.initVideoAd=function(){var e=this;try{if(!wx.createRewardedVideoAd)return;Main.videoAd=wx.createRewardedVideoAd({adUnitId:Ad.video}),Main.videoAd.onClose(function(t){return console.log("视频广告看完了！",t),t.isEnded?void(e.awardType===AwardType.LOGIN_AWARD?e.loginAward(!0):e.awardType===AwardType.WATCH_AD_AWARD?e.watchAdAward():e.awardType==AwardType.TIP_VIDEO&&e.videoCallback&&(e.videoCallback(),e.videoCallback=null)):void console.log("广告没看完！")})}catch(t){console.log("init video ad error:",t)}},e.createBannerAd=function(t){try{if(!wx.createBannerAd)return;if(this.isLoadingBanner)return;this.isLoadingBanner=!0,this.bannerAd&&this.bannerAd.destroy&&(this.bannerAd.destroy(),this.bannerAd=null);var n=Main.systemInfo.windowWidth,r=Main.systemInfo.windowHeight,i=n/r>750/1334,o=void 0;o=i?r/1334:n/750;var s=600*o,a=150*o,h=wx.createBannerAd({adUnitId:t,adIntervals:30,style:{left:(n-s)/2,top:r-a,width:s}});return h.onResize(function(e){h.style.left=(n-e.width)/2,h.style.top=r-e.height}),h.onLoad(function(){e.isLoadingBanner=!1,h.show()}),this.bannerAd=h,h}catch(l){console.log("init banner ad error:",l)}},e.destoryBanner=function(){this.bannerAd&&this.bannerAd.destroy&&(this.bannerAd.destroy(),e.isLoadingBanner=!1,e.bannerAd=null)},e.watchAd=function(e){e&&(this.awardType=e),Main.videoAd&&Main.videoAd.show()["catch"](function(e){console.log("广告组件出现问题",e),Main.videoAd.load().then(function(){return console.log("手动加载成功"),Main.videoAd.show()})})},e.watchAdTip=function(e,t){e==AwardType.TIP_VIDEO&&(this.videoCallback=t),this.watchAd(e)},e.watchAdAward=function(e){wx.showLoading({title:"加载中...",mask:!0}),RequestUtil.post({url:encodeURI(Main.host+Api.USER_WATCH_AD),success:function(t){if(wx.hideLoading(),0===t.code){console.log("观看广告增加体力成功！",t);var n=Main.userData.energy;Main.userData=t.data;var r=Main.userData.energy-n;r>0&&wx.showToast({icon:"none",title:"成功获取"+r+"点体力"}),UserModel.ins().postData()}else wx.showToast({icon:"none",title:"观看广告奖励次数不足"}),console.log("观看广告奖励次数不足！",t);e&&e()},fail:function(e){console.log("观看广告增加体力失败！",e),wx.hideLoading()}})},e.adAddTip=function(e){RequestUtil.post({data:{watchAdType:1},url:encodeURI(Main.host+Api.USER_WATCH_ADV2),success:function(t){0===t.code?(console.log("adAddTip成功！",t),wx.showToast({icon:"none",title:"成功获得1次提示"})):console.log("次数不足！",t),e&&e()},fail:function(e){console.log("adAddTip失败！",e)}})},e.shareVideoAward=function(){wx.showLoading({title:"加载中...",mask:!0}),RequestUtil.post({url:encodeURI(Main.host+Api.USER_SHARE_VIDEO),success:function(e){if(wx.hideLoading(),0===e.code){console.log("分享视频增加体力成功！",e);var t=Main.userData.energy;Main.userData=e.data;var n=Main.userData.energy-t;n>0&&wx.showToast({icon:"none",title:"成功获取"+n+"点体力"}),UserModel.ins().postData()}else console.log("分享视频奖励次数不足！",e)},fail:function(e){console.log("分享视频增加体力失败！",e),wx.hideLoading()}})},e.shareProgramAward=function(){wx.showLoading({title:"加载中...",mask:!0}),RequestUtil.post({url:encodeURI(Main.host+Api.USER_SHARE_PROGRAM),success:function(e){if(wx.hideLoading(),0===e.code){console.log("分享增加体力成功！",e);
var t=Main.userData.energy;Main.userData=e.data.userData;var n=Main.userData.energy-t;n>0&&wx.showToast({icon:"none",title:"成功获取"+n+"点体力"}),UserModel.ins().postData()}else console.log("分享奖励次数不足！",e)},fail:function(e){console.log("分享增加体力失败！",e),wx.hideLoading()}})},e.loginAward=function(e){wx.showLoading({title:"加载中...",mask:!0}),RequestUtil.post({url:encodeURI(Main.host+Api.USER_LOGIN_AWARD),data:{isDouble:e},success:function(e){if(wx.hideLoading(),CacheUtil.set(Constant.LOGIN_AWARD,DateUtil.getDayStart()+""),0===e.code){console.log("登录领取体力成功！",e);var t=Main.userData.energy;Main.userData=e.data;var n=Main.userData.energy-t;n>0&&wx.showToast({icon:"none",title:"成功获取"+n+"点体力"}),UserModel.ins().postData()}else wx.showToast({icon:"none",title:"已经领取过该奖励了"})},fail:function(e){console.log("登录领取增加体力失败！",e),wx.hideLoading()}})},e.isLoadingBanner=!1,e.bannerAd=null,e}();__reflect(AdService.prototype,"AdService"),window.AdService=AdService;var RecordService=function(){function e(){}return e.recordShare=function(){var e=CacheUtil.get(Constant.RECORD_SHARE_URL);if(egret.localStorage.removeItem(Constant.RECORD_SHARE_URL),e){console.log("分享录屏！",e);var t=JSON.stringify({shareVideo:!0});wx.shareAppMessage({channel:"video",title:"单词喵",desc:"快来跟我一起拼单词收集喵星人吧",imageUrl:Main.shareConfig.common.imageUrl,templateId:Main.ttShareId,query:t,extra:{videoPath:e,videoTopics:[" 我发现了一款好玩的拼单词游戏，快来跟我一起玩吧"],withVideoId:!0},success:function(e){console.log("分享录屏成功！增加体力",e),AdService.shareVideoAward()},fail:function(e){console.log("分享失败！",e),wx.showToast({icon:"none",title:"取消分享",duration:2e3})}})}else console.log("录屏分享已失效")},e}();__reflect(RecordService.prototype,"RecordService"),window.RecordService=RecordService;var ScoreService=function(){function e(){}return e.videoResult=function(){this.awardType===AwardType.LOGIN_AWARD?AdService.loginAward(!0):this.awardType===AwardType.WATCH_AD_AWARD?AdService.watchAdAward():this.awardType==AwardType.TIP_VIDEO&&this.videoCallback&&(this.videoCallback(),this.videoCallback=null)},e.Reward=function(e,t){this.awardType=e,e==AwardType.TIP_VIDEO&&(this.videoCallback=t),this.init();var n="token:"+AndroidJs.getToken(),r={url:encodeURI(Main.host+Api.EXCHANGE_ENERGY),data:{token:n},method:"POST",success:function(e){if(console.log("request success!",e),0==e.code){console.log("观看广告增加体力成功！",e);var t=Main.userData.energy;Main.userData=e.data;var n=Main.userData.energy-t;n>0&&wx.showToast({icon:"none",title:"成功获取"+n+"点体力"}),UserModel.ins().postData()}else wx.showToast({title:"积分不足"})},fail:function(e){console.log("request fail!",e)}};RequestUtil.post(r)},e.getScoreNeed=function(){var e=Main.energyConfig.pointsExchangeCost,t=null==e?"":String(e);return t},e.init=function(){if(!this._init)if(this._init=!0,window.AndroidJs)window.AndroidJs.getToken||wx.showToast({title:"AndroidJs.getToken() 不存在"});else{console.log("AndroidJs 不存在"),wx.showToast({title:"AndroidJs 不存在"});var e={getToken:function(){return"572701782376062976"}};window.AndroidJs=e}},e._init=!1,e}();__reflect(ScoreService.prototype,"ScoreService"),window.ScoreService=ScoreService;var CacheUtil=function(){function e(){}return e.set=function(e,t){egret.localStorage.setItem(e,t)},e.get=function(e){return egret.localStorage.getItem(e)},e._cache={},e}();__reflect(CacheUtil.prototype,"CacheUtil"),window.CacheUtil=CacheUtil;var DateUtil=function(){function e(){}return e.getUnixtime=function(){return(new Date).getTime()/1e3},e.getDayStart=function(){return Date.parse((new Date).toDateString())/1e3},e}();__reflect(DateUtil.prototype,"DateUtil"),window.DateUtil=DateUtil;var LoginUtil=function(){function e(){}return e.setToken=function(e){e&&(this._token=e)},e.getToken=function(){return this._token},e.setUserId=function(e){e&&CacheUtil.set(Constant.LOGIN_USER_ID,e+"")},e.getUserId=function(){var e=CacheUtil.get(Constant.LOGIN_USER_ID);return e?Number(e):void 0},e._token=null,e}();__reflect(LoginUtil.prototype,"LoginUtil"),window.LoginUtil=LoginUtil;var ObjectUtil=function(){function e(){}return e.isNull=function(e){return null==e||void 0==e},e.isNotNull=function(e){return null!=e&&void 0!=e},e}();__reflect(ObjectUtil.prototype,"ObjectUtil"),window.ObjectUtil=ObjectUtil;var RequestUtil=function(){function e(){}return e.get=function(t){t.method="GET",e.doRequest(t)},e.post=function(t){t.method="POST",e.doRequest(t)},e.put=function(t){t.method="PUT",e.doRequest(t)},e.getPromise=function(e){return e.method="GET",this.doRequestPromisse(e)},e.postPromise=function(e){return e.method="POST",this.doRequestPromisse(e)},e.doRequest=function(t){t=e.setHeader(t);var n=t.success,r=t.fail;t.success=function(e){console.log("request!",t,e),200===e.statusCode?n&&n(e.data):r&&r(e)},wx.request(t)},e.doRequestPromisse=function(t){return new Promise(function(n,r){t=e.setHeader(t),t.success=function(e){console.log("request!",t,e),200===e.statusCode?n(e.data):r(e)},t.fail=function(e){r(e)},wx.request(t)})},e.setHeader=function(e){e.timeout=Main.reqTimeout;var t=LoginUtil.getToken(),n=LoginUtil.getUserId();console.log("platform="+Main.gamePlatform,"token="+t,"userId="+n);var r=ObjectUtil.isNull(e.header)?{}:e.header;return StringUtil.isNotBlank(t)&&(r.zmgToken=t,r.zmgUserId=String(n)),r.zmgPlatform=Main.gamePlatform,r.zmgVersion=Main.version,e.header=r,e},e}();__reflect(RequestUtil.prototype,"RequestUtil"),window.RequestUtil=RequestUtil;var StringUtil=function(){function e(){}return e.isBlank=function(e){return null===e||void 0===e||""===e},e.isNotBlank=function(e){return null!==e&&void 0!==e&&""!==e},e.getImgByNumber=function(e){var t=[];if(e>0)for(var n=e.toString(),r=0;r<n.length;r++)t.push("number_"+n[r]+"_png");return t},e.imgNumbers=[""],e}();__reflect(StringUtil.prototype,"StringUtil"),window.StringUtil=StringUtil,window.wx||(window.wx={login:function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,RequestUtil.postPromise({url:encodeURI(Main.host+Api.USER_LOGIN),data:{appUid:App.ins().deviceId}}).then(function(e){if(0===e.code&&StringUtil.isNotBlank(e.data.token)){var t=e.data;return Main.isLogin=!0,Main.userData=t.gameData.userData,Main.sageList=t.gameData.sageList,Main.energyConfig=t.gameData.energyConfig,HouseModel.ins().singleCfg=t.gameData.house,RoleModel.ins().singleCfg=t.gameData.person,null!=t.gameData.dailyRecruitCount&&(HeroModel.ins().dailyRecruitCount=t.gameData.energyConfig.dailyRecruitCount-t.gameData.dailyRecruitCount),LoginUtil.setToken(t.token),LoginUtil.setUserId(t.userId),!0}return console.error("登录请求失败!",e),wx.showToast({icon:"none",title:"登录失败请重试"}),!1})]})})},request:function(e){console.log("WxH5:",JSON.stringify(e)),"GET"==e.method?Http.ins().get(e):"POST"==e.method&&Http.ins().post(e)},showToast:function(e){TipModel.ins().show(e)},showLoading:function(e){console.log(e)},hideLoading:function(){}});var WxService=function(){function e(){}return e.login=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,wxapi.login()["catch"](function(e){return console.error(e)})];case 1:return e=t.sent(),e?[2,RequestUtil.postPromise({url:encodeURI(Main.host+Api.USER_LOGIN),data:{code:e.code,anonymousCode:e.anonymousCode}}).then(function(e){if(0===e.code&&StringUtil.isNotBlank(e.data.token)){var t=e.data;return Main.isLogin=!0,Main.userData=t.gameData.userData,Main.sageList=t.gameData.sageList,Main.energyConfig=t.gameData.energyConfig,App.ins().setOpenAd(!t.gameData.isReview),HouseModel.ins().singleCfg=t.gameData.house,RoleModel.ins().singleCfg=t.gameData.person,LoginUtil.setToken(t.token),LoginUtil.setUserId(t.userId),!0}return console.error("登录请求失败!",e),wx.showToast({icon:"none",title:"登录失败请重试"}),!1})["catch"](function(e){return console.error("登录请求失败2！",e),wx.showToast({icon:"none",title:"登录失败请重试"}),!1})]:[2,!1]}})})},e.refreshUserData=function(){RequestUtil.post({url:encodeURI(Main.host+Api.USER_REFRESH),success:function(e){console.log("refresh user data!",e),0===e.code||console.error("refresh energy error!",e)}})},e}();__reflect(WxService.prototype,"WxService"),window.WxService=WxService;